var groupstore,bookgroupstore,ffgroupstore,identgroupstore,fgroupstore,alertgroupstore,appgroupstore,advertgroupstore,rolegroupstore,grid,bookgrid,ffgrid,identgrid,fgrid,alertgrid,appgrid,advertgrid,rolegrid,searchField,store_id=1,selrows=[],sharedfolderaidmap={},sharedfoldergroups=[],sharedfolderdata=[];function geturltoloadex(a){return"function"==typeof geturltoload?geturltoload(a):a}
Object.keys||(Object.keys=function(a){var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b});function accts_date_renderer(a){return function(a){"string"==typeof a&&(a=Date.parseDate(a,"Y-m-d H:i:s"));return(a=Ext.util.Format.date(a,"m/d/Y H:i:s"))&&0==a.indexOf("12/31/1969")?"Never":a}}var xg=null;
"undefined"!=typeof Ext&&(Ext.override(Ext.grid.GroupingView,{interceptMouse:function(a){if(!a.getTarget(".lp_openall",this.mainBody)){var b=a.getTarget(".x-grid-group-hd",this.mainBody);b&&(a.stopEvent(),this.toggleGroup(b.parentNode))}}}),Ext.BLANK_IMAGE_URL=Ext.SSL_SECURE_URL="/js/ext/resources/images/default/s.gif",xg=Ext.grid);
function createGrid(){Ext.QuickTips.init();searchField=new Ext.form.Field({applyTo:"search"});groupstore=createGroupStore(xg.acctsData);grid=createGridPanel(groupstore,"acctsgrid");document.getElementById("load").style.display="none";searchField.on("specialkey",function(){13==Ext.EventObject.getKey()&&submitSearchForm(searchField,getCurrentStore())});update_messages(groupstore);if("undefined"!=typeof doipadscrolling&&doipadscrolling&&"undefined"!=typeof iScroll)try{var a=grid.getView();a&&(myScroll=
new iScroll(a.mainBody.id))}catch(b){alert(b)}setTimeout(function(){createFFGrid();update_messages(getCurrentStore())},200);"object"==typeof Ext.grid.advertData&&0<Ext.grid.advertData.length&&createAdvertGrid();setTimeout(function(){decryptrsakeys()},0)}function createBookmarkGrid(){bookgroupstore=createGroupStore(xg.bookmarksData);bookgrid=createGridPanel(bookgroupstore,"bookmarkgrid");document.getElementById("bookmarkgrid").style.display="none"}
function createFFGrid(){ffgroupstore=createGroupStore(xg.ffData,!0);ffgrid=createGridPanel(ffgroupstore,"ffgrid");document.getElementById("ffgrid").style.display="none";setTimeout(function(){createIdentGrid();update_messages(getCurrentStore())},100);setTimeout(function(){createFGrid();update_messages(getCurrentStore())},100);setTimeout(function(){createAlertGrid();update_messages(getCurrentStore())},100);setTimeout(function(){createAppGrid();update_messages(getCurrentStore())},100);setTimeout(function(){createRoleGrid();
update_messages(getCurrentStore())},100)}function createIdentGrid(){identgroupstore=createGroupStore(xg.identData,!0);identgrid=createGridPanel(identgroupstore,"identgrid");document.getElementById("identgrid").style.display="none";init_done=!0;"undefined"!=typeof show_ident_grid&&(maintabs.setActiveTab(2),changeGrid(0,0,0,1,0,0))}
function createRoleGrid(){rolegroupstore=createGroupStore(xg.roleData,!0);rolegrid=createGridPanel(rolegroupstore,"rolegrid");document.getElementById("rolegrid").style.display="none";init_done=!0;"undefined"!=typeof show_role_grid&&(maintabs.setActiveTab(4),changeGrid(0,0,0,0,0,0,0,1))}
function createFGrid(){fgroupstore=createGroupStore(xg.fData,!0);fgrid=createGridPanel(fgroupstore,"fgrid");document.getElementById("fgrid").style.display="none";init_done=!0;"undefined"!=typeof show_f_grid&&(maintabs.setActiveTab(3),changeGrid(0,0,0,0,1,0))}
function createAlertGrid(){alertgroupstore=createGroupStore(xg.alertData,!0);alertgrid=createGridPanel(alertgroupstore,"alertgrid");document.getElementById("alertgrid").style.display="none";init_done=!0;"undefined"!=typeof show_alert_grid&&(maintabs.setActiveTab(g_alerttabindex),changeGrid(0,0,0,0,0,0,0,0,1))}var g_popAppDone=!1;
function createAppGrid(){g_popAppDone||"function"!=typeof populateAppGridData0||populateAppGridData0();appgroupstore=createGroupStore(xg.appData,!0);appgrid=createGridPanel(appgroupstore,"appgrid");document.getElementById("appgrid").style.display="none";init_done=!0}function createAdvertGrid(){advertgroupstore=createGroupStore(xg.advertData,!0);advertgrid=createGridPanel(advertgroupstore,"advertpanel");advertgrid.getColumnModel().setColumnWidth(0,900)}
function createGroupStore(a,b){var c=new Ext.data.ArrayReader({id:0},[{name:"store_id"},{name:"acctname",sortType:"asUCString"},{name:"group",sortType:"asUCString"},{name:"count",type:"int"},{name:"username",sortType:"asUCString"},{name:"lasttouch",type:"date",dateFormat:"Y-m-d H:i:s"},{name:"editlink"},{name:"id"},{name:"url"},{name:"fav"},{name:"launchjs"},{name:"deleted"},{name:"remoteshare"},{name:"pwprotect"}]);a=new Ext.data.GroupingStore({reader:c,data:a,sortInfo:{field:"acctname",direction:"ASC"},
groupField:b?null:"group"});submitSearchForm(searchField,a,!0);return a}
function createGridPanel(a,b){var c=a("Edit").length+a("Share").length+a("Delete").length+15;50<c&&(c=50);a=new xg.GridPanel({store:a,region:"center",columns:[{header:a("Name"),width:110-c,sortable:!0,dataIndex:"acctname"},{header:a("Group"),id:"group",width:20,sortable:!0,hidden:!0,dataIndex:"group"},{header:a("Count"),width:10,sortable:!0,dataIndex:"count",hidden:!0},{header:a("Username"),width:60,sortable:!0,dataIndex:"username",hidden:!0},{header:a("Last Login"),width:32,sortable:!0,dataIndex:"lasttouch",
renderer:accts_date_renderer(),hidden:!0},{header:a("Action"),width:c,sortable:!1,dataIndex:"editlink"},{id:"id",header:"id",width:20,sortable:!1,hidden:!0,dataIndex:"id"},{header:a("URL"),width:20,sortable:!1,hidden:!0,dataIndex:"url"}],view:new Ext.grid.GroupingView({forceFit:!0,groupTextTpl:'{group} ({[values.rs.length]} {[values.rs.length > 1 ? "sites" : "site"]})  <a class="lp_openall" style="font-size: 11px;" href="#" onclick="open_group(\'{[es(Ext.util.Format.htmlEncode(values.rs[0].data.group))]}\'); return false;">'+
a("Open All")+'</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="lp_openall" style="font-size: 11px;" href="#" target="off" onclick="select_all(event, \'{[es(Ext.util.Format.htmlEncode(values.rs[0].data.group))]}\', this); return false;">'+a("Select All")+"</a>",emptyGroupText:a("(none)")}),stripeRows:!0,frame:!1,width:600,collapsible:!1,iconCls:"icon-grid",renderTo:b,style:"padding: 0px 5px 0px 5px;",selModel:new Ext.grid.RowSelectionModel({singleSelect:!0})});a.on("rowdblclick",function(a){var b=a.getSelectionModel().getSelected().data;
getCurrentStore()==ffgroupstore?pa(function(a){showFFWindow(b.id,null,null,a)},g_view_ff_prompt||"1"==b.pwprotect,null,null,!0):getCurrentStore()==identgroupstore?pa(function(a){showIdentWindow(b.id,null,null,a)},pwprotect_ident(b.id,!0)||"1"==b.pwprotect,null,null,!0):getCurrentStore()==rolegroupstore?pa(function(a){showIdentWindow(b.id,null,1,a)},pwprotect_ident(b.id,!0)||"1"==b.pwprotect,null,null,!0):getCurrentStore()==fgroupstore?pa(function(a){showFWindow(b.id,a)},g_switch_f_prompt,null,null,
!0):getCurrentStore()==alertgroupstore?pa(function(a){showAlertWindow(b.id,a)},g_switch_a_prompt,null,null,!0):"0"==b.remoteshare?pa(function(a){showWindow(b.id,null,a)},g_edit_site_prompt||"1"==b.pwprotect,null,null,!0):"1"==b.remoteshare?pa(function(a){showAcceptShareWindow(b.id,"showaccept",null,a)},g_edit_site_prompt||g_edit_sn_prompt,null,null,!0):"2"==b.remoteshare&&pa(function(a){showAcceptShareWindow(b.id,"showview",null,a)},g_edit_site_prompt||g_edit_sn_prompt,null,null,!0)});a.getColumnModel().on("hiddenchange",
checkDecryptUsername);resizeGrid(a);return a}var gDidUserNameDecrypt=!1;function checkDecryptUsername(a,b,c){gDidUserNameDecrypt||3!=b||getCurrentStore()!=groupstore||(gDidUserNameDecrypt=!1,show_waitbox(null,gs("LastPass is decrypting your usernames...")),groupstore.each(decryptUsername),grid.getView().scrollToTop(),hide_waitbox())}function decryptUsername(a){try{a.set("username",lpdec_u(a.get("username")))}catch(b){}}var curr_message,noaccounts_shown=!1,noresults_shown=!1;
function update_messages(a){try{var b=!1,c=!1;0==a.query("id","",!0,!0).length&&(""!=searchField.getValue()?c=!0:b=!0);!b&&noaccounts_shown?(curr_message.ghost("t",{remove:!0}),noaccounts_shown=!1):!c&&noresults_shown&&(curr_message.ghost("t",{remove:!0}),noresults_shown=!1);if(b&&!noaccounts_shown){if(a==ffgroupstore)var d=gs("You do not yet have any form fill profiles setup!")+" "+gs("Add one by clicking 'Add Profile' to the left.");else if(a==identgroupstore)d=gs("You do not yet have any identities setup!")+
" "+gs("Add one by clicking 'Add Identity' to the left.");else if(a==rolegroupstore)d=gs("You do not yet have any roles setup!")+" "+gs("Add one by clicking 'Add Role' to the left.");else if(a==fgroupstore)d=gs("You are currently not sharing any items with any of your friends.")+" "+gs("To share an item, click on the 'Sites' tab and click an item's 'Share' link.");else if(a==alertgroupstore)d=gs("You do not have alerts.");else if(a==appgroupstore)d=gs("You do not yet have any applications setup!")+
" "+gs("Add some by using LastPass for Applications.");else{d=gs("You do not yet have any sites setup!")+" "+gs("Add one by clicking 'Add Site' to the left.");a=!1;var e=document.getElementById("iidselect");e&&""!=e.options[e.selectedIndex].value&&!document.getElementById("showdeleted").checked&&(a=!0,d=gs("You do not yet have any sites for your currently selected identity!")+"\n\n"+gs("Please change your identity back to 'All' to view a complete listing of your sites."));"undefined"!=typeof gbPlugin&&
gbPlugin&&(d=a?gs("You do not yet have any sites setup for your currently selected identity!")+"\n\n"+gs("Please change your identity back to 'All' to view a complete listing of your sites."):document.getElementById("showdeleted").checked?gs("You do not yet have any deleted sites!"):gs("You do not yet have any sites setup!")+"\n\n"+gs("Browse the web as you normally would and LastPass will automatically remember passwords as you enter them.")+"\n\n<a style='text-decoration: underline' target='_blank' href='/basic.php'>"+
gs("Watch a screencast on basic usage")+"</a>")}curr_message=showMessageWindow(d,!0);noaccounts_shown=!0}else c&&!noresults_shown&&(d=getActionMessage(a,"NoResults")+" "+sprintf(gs("Please try another search, or %sclear your current one%s."),"<a style='color:blue;' href='#' onclick='clearSearchForm(searchField, getCurrentStore()); update_messages(getCurrentStore()); return false;'>","</a>"),curr_message=showMessageWindow(d,!0),noresults_shown=!0)}catch(f){}}
function clear_messages(){try{noaccounts_shown?(curr_message.ghost("t",{remove:!0}),noaccounts_shown=!1):noresults_shown&&(curr_message.ghost("t",{remove:!0}),noresults_shown=!1)}catch(a){}}var gbfirstdelete=!0,gbfirstdeletealert=!0;
function submitSearchForm(a,b,c){if("undefined"!=typeof b){var d=trim(a.getValue()),e=!1,f=!1;d&&0==d.indexOf("group:")?(d=d.substring(6),e=!0):d&&0==d.indexOf("id:")&&(d=d.substring(3),f=!0);if(gbfirstdelete&&document.getElementById("showdeleted").checked)show_waitbox(),downloaddeleted(),gbfirstdelete=!1;else{var g;b.filterBy(function(a,b){if(""!=d||e||f)if(e){if(d.toLowerCase()!=a.data.group.toLowerCase())return a.data.visible=!1}else if(f){if(d.toLowerCase()!=a.data.id.toLowerCase())return a.data.visible=
!1}else if(g=new RegExp(d,"i"),!g.test(strip_tags(a.data.acctname))&&!g.test(a.data.group)&&!g.test(a.data.url))return a.data.visible=!1;b=document.getElementById("activegroupsel");var c=document.getElementById("delgroupsel"),h=document.getElementById("purgemsg");clearselected();document.getElementById("showdeleted").checked?(b.style.display="none",c.style.display="block",h.style.display="block"):(b.style.display="block",c.style.display="none",h.style.display="none");return favorites_hidden&&" favorites"==
a.data.group||!document.getElementById("showdeleted").checked&&"0"!=a.data.deleted||document.getElementById("showdeleted").checked&&"1"!=a.data.deleted?a.data.visible=!1:a.data.visible=!0});c||update_messages(b)}}}function clearSearchForm(a,b){a.setValue("");submitSearchForm(a,b)}function onFilterItemCheck(a,b){b&&Ext.get("filterlabel").update("["+a.text+"]")}
function downloaddeleted_lp3(){show_waitbox();Ext.Ajax.request({url:geturltoloadex("getaccts.php?deleted=1&ajax=1&includesharedfolders=1"),success:downloaddeletedOk_lp3,failure:downloaddeletedFail})}
function downloaddeletedOk_lp3(a,b){hide_waitbox();a=Ext.decode(a.responseText);if("object"==typeof a){if(0==a.length)lpmessagebox(null,gs("You have no deleted sites.")),document.getElementById("showdeleted").checked=!1;else{b=getBG();for(var c={},d=0;d<a.length;d++){var e=a[d];"undefined"===typeof sharedfolderaidmap[e.id]&&e.shareid&&(sharedfolderaidmap[e.id]=e.shareid);var f="undefined"!=typeof e.shareid&&0!=e.shareid?g_rsadecryptedkeys[e.shareid]:null,g={};g.aid=e.id;g.fav=e.fav;g.group=lpdec(e.grouping,
f);g.name=lpdec(e.name,f);g.pwprotect=e.pwprotect;g.sharefromaid=e.shareid;g.url=AES.hex2url(e.url);g.username=lpdec(e.username,f);g.deleted=1;"undefined"!=typeof e.sharename&&""!=e.sharename&&(g.group=lpdec(e.sharename,f));""==g.group&&(g.group=gs("(none)"));"1"==e.pwprotect&&(g_pwprotect[e.id]=1);c[e.id]=g}b.setDeletedSites(c);b.setDeletedSecureNotes([])}repopulate()}}
function downloaddeleted(){Ext.Ajax.request({url:geturltoloadex("getaccts.php?deleted=1&ajax=1&includesharedfolders=1"),success:downloaddeletedOk,failure:downloaddeletedFail})}function downloaddeletedalerts(){Ext.Ajax.request({url:geturltoloadex("creditmon.php?cmd=getdeletedalerts"),success:downloaddeletedalertsOk,failure:downloaddeletedalertsFail})}
function resetgrid(){Ext.Ajax.request({url:geturltoloadex("grid.php?update=1"),success:function(a,b){lpmessagebox(null,gs("SUCCESS!"))},failure:function(){}})}
function downloaddeletedOk(a,b){b=Ext.decode(a.responseText);if("object"!=typeof b)hide_waitbox();else{if(0!=b.length){submitSearchForm(searchField,groupstore,1);for(var c=[],d=0;d<b.length;d++){a=b[d];var e="undefined"!=typeof a.shareid&&0!=a.shareid?g_rsadecryptedkeys[a.shareid]:null,f='<span style="display:none;">'+of(lpdec(a.acctname4,e))+"</span>"+a.acctname6+a.acctname1+a.acctname2+a.acctname3+of(lpdec(a.acctname4,e))+a.acctname5,g=AES.hex2url(a.url),m=lpdec(a.grouping,e);"undefined"!=typeof a.sharename&&
""!=a.sharename&&(m=lpdec(a.sharename,e),sharedfolderaidmap[a.id]=a.shareid,sharedfolderdata[a.shareid]={give:a.give,readonly:a.readonly,name:a.sharename},decryptfoldername(a.shareid,e));""==m&&(m=gs("(none)"));var h=a.editlink,n=a.id,p=a.launch_count;e=lpdec(a.username,e);a=ASR(f,m,g,n,p,h,a.last_touch,a.fav,a.launchjs,a.deleted,!1,"0",!1,!1,!1,e,a.pwprotect,!1,!0);for(f=0;f<a.length;f++)c[c.length]=a[f];b[d]=null}groupstore.suspendEvents();groupstore.add(c);groupstore.sort("acctname","ASC");groupstore.groupBy("group",
!0);groupstore.resumeEvents()}hide_waitbox();submitSearchForm(searchField,groupstore)}}function downloaddeletedFail(){hide_waitbox();lpmessagebox(gs("An Error Occurred"),gs("An error occurred while downloading your deleted sites"))}function es(a){a=a.replace(/\\/g,"\\\\");a=a.replace(/'/g,"\\'");return a=a.replace(/"/g,'\\"')}function of(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML}function strip_tags(a){return a.replace(/<[^>]+>/g,"")}
var global_groups=[],favorites_hidden=!1;function hide_favorites(){favorites_hidden=!0;submitSearchForm(searchField,getCurrentStore())}function show_favorites(){favorites_hidden=!1;submitSearchForm(searchField,getCurrentStore())}
function get_window_width(){var a=-1;"undefined"!=typeof window.innerWidth&&0<window.innerWidth?a=window.innerWidth-18:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0<document.documentElement.clientWidth?a=document.documentElement.clientWidth:"undefined"!=typeof document.body&&"undefined"!=typeof document.body.clientWidth&&0<document.body.clientWidth&&(a=document.body.clientWidth);return a}
function get_window_height(){var a=-1;"undefined"!=typeof window.innerHeight&&0<window.innerHeight?a=window.innerHeight-18:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientHeight&&0<document.documentElement.clientHeight?a=document.documentElement.clientHeight:"undefined"!=typeof document.body&&"undefined"!=typeof document.body.clientHeight&&0<document.body.clientHeight&&(a=document.body.clientHeight);return a}
function aidIsChecked(a){for(var b in selrows)if(b==a&&null!=selrows[b])return!0;return!1}
function checkIllegalSharedFolderDelete(a,b){"object"!=typeof a&&(a=a.split(","));var c=gs("Please delete sites from a single shared folder at a time.");"string"===typeof b&&("purge"===b?c=gs("Please purge sites from a single shared folder at a time."):"undelete"===b&&(c=gs("Please undelete sites from a single shared folder at a time.")));b=null;for(var d=0;d<a.length;d++){var e=getGroup(a[d]);e=e?-1==e.indexOf("\\")?e:e.substr(0,e.indexOf("\\")):"";if("undefined"!=typeof sharedfoldergroups[e]){if("1"==
sharedfoldergroups[e])return alert(gs("Sorry, this shared site is readonly.")),!1;if(null==b)b=e;else if(b!=e||""==b&&""!=e)return alert(c),!1}else if(null==b)b="";else if(""!=b)return alert(c),!1}return!0}function getGroup(a){if("undefined"!=typeof g_newvault){if(a=get_record(a),"undefined"!=typeof a)return a.group}else if(a=getCurrentStore().query("id",a,!1,!0),1==a.length)return a.itemAt(0).data.group;return""}
function delAid(a,b,c){if(aidIsChecked(a))delSel("undefined"==typeof c||null==c||""==c?"unknownsk1":c);else if(checkIllegalSharedFolderDelete(a)){var d={};d.value=getActionMessage(getCurrentStore(),"Delete");var e=getActionMessage(getCurrentStore(),"DeleteConfirm");callbackdelete=function(){realDelAid(a,b,c)};d=d.value;lpwindow({title:d,onclick:callbackdelete,html:e,showok:!0,showcancel:!0,swapdefault:!0})}}
function realDelAid(a,b,c){var d=a;"object"!=typeof a&&(d=a.split(","));for(var e=a="",f=/title='([^']*)'/,g=/&nbsp;([^<]*)<\/a>($|<span)/,m={src:"website",ajax:1,extjs:1,delete:1,hasplugin:g_hasplugin},h=0;h<d.length;h++){var n=d[h];"undefined"!=typeof sharedfolderaidmap[n]&&(m.sharedfolderid=sharedfolderaidmap[n]);a+=e+n;e=",";if("undefined"==typeof g_newvault){n=getCurrentStore().query("id",n,!1,!0);for(var p=0;p<n.length;p++){var r=n.itemAt(p);r.data.deleted=gbfirstdelete?"-1":"1";var q=r.data.acctname,
w=q.match(f);q=q.match(g);var v=r.data.url;v=v.toLowerCase();if(v){var u=v.indexOf("://");0<=u&&(v=v.substring(u+3));u=v.indexOf("/");0<=u&&(v=v.substring(0,u));v=AES.url2hex(v)}else v="";w="<a title='"+w[1]+"' href='' onclick='lpmessagebox(null,"+gs("Since this site is deleted, we are unable to log you in.")+"); return false;'><img border='0' src='geticon.php?host="+v+"' width='16' height='16'>&nbsp;"+q[1]+"</a>";r.data.acctname=w;w=r.data.id;q=1==r.data.pwprotect||("http://sn"==r.data.url?g_edit_sn_prompt:
g_edit_site_prompt);w="<a onclick=\"pa(function(pwhash){showWindow('"+w+"',null,pwhash);}, "+q+', null, null, true);return false;" href="show_website.php?aid='+w+'">'+gs("Edit")+"</a> | <a onclick=\"pa(function(pwhash){undelAid('"+w+"',pwhash, '"+es(c)+"');}, "+q+',null,null,true);return false;" href="#">'+gs("Undelete")+"</a> | <a onclick=\"pa(function(pwhash){confirmPurge('"+w+"',pwhash, '"+es(c)+"');}, "+q+',null,null,true);return false;" href="#">'+gs("Purge")+"</a> &nbsp;&nbsp; <input type='checkbox' id='"+
w+"_cb' onclick='clickcheck(this.checked, \""+w+"\", 1);'>";r.data.editlink=w}}else p=getBG(),"undefined"!=typeof p.g_deleted_sites&&(r=p.g_sites[n],r.deleted=1,p.g_deleted_sites[r.aid]=r),delete p.g_sites[n]}"undefined"!=typeof g_newvault&&repopulate();m.aid=a;"string"==typeof c&&(m.token=c);"undefined"!=typeof b&&null!=b&&(m.pwhash=b);Ext.Ajax.request({url:geturltoloadex("show_website.php"),params:m,success:submitOk,failure:submitFail})}
function undelAid(a,b,c){var d="undefined"!=typeof b?b:null,e="undefined"!=typeof c?c:null;b=getActionMessage(getCurrentStore(),"Undelete");c=getActionMessage(getCurrentStore(),a&&-1!=a.indexOf(",")?"UndeleteConfirmMultiple":"UndeleteConfirm");lpconfirmbox(b,c,function(){realUndelAid(a,d,e)})}
function realUndelAid(a,b,c){var d=a.split(",");if(checkIllegalSharedFolderDelete(d,"undelete")){for(var e=0,f=0;f<d.length;f++)"undefined"!=typeof sharedfolderaidmap[d[f]]&&(e=sharedfolderaidmap[d[f]]);a={src:"website",fromwebsite:1,extjs:1,undelete:1,aid:a,hasplugin:g_hasplugin};"undefined"!=typeof b&&null!=b&&(a.pwhash=b);"string"==typeof c&&(a.token=c);0!=e&&(a.sharedfolderid=e);Ext.Ajax.request({url:geturltoloadex("show_website.php"),params:a,success:submitOk,failure:submitFail})}}
function delFfid(a,b,c){var d=getActionMessage(ffgroupstore,"Delete");var e=getActionMessage(ffgroupstore,"DeleteConfirm");var f="undefined"==typeof b?null:b;lpconfirmbox(d,e,function(){realDelFfid(a,f,c)})}
function realDelFfid(a,b,c){var d={src:"website",deleteext:1,ffid:a};"undefined"!=typeof b&&null!=b&&(d.pwhash=b);"string"==typeof c&&(d.token=c);"undefined"!=typeof sharedfolderaidmap["ff"+a]&&(d.sharedfolderid=sharedfolderaidmap["ff"+a]);Ext.Ajax.request({url:geturltoloadex("formfill.php"),params:d,success:submitFFOk,failure:submitFFFail})}
function delIid(a,b,c,d){var e="undefined"!=typeof c?c:null;c=getActionMessage(identgroupstore,"Delete");var f=getActionMessage(identgroupstore,"DeleteConfirm");lpconfirmbox(c,f,function(){realDelIid(a,b,e,d)})}function realDelIid(a,b,c,d){a={src:"website",deleteext:1,iid:a};"undefined"!=typeof c&&null!=c&&(a.pwhash=c);"string"==typeof d&&(a.token=d);b&&(a.isrole=1);Ext.Ajax.request({url:geturltoloadex("identity.php"),params:a,success:submitIdentOk,failure:submitFailGeneric})}
function delAppAid(a,b,c){var d="undefined"!=typeof b?b:null;b=getActionMessage(appgroupstore,"Delete");var e=getActionMessage(appgroupstore,"DeleteConfirm");lpconfirmbox(b,e,function(){realDelAppAid(a,d,c)})}
function realDelAppAid(a,b,c){var d={cmd:"delete"};"undefined"!=typeof b&&null!=b&&(d.pwhash=b);"string"==typeof c&&(d.token=c);b=c="";a=a.split(",");for(var e=0;e<a.length;e++)a[e]&&0==a[e].indexOf("app")&&(a[e]=a[e].substring(3)),"undefined"!=typeof g_newvault&&removeApp(a[e]),c+=a[e]+",","undefined"!=typeof sharedfolderaidmap["app"+a[e]]&&(b=sharedfolderaidmap["app"+a[e]]);d.appaid=c;c="";""!=b&&(c="&sharedfolderid="+encodeURIComponent(b));b=geturltoloadex("addapp.php?src=website"+c);"undefined"!=
typeof sharedfolderaidmap["app"+a]&&(b+="&sharedfolderid="+encodeURIComponent(sharedfolderaidmap["app"+a]));"undefined"!=typeof g_newvault&&repopulate();Ext.Ajax.request({url:b,params:d,success:submitAppOk,failure:submitFailGeneric})}var editcreate_w=null,editcreate_h=null;
function showWindow(a,b,c,d){if(d&&"undefined"!=typeof sharedfolderaidmap[a]&&(shareid=sharedfolderaidmap[a],"undefined"!=typeof sharedfolderdata[shareid]&&"0"==sharedfolderdata[shareid].give)){alert(gs("This is a shared site. You are not permitted to clone it."));return}var e=geturltoloadex("show_website.php"),f={src:"website",extjs:1,aid:a};"undefined"!=typeof b&&null!=b&&(f.url=b);"undefined"!=typeof c&&null!=c&&(f.pwhash=c);""!=g_sessionid&&(f.wxsessid=g_sessionid);"undefined"!=typeof sharedfolderaidmap[a]&&
(f.sharedfolderid=sharedfolderaidmap[a]);d&&(f.clone=1);a=gs("Edit Site Information");"undefined"!==typeof document.accountform&&0<document.accountform.length&&document.accountform.parentNode.removeChild(document.accountform);hidedialog();lpwindowx({title:a,url:e,urlParams:f})}var ffwin=null;
function showFFWindow(a,b,c,d){var e=null;"undefined"!=typeof g_token?e=g_token:document.getElementById("csrftoken")&&(e=document.getElementById("csrftoken").value);var f={src:"website",ffid:a};b&&(f.copyffid=b);c&&(f.profiletype=c);"undefined"!=typeof g_sessionid&&""!=g_sessionid&&(f.wxsessid=g_sessionid);"undefined"!=typeof d&&null!=d&&(f.pwhash=d);b=b?b:a;"undefined"!=typeof sharedfolderaidmap["ff"+b]&&(f.sharedfolderid=sharedfolderaidmap["ff"+b]);e&&(f.token=e);var g=0!=a?gs("Edit Form Fill Profile"):
gs("Add Form Fill Profile");$.ajax({type:"POST",url:geturltoloadex("formfill.php"),data:f,success:function(a){lpwindowx({title:g,html:a})}})}function showIdentWindow(a,b,c,d){null==a&&(a="0");var e={src:"website",iid:a};b&&(e.copyiid=b);c&&(e.isrole=1);"undefined"!=typeof d&&null!=d&&(e.pwhash=d);a=0!=a?c?gs("Edit Role"):gs("Edit Identity"):c?gs("Add Role"):gs("Add Identity");lpwindow({title:a,url:geturltoloadex("identity.php"),urlParams:e,closeiframe:!0,topv:50})}
function showFWindow(a,b,c){if("undefined"!=typeof a&&0!=a){var d=("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"showshare.php";a={src:"website",cmd:"showshares",shareeuid:a};c&&(a.token=c);"undefined"!=typeof b&&null!=b&&(a.pwhash=b);b=gs("View Shares");lpwindow({title:b,url:geturltoloadex(d),urlParams:a,width:"95%",contentheight:600,topv:10,maxwidth:1E4})}}
function showAlertWindow(a,b,c){if("undefined"!=typeof a&&0!=a)if("noalert"!=a&&"undefined"!=typeof g_premiumcreditmonids&&"undefined"==typeof g_premiumcreditmonids[a])document.location.href=geturltoloadex("features_joinpremium_creditmon.php?id="+encodeURIComponent(a));else{var d={src:"website"};"noalert"===a?(d.cmd="showenrollment",d.subscriberid=c):(d.cmd="showalert",d.id=a);"undefined"!=typeof b&&null!=b&&(d.pwhash=b);a=gs("View Alerts");lpwindow({title:a,url:geturltoloadex("creditmon.php"),urlParams:d,
closeiframe:!0,width:"95%",contentheight:600,topv:10,maxwidth:1E4});hookidwselect()}}function hookidwselect(){"idwpage"!=$("#idwpage").attr("id")?setTimeout(function(){hookidwselect()},300):$("#idwpage").change(function(){var a=$("#idwpage").val();$("#idwiframe").attr("src",a)})}
function deleteAlert(a,b,c){var d=getActionMessage(alertgroupstore,"Delete");var e=getActionMessage(alertgroupstore,"DeleteConfirm");var f="undefined"==typeof b?null:b;lpconfirmbox(d,e,function(){realdeleteAlert(a,f,c)})}function realdeleteAlert(a,b,c){a={src:"website",cmd:"deletealert",id:a};"undefined"!=typeof b&&null!=b&&(a.pwhash=b);"string"==typeof c&&(a.token=c);Ext.Ajax.request({url:geturltoloadex("creditmon.php"),params:a,success:deleteAlertSuccess,failure:deleteAlertFailed})}
function deleteAlertSuccess(a,b){if("undefined"!=typeof g_credmoniframe)document.location.reload();else{hide_waitbox();var c=getCurrentStore();if(a.responseXML){var d=a.responseXML.getElementsByTagName("result")[0];if(d)for(showMessageWindow(gs("Alert deleted!")),a=d.getAttribute("id"),c.clearFilter(),a=c.query("id",a,!1,!0),b=0;b<a.length;++b)a.itemAt(b).data.deleted="-1",a.itemAt(b).data.visible=!1,c.remove(a.itemAt(b));else deleteAlertFailed(a,b)}else deleteAlertFailed(a,b)}}
function deleteAlertFailed(a,b){hide_waitbox();showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}function showAppWindow(a,b,c){b={src:"website",appaid:a};"undefined"!=typeof c&&null!=c&&(b.pwhash=c);"undefined"!=typeof sharedfolderaidmap["app"+a]&&(b.sharedfolderid=sharedfolderaidmap["app"+a]);a=gs("Edit Application");lpwindow({title:a,url:geturltoloadex("appfields.php"),urlParams:b})}
function shareSel(a){var b=getselcount();if(0==b)lpmessagebox(gs("Please Make a Selection"),gs("You have not selected any items. Please click on the checkbox next to the items you wish to share."));else if(20<b)lpmessagebox(gs("Invalid Selection"),sprintf(gs("You have selected too many items. Please limit your selection to %s items."),20));else{var c=[];b=getCurrentStore();var d=!1,e;for(e in selrows)if(selrows[e]&&"remove"!=e&&"indexOf"!=e){if("undefined"!=typeof sharedfolderaidmap[e]){lpmessagebox(gs("Invalid Selection"),
gs("You cannot share items that are already in a shared folder."));return}c[c.length]=e;if(!d){var f=b.query("id",e,!1,!0);0<f.length&&"1"==f.itemAt(0).data.pwprotect&&(d=!0)}}pa(function(b){showShareWindow(c,!1,null,null,null,a,b)},g_edit_site_prompt||g_edit_sn_prompt||d,null,null,!0)}}generatesharingkeyswin=null;function showGenerateSharingKeysWindow(){$.ajax({type:"GET",url:"generatesharingkeys.php",success:function(a){lpwindowx({title:"Generate Sharing Keys",html:a})}})}
function showShareWindow(a,b,c,d,e,f,g){if("string"==typeof a){if(aidIsChecked(a)){shareSel();return}","==a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));a=a.split(",")}b={src:"website",cmd:"show",numaids:a.length};if(0==a.length)alert(gs("Please select at least one item to share"));else{for(var m in a)"string"==typeof a[m]&&""!=a[m]&&(b["aid"+m]=a[m]);"string"==typeof c&&(b.emails=c,b.shareautoaccept=1);"string"==typeof e&&(b.iid=e);"string"==typeof f&&(b.token=f);"string"==typeof d&&(b.giveshare=
d);"undefined"!=typeof g&&null!=g&&(b.pwhash=g);lpwindowx({title:"Share",url:geturltoloadex(("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"showshare.php"),urlParams:b,maxwidth:620,width:620});"string"==typeof c&&(document.location.href.match(/^https?:\/\/lastpass.com\/enterprise_users.php/i),document.location.href.match(/^https?:\/\/[^\/]*.lastpass.com\/~[^\/]*\/enterprise_users.php/i))}}
function showAcceptShareUpdatesWindow(a){a="showacceptshareupdate.php?cmd="+encodeURIComponent("show")+"&shareraid="+encodeURIComponent(a);var b=gs("Accept Share Updates");lpwindowx({title:b,url:geturltoloadex(a),closeiframe:!0})}
function showAcceptShareWindow(a,b,c,d){if("undefined"!=typeof c&&null!=c)setTimeout(function(){showAcceptShareWindow(a,b,null,d)},c);else{c=("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"showacceptshare.php";var e={src:"website",cmd:b,aid:a};"undefined"!=typeof d&&null!=d&&(e.pwhash=d);var f="";switch(b){case "showaccept":f=gs("Accept Shared Site");break;case "showreject":f=gs("Reject Shared Site");break;case "showdelete":f=gs("Delete Shared Site");break;case "showview":f=gs("View Shared Site")}lpwindow({title:f,
url:geturltoloadex(c),urlParams:e,closeiframe:!0,force:1,name:"shareacceptwin"})}}var bmlwin=null;function showBookmarkletWindow(){lpwindowx({title:"LastPass Bookmarklets",url:geturltoloadex("bm.php?extjs=1")})}function removeEl(a){document.getElementById(a)&&(a=document.getElementById(a),a.parentNode.removeChild(a))}
function loadurl(a,b,c,d,e){c||(c="GET");d||(d="");removeEl("backicon");removeEl("sfsettings");b=geturltoloadex(b);a==shwin&&Lpwm.settitle(shwin,gs("LastPass Shared Folder"));$.ajax({type:c,url:b,data:d,success:function(b){$("#"+a).html(b)},error:function(a){e&&e()}})}
function createSharedFolder(a,b,c,d,e,f){if(""==a)lpmessagebox(null,gs("Please enter a folder name."));else if(a&&0<=a.indexOf("\\"))lpmessagebox(null,gs("Invalid folder name. Please enter a folder name without slashes."));else{c=c+"@"+d+"-"+a;d=get_random_password();var g="undefined"!=typeof g_key_iterations?g_key_iterations:1,m=make_lp_key_iterations(c,d,g);g=make_lp_hash_iterations(m,d,g);d=new RSAKey;if(parse_public_key(d,b)){b=d.encrypt(AES.bin2hex(m));e={id:"0",update:"1",newusername:c,newhash:g,
sharekey:b,sharename:lpenc("Shared-"+a,m),name:a,token:e};if("undefined"!=typeof adminuids&&"undefined"!=typeof adminkeys&&"undefined"!=typeof adminuidcnt){for(b=0;b<adminuidcnt;b++){d=new RSAKey;if(!parse_public_key(d,adminkeys[b])){lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key."));return}c=d.encrypt(AES.bin2hex(m));e["adminsharekey"+b]=c;e["adminuid"+b]=adminuids[b]}e.adminuidcnt=adminuidcnt}Ext.Ajax.request({url:geturltoloadex(("undefined"!=
typeof g_urlprefix?g_urlprefix:"")+"share.php"),method:"POST",dataType:"xml",params:e,success:function(b){"alreadyexists"==b.responseText?lpmessagebox(null,gs("Sorry, a shared folder with that name already exists within this company.  It is possible that this is a deleted folder name.")):"notpremium"==b.responseText?lpmessagebox(null,gs("Sorry, you need to be a LastPass Premium member to use Shared Folders.")):"exceededlimit"==b.responseText?lpmessagebox(null,gs("Sorry, as a premium user, you are limited to one Shared Folder. Please consider using LastPass Enterprise if you would like more.")):
"error"==b.responseText?lpmessagebox(null,gs("Sorry, an error occurred while trying to create the shared folder. Please relogin and try again.")):(b=b.responseXML.getElementsByTagName("ok")[0].getAttribute("id"),"function"==typeof addSharedFolderToVault&&addSharedFolderToVault("Shared-"+a,m,b),"undefined"!=typeof g_localvault&&"function"==typeof refreshsites?refreshsites(f,b):send_website_event("refresh"),loadurl(shwin,("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php?id=-1"))},failure:function(){lpmessagebox(gs("An Error Occurred"),
gs("An error occurred. Please try again later."))}})}else lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key."))}}function getDecryptedPrivateKey(a){a=rsa_extract_privatekey(a,g_local_key);""==a&&"undefined"!=typeof Ext&&lpmessagebox(gs("An Error Occurred"),gs("It looks like your sharing key is missing. Please log in to the LastPass extension and try again. If the problem persists, contact LastPass Support."));return a}var g_pubkeyinfo=[];
function assignSharedFolder(a,b,c,d,e,f,g,m,h,n,p){if(c&&0<=c.indexOf("\\"))lpmessagebox(null,gs("Invalid folder name. Please enter a folder name without slashes."));else{var r="";r=a&&0==a.indexOf("group:")?r+("&cgid="+encodeURIComponent(a.substring(6))):a&&0==a.indexOf("other:")?r+("&other="+encodeURIComponent(a.substring(6))):r+("&uid="+encodeURIComponent(a));g_pubkeyinfo=[];Ext.Ajax.request({url:geturltoloadex(("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php?getpubkey=1"+r),success:function(a){var r=
Ext.decode(a.responseText);if("object"==typeof r){var q=0,u=[],B=[];a="";if("undefined"!==typeof r.error&&"blockedbypolicy"==r.error)lpmessagebox(null,r.errortxt),document.getElementById("submitbutton").disabled=!1;else{for(var y=0;"undefined"!=typeof r["pubkey"+y];y++){var G=r["pubkey"+y],A=r["uid"+y],C=r["username"+y],D="undefined"==typeof r["cgid"+y]?"":r["cgid"+y];""==G||null==G?(a+=C+", ",u[u.length]=A,B[B.length]=D,q=1):g_pubkeyinfo[g_pubkeyinfo.length]={pubkey:G,theuid:A,cgid:D}}(g_pubkeyinfo.length||
q)&&decryptrsavaluetryaes(d,b,p,c,function(a){var b=lpdec(c,AES.hex2bin(a));b&&0==b.indexOf("Shared-")&&(b=b.substring(7));b="id="+encodeURIComponent(e)+"&update=1&add=1&sharename="+encodeURIComponent(c)+"&name="+encodeURIComponent(b)+"&readonly="+encodeURIComponent(f)+"&give="+encodeURIComponent(g)+"&notify="+encodeURIComponent(m)+"&canadminister="+encodeURIComponent(h)+"&token="+encodeURIComponent(n);for(var d=0,p=0;p<g_pubkeyinfo.length;p++){var r=g_pubkeyinfo[p],q=new RSAKey;parse_public_key(q,
r.pubkey)?(q=q.encrypt(a),b+="&sharekey"+p+"="+encodeURIComponent(q),b+="&uid"+p+"="+encodeURIComponent(r.theuid),b+="&cgid"+p+"="+encodeURIComponent(r.cgid),d++):lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key."))}for(p=0;p<u.length;p++)b+="&msfuser"+p+"="+encodeURIComponent(u[p]),b+="&msfcgid"+p+"="+encodeURIComponent(B[p]),d++;0==d?lpmessagebox(gs("An Error Occurred"),"An Error occurred - Cannot decrypt any public keys. [ASF2]"):(a=geturltoloadex(("undefined"!=
typeof g_urlprefix?g_urlprefix:"")+"share.php"),hidedialog({name:"shareout"}),loadcallback=function(){lpmessagebox(gs("An Error Occurred"),gs("Error communicating with server."))},loadurl(shwin,a,"POST",b,loadcallback))});"undefined"!=typeof r.error&&"nouser"==r.error?(r="undefined"!=typeof r.unknownusers?r.unknownusers:"",a=""+sprintf(gs("The following users do not have an existing LastPass account: they'll need to create one before you can add them to your shared folder. Click below to invite them. If they join LastPass, %sboth of you will receive 1 month of LastPass Premium for free%s."),
"<b>","</b>"),a=a+"<br/><br/>"+of(r),a+="<div style='text-align:center;' class='wbnc'>",r=geturltoloadex("https://lastpass.com/friendemail.php?inviteto="+ofja(r)),a=a+("<br/><br/><input type='submit' class='nbtn rbtn btn_midi btn_exp_h' onclick='window.open(\""+r+"\");return false;' value='Invite Your Friend'>")+"</div>",lpmessagebox(gs("User Does Not Exist"),a)):"undefined"!=typeof r.error&&"emptygroup"==r.error?lpmessagebox(gs("An Error Occurred"),gs("An Error occurred - Empty User Group. Please add some users to this group and try again.")):
q&&(r=gs("The following users do not currently have sharing keys.")+"<br><br>"+gs("They can generate sharing keys by logging into LastPass via the LastPass Internet Explorer, Firefox, or Google Chrome browser extensions, or by logging into the website and clicking on the Generate Sharing Keys link.")+"<br><br>"+gs("Once they do that this Shared Folder will become accessible to them:")+"<br><br>",lpmessagebox("",r+a.substring(0,a.length-2)));document.getElementById("submitbutton")&&(document.getElementById("submitbutton").disabled=
!1)}}else lpmessagebox(gs("An Error Occurred"),gs("An Error occurred - Cannot retrieve public key."))},failure:function(){lpmessagebox(gs("An Error Occurred"),gs("An Error occurred"))}})}}function decryptrsavaluetryaes(a,b,c,d,e){if(c&&c.length&&(c=lpdec(c),(d=lpdec(d,AES.hex2bin(c)))&&d.length)){e(c);return}decryptrsavalue(a,b,e)}var g_decryptrsavaluecallback=null,g_rsadecrypt=null;
function decryptrsavalue(a,b,c,d){d="undefined"==typeof d?0:d;"undefined"!=typeof c&&null!=c&&(g_decryptrsavaluecallback=c);if(10<=d){if(!g_rsadecrypt&&(g_rsadecrypt=new RSAKey,!parse_private_key(g_rsadecrypt,getDecryptedPrivateKey(a)))){g_rsadecrypt=null;lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot rsa decrypt value."));return}a=g_rsadecrypt.decrypt(b);g_decryptrsavaluecallback&&g_decryptrsavaluecallback(a)}else send_website_event("rsadecrypt",a,"",b),decryptrsavaluecheck(a,
b,d)}function decryptrsavaluecheck(a,b,c){var d=document.getElementById("eventtype").value,e=document.getElementById("eventdata4").value;"ok"==d?(d=AES.hex2bin(e),g_decryptrsavaluecallback&&g_decryptrsavaluecallback(d)):(++c,10<=c?decryptrsavalue(a,b,null,c):setTimeout(function(){decryptrsavaluecheck(a,b,c)},20))}var shwin=null;
function showSharedFolder(a,b,c,d){b=("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php?id="+encodeURIComponent(a)+"&fromlocal="+(1==b?1:0);var e=gs("LastPass Shared Folder");-1001===a?e=gs("Verify Linked Personal Account"):-1E3===a&&(e=gs("Link Personal Account"));a="undefined"!==typeof lp_phpsessid?{"X-Wxsessid":lp_phpsessid}:{};c&&(b+="&showrename");d&&(b+="&foldername="+encodeURIComponent(d));null!==shwin&&hidedialog();lpwindowx({title:e});shwin=Lpwm.gettophtmlid();$.ajax({type:"GET",
url:b,headers:a,success:function(a){$("#"+shwin).html(a)}})}
function showAddWindow(a,b){var c=getCurrentStore();if(c==ffgroupstore||"ff"==c||"credmon"==c)pa(function(a){showFFWindow(0,0,b,a)},g_view_ff_prompt,null,null,!0);else if(c==identgroupstore||"ident"==c)pa(function(a){showIdentWindow(null,null,null,a)},pwprotect_ident("",!0),null,null,!0);else if(c==rolegroupstore)pa(function(a){showIdentWindow(null,null,1,a)},pwprotect_ident("",!0),null,null,!0);else{c="show_website.php?extjs=1";var d=gs("Add Site Information");a&&(d=gs("Add Secure Note"),c+="&sn=1");
hidedialog();lpwindowx({title:d,url:geturltoloadex(c),name:"editwin"})}}function showFieldsWindow(a,b,c){a={src:"website",extjs:1,aid:encodeURIComponent(a)};""!=g_sessionid&&(a.wxsessid=g_sessionid);"undefined"!=typeof b&&null!=b&&""!=b&&(a.sharedfolderid=b);"undefined"!=typeof c&&null!=c&&(a.pwhash=c);title=gs("Edit Site Fields");lpwindow({title:title,url:geturltoloadex("fields.php"),urlParams:a,name:"fieldswin"})}
function showAddFieldWindow(a,b){a="fields.php?extjs=1&adddlg=1&aid="+encodeURIComponent(a);"undefined"!=typeof b&&null!=b&&""!=b&&(a+="&sharedfolderid="+encodeURIComponent(b));lpwindow({title:title,url:geturltoloadex(a)})}
function addField(a,b,c,d){var e=a.getElementById("addfieldname").value,f=a.getElementById("addfieldtype").value,g=a.getElementById("addformname")?a.getElementById("addformname").value:null;if(""==e)lpmessagebox(null,gs("You must enter a name."));else{var m="_"+e;null!=g&&(m="_"+g+m);if(a.getElementById(m))lpmessagebox(null,gs("You must enter a unique name."));else{try{var h=a.getElementById("fieldstable"),n=a.createElement("tr"),p=a.createElement("td"),r=a.createTextNode("checkbox"==f?" "+e:e+" ");
n.appendChild(p);var q=a.createElement("input");q.type=f;q.id=m;q.name=m;"checkbox"==f?(p.appendChild(q),p.appendChild(r)):(p.appendChild(r),p.appendChild(q));h.appendChild(n);var w="fields.php?add=1&aid="+encodeURIComponent(b)+"&urid="+encodeURIComponent(c)+"&name="+encodeURIComponent(e)+"&type="+encodeURIComponent(f);null!=g&&(w+="&formname="+encodeURIComponent(g));"undefined"!=typeof d&&null!=d&&""!=d&&(w+="&sharedfolderid="+encodeURIComponent(d));Ext.Ajax.request({url:geturltoloadex(w),failure:function(a,
b){lpmessagebox(gs("An Error Occurred"),gs("An error occurred. Please try again later."))},success:function(a,b){send_website_event("refresh")}})}catch(v){reportError("Error in addField(): "+v+" ln: "+v.lineNumber)}hidedialog()}}}
function showPasswordHistoryWindow(a,b,c){var d={src:"website",extjs:1,aid:encodeURIComponent(a)};"undefined"!=typeof c&&null!=c&&(d.pwhash=c);"undefined"!=typeof sharedfolderaidmap[a]&&(d.sharedfolderid=sharedfolderaidmap[a]);b?(d.username=1,a=gs("Username History")):a=gs("Password History");lpwindow({title:a,url:geturltoloadex("pw_hist.php"),urlParams:d})}
function showNotesHistoryWindow(a){var b="notes_hist.php?src=website&extjs=1&aid="+encodeURIComponent(a);"undefined"!=typeof sharedfolderaidmap[a]&&(b+="&sharedfolderid="+encodeURIComponent(sharedfolderaidmap[a]));a=gs("Note History");lpwindow({title:a,url:geturltoloadex(b)})}function showGoogleAuthWindow(){showSettingsWindow("opengoogleauth=1")}var gRecovery=null,recovery_func=null;
function showSettingsWindow(a,b){try{a||-1==top.location.href.indexOf("opengoogleauth=1")||(a="opengoogleauth=1")}catch(e){}var c=("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"settings.php?extjs=1",d=null;"undefined"!=typeof g_localvault&&(c+="&localvault=1");a&&(c+="&"+a);b&&(gRecovery=b);null!=gRecovery&&(c+="&recovery="+gRecovery,recovery_func=d=function(){lpmessagebox(null,gs("Account Recovery detected. It is essential that you immediately change your password! Enter a new password and password hint. You will not be prompted for your old password."),
function(){hidedialog();"function"!=typeof checkpwstrength&&(checkpwstrength=function(){return!0});validate_settings_formex(checkpwstrength,!0)})});loadsettingswin(c,d)}var g_settingswin=null;
function loadsettingswin(a,b,c,d){if(-1!==a.indexOf("settings_multifactor")){var e=-1===window.location.search.indexOf("webvault=1"),f=function(a){try{$.ajax({url:"/lmiapi/mfa/is-enabled",type:"GET",contentType:"application/json",headers:{"X-CSRF-TOKEN":a},success:function(a){!e&&parent.parent.window.reduxApp&&"function"===typeof parent.parent.window.reduxApp.setMultifactorEnabledState&&parent.parent.window.reduxApp.setMultifactorEnabledState(a);e&&send_message_to_parent("trigger_security_score_calculation",
{mfaEnabled:a})}})}catch(p){console.log("unable to refresh MFA state in redux",p)}};e?$.ajax({url:"getCSRFToken.php",type:"GET",success:function(a){f(a)}}):f(decodeURIComponent(parent.parent.parent.window.g_token))}b="undefined"==typeof b?null:b;var g={global:!1,cache:!1,timeout:2E4,dataType:"html",url:geturltoloadex(a),success:function(d){hidedialog("pleasewait");0==$("#"+g_settingswin).length?(hidealldialogs(!1),window.location.search.includes("reactportal")?AccountSettingsTabController&&AccountSettingsTabController.reload():
lpwindowx({name:"settingswin",html:d,title:m,closeiframe:!0,padding:0,aftershow:b,overflow:"visible",nomaxheight:1,noheight:1,nomaxwidth:1,settingswin:1,addnewstyle:!0}),g_settingswin=Lpwm.gettophtmlid()):window.location.search.includes("reactportal")?AccountSettingsTabController&&AccountSettingsTabController.reload():$("#"+g_settingswin).html(d);if(-1!==a.indexOf("update_label")||-1!==a.indexOf("set_enabled")){var e=-1===window.location.search.indexOf("webvault=1");!e&&parent.parent.window.reduxApp&&
"function"===typeof parent.parent.window.reduxApp.trustedDeviceUpdated&&parent.parent.window.reduxApp.trustedDeviceUpdated();e&&send_message_to_parent("trusted_device_label_edit")}"undefined"!=typeof c&&c(d)},error:function(a){callback=function(){hidealldialogs(!1)};lpmessagebox(null,gs("Failed to contact the server while loading settings window"),callback)}},m=gs("Account Settings");if(g_settingswin){for(var h=window.location.search.includes("reactportal")?1:2;Lpwm.getnumwindows()>h;)hidedialog();
lpwindow({title:gs("Please wait..."),html:"<center><img src='/opensslccs/wait.gif'/></center>",name:"pleasewait",showclose:!1});d=$.extend(g,d);"undefined"!==typeof lp_phpsessid&&(d.data=$.extend(d.data,{wxsessid:lp_phpsessid}));window.location.search.includes("reactportal")&&!d.url.includes("reactportal")&&(g=a.includes("?")?"&reactportal":"?reactportal",d.url+=g);$.ajax(d)}else hidealldialogs(!1),window.location.search.includes("reactportal")?(g=a.includes("?")?"&reactportal":"?reactportal",location.replace(geturltoloadex(a+
g))):lpwindowx({name:"settingswin",title:m,url:geturltoloadex(a),closeiframe:!0,padding:0,aftershow:b,overflow:"visible",nomaxheight:1,noheight:1,nomaxwidth:1,settingswin:1,addnewstyle:!0,urlParams:{deviceId:g_passwordless_deviceId}})}function showHistoryWindow(){var a=geturltoloadex("history.php?extjs=1&frame=1");var b=gs("History");hidedialog();lpwindowx({title:b,url:a})}var msgCt;
function showMessageWindow(a,b){"undefined"==typeof a&&(a="Unknown message!");if(!navigator.userAgent||-1==navigator.userAgent.indexOf("MSIE 9")){msgCt||(msgCt=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},!0));msgCt.alignTo(document,"t-t",[0,0]);var c="close"+Math.random(),d=String.format.apply(String,Array.prototype.slice.call(arguments,0)),e=Ext.DomHelper.append(msgCt,['<div class="msg"><div class="x-box-tl"><div class="x-box-tr"><div class="x-box-tc"></div></div></div>','<div class="x-box-ml"><div class="x-box-mr"><div class="x-box-mc"><div class="x-tool x-tool-close" id="'+
c+'"></div><h3>',"Message</h3>",d,'</div></div></div><div class="x-box-bl"><div class="x-box-br"><div class="x-box-bc"></div></div></div></div>'].join(""),!0);if(c=document.getElementById(c))c.onclick=function(){e.ghost("t",{remove:!0})};e&&(b?e.slideIn("t"):e.slideIn("t").pause(1).ghost("t",{remove:!0}));return e}}function toggle(a){if(a=document.getElementById(a))a.style.display="none"==a.style.display?"block":"none"}var infav=!1;
function favorites(){if("undefined"!=typeof g_newvault){infav=!0;var a=getBG().g_sites,b=0,c;for(c in a)1==a[c].fav&&(b++,ls(a[c].aid));0==b&&lpmessagebox(null,gs("You do not have any Favorites yet."))}else for(a=getCurrentStore().query("fav","1",!1,!0),infav=!0,c=0;c<a.length;c++)b=a.itemAt(c),"0"==b.data.deleted&&eval(b.data.launchjs);infav=!1}
function open_group(a,b){if("(New Pending Share Offers)"==a||a==gs("(New Pending Share Offers)"))return lpmessagebox(null,gs("Since these sites are pending shares, we are unable to log you in.")),!1;if(document.getElementById("showdeleted").checked)return lpmessagebox(null,gs("Since this site is deleted, we are unable to log you in.")),!1;for(var c=getCurrentStore().query("group",a,!1,!0),d=0,e=0;e<c.length;e++){var f=c.itemAt(e);f.data.group==a&&0==f.data.deleted&&d++}if(!b&&10<d)b=sprintf(gs("Choosing to 'Open' %s sites at once may take a long time and cause your browser to respond slowly."),
d)+"\n\n"+gs("Do you want to continue?"),lpconfirmbox(gs("Confirm 'Open' Action"),b,function(){open_group(a,!0)});else for(e=0;e<c.length;e++)f=c.itemAt(e),f.data.group==a&&0==f.data.deleted&&eval(f.data.launchjs);return!0}
function select_all(a,b,c){(a="off"==c.target)?(c.innerHTML=gs("Deselect All"),c.target="on"):(c.innerHTML=gs("Select All"),c.target="off");b=getCurrentStore().query("group",b,!1,!0);c=document.getElementById("showdeleted").checked;for(var d=0;d<b.length;d++){var e=b.itemAt(d);if(!(c^e.data.deleted)&&e.data.visible){var f=document.getElementById(e.data.id+"_cb");f&&(f.checked=a,clickcheck(f.checked,e.data.id,1))}}return!0}
function confirmDelete(){var a=getActionMessage(getCurrentStore(),"Delete");var b=getActionMessage(getCurrentStore(),"DeleteConfirm");lpconfirmbox(a,b,function(){submitShow(!0)})}function confirmUndelete(){var a=getActionMessage(getCurrentStore(),"Undelete");var b=getActionMessage(getCurrentStore(),"UndeleteConfirm");lpconfirmbox(a,b,function(){submitShow(!1,!0)})}var gPurgeAid=-1;
function confirmPurge(a,b,c){var d="undefined"!=typeof b?b:null;gPurgeAid=a.split(",");a=gs("Purge");b=getActionMessage(getCurrentStore(),1===gPurgeAid.length?"DelForeverConfirm":"DelForeverConfirmMultiple");lpconfirmbox(a,b,function(){purgeSite(gPurgeAid,d,c)})}
function purgeSite(a,b,c){var d=a;"object"!=typeof a&&(d=[],d[d.length]=a);if(checkIllegalSharedFolderDelete(d,"purge")){for(var e=a="",f=0,g=0;g<d.length;g++){var m=d[g];a+=e+m;e=",";"undefined"!=typeof sharedfolderaidmap[m]&&(f=sharedfolderaidmap[m])}d=[];d.purgeext=1;d.ajax=1;d.extjs=1;d.aid=a;d.hasplugin=g_hasplugin;"undefined"!=typeof b&&null!=b&&(d.pwhash=b);"string"==typeof c&&(d.token=c);0!=f&&(d.sharedfolderid=f);(new Ext.data.Connection).request({url:geturltoloadex("show_website.php?src=website"),
method:"POST",params:d,success:purgesuccess,failure:purgefailure})}}function purgesuccess(a,b){if(a.responseXML){var c=a.responseXML.getElementsByTagName("result")[0];if(c){showMessageWindow(gs("SUCCESS!")+"\r\n"+gs("Item has been permanently deleted"));increment_accts_version();a=getBG();c=c.getAttribute("aid").split(",");if("undefined"!=typeof a.g_deleted_sites){for(var d in c)delete a.g_deleted_sites[c[d]];repopulate()}return}}purgefailure(a,b)}
function purgefailure(a,b){hide_waitbox();lpmessagebox(gs("An Error Occurred"),gs("An error occurred. Please try again later."))}function griddelete_purge(a,b){a=a.query("id",b,!1,!0);for(b=0;b<a.length;++b)a.itemAt(b).data.deleted="-1"}
function getSecureNoteFromFields(a){if("http://sn"==a.url.value||"687474703a2f2f736e"==a.url.value){var b=a.notestype.value;if("Generic"==b||"none"==document.getElementById("notesrow0").style.display)return a.extra.value;a="NoteType:"+b+"\n";for(var c in sntemplates[b])"text"==sntemplates[b][c]?a+=c+":"+document.getElementById("note_"+c).value+"\n":"date"==sntemplates[b][c]||"datemoyr"==sntemplates[b][c]?(a+=c+":"+document.getElementById("note_"+c+"_mo").value,"date"==sntemplates[b][c]&&(a+=","+document.getElementById("note_"+
c+"_day").value),a+=","+document.getElementById("note_"+c+"_yr").value+"\n"):"textarea"==sntemplates[b][c]&&(a+=c+":"+document.getElementById("note_"+c).value+"\n");return a}return a.extra.value}var deckey=null,foldername=null,g_submitshow=!1;
function submitShow(a,b,c){try{var d=document.accountform;if(1==a)d.deleteext.value="1";else if(1==b)d.undeleteext.value="1";else if(1==c)d.purgeext.value="1";else{if(""==d.name.value)return lpmessagebox(null,gs("You must enter a name.")),g_submitshow=!1;if(""!=d.origurl.value&&d.url.value!=d.origurl.value)return lpconfirmbox(gs("Confirm URL Change"),gs("Are you sure you want to change this site's URL?\n\nDoing so may cause it to stop working."),function(){document.accountform.origurl.value="";submitShow()}),
g_submitshow=!1;if(45E3<d.extra.value.length)return lpconfirmbox(gs("Notes Too Large"),gs("The notes field contains too much data.  You may store a maximum of 45,000 characters per note.\n\nWould you like us to truncate the note for you?  You will lose some of your data."),function(){document.accountform.extra.value=document.accountform.extra.value.substring(0,45E3);submitShow()}),g_submitshow=!1;var e=null;if(0==d.aid.value){var f=d.grouping.value,g=-1==f.indexOf("\\")?f:f.substr(0,f.indexOf("\\"));
if(""!=g&&"undefined"!=typeof sharedfoldergroups[g]){e=getShareId(g);deckey=g_rsadecryptedkeys[e];var m=document.createElement("input");m.type="hidden";m.name="sharedfolderid";m.value=e;document.accountform.appendChild(m);document.accountform.grouping.value=document.accountform.grouping.value.substr(g.length+1)}}"http://sn"==d.url.value&&(d.notetype.value=d.notestype.value);d.encuser.value=encecb(lp_username,deckey);d.name.value=lpenc(trim(d.name.value),deckey);d.grouping.value=lpenc(trim(d.grouping.value),
deckey);d.origurl.value=AES.url2hex(trim(d.origurl.value));d.url.value=AES.url2hex(punycode.URLToASCII(trim(d.url.value)));"undefined"!=typeof d.origusername&&d.username.value==lpdec(d.origusername.value,deckey)?d.username.value=d.origusername.value:d.username.value=enc(d.username.value,deckey);"undefined"!=typeof d.origpassword&&document.getElementById("p").value==lpdec(d.origpassword.value,deckey)?document.getElementById("p").value=d.origpassword.value:document.getElementById("p").value=enc(document.getElementById("p").value,
deckey);var h=getSecureNoteFromFields(d);"undefined"!=typeof d.origextra&&h==dec(d.origextra.value,deckey)?d.extra.value=d.origextra.value:d.extra.value=enc(h,deckey);d.openid_url.value=enc(d.openid_url.value,deckey);"undefined"!=typeof d.attachkey&&(d.attachkey.value=enc(d.attachkey.value,deckey));if("undefined"!=typeof attaches)for(var n=a=0;n<attaches.length;n++)if("undefined"!=typeof attaches[n].is_new&&attaches[n].is_new){var p=document.createElement("input");p.setAttribute("type","hidden");
p.setAttribute("name","mimetype"+a);p.setAttribute("value",attaches[n].mimetype);document.accountform.appendChild(p);var r=document.createElement("input");r.setAttribute("type","hidden");r.setAttribute("name","attachid"+a);r.setAttribute("value",attaches[n].id);document.accountform.appendChild(r);var q=document.createElement("input");q.setAttribute("type","hidden");q.setAttribute("name","attachbytes"+a);q.setAttribute("value",attaches[n].data);document.accountform.appendChild(q);var w=document.createElement("input");
w.setAttribute("type","hidden");w.setAttribute("name","filename"+a);w.setAttribute("value",attaches[n].filename);document.accountform.appendChild(w);a++}if("undefined"!=typeof removedattach)for(n=0;n<removedattach.length;n++){var v=document.createElement("input");v.setAttribute("type","hidden");v.setAttribute("name","rmattach"+n);v.setAttribute("value",document.accountform.aid.value+"-"+removedattach[n]);document.accountform.appendChild(v)}if(!(AES.ok(d.username.value)&&AES.ok(document.getElementById("p").value)&&
AES.ok(d.extra.value)&&AES.ok(d.openid_url.value)))return alert(gs("Failed to encrypt a field! ABORTING")),g_submitshow=!1}document.accountform.ajax.value="1";document.accountform.hasplugin.value=g_hasplugin;show_waitbox();"undefined"!=typeof g_newvault&&(m=document.createElement("input"),m.type="hidden",m.name="newvault",m.value="1",document.accountform.appendChild(m));Ext.Ajax.request({form:"accountform",extraParams:{extjs:"1"},success:function(a,b){submitOk(a,b,e)},failure:submitFail});return!0}catch(u){return reportError("Error in submitShow(): "+
u+" ln: "+u.lineNumber),!1}}function getFFPhone3L(a){var b=document.ffform;if("phone"==a)a="phonecountry";else if("eve"==a)a="evecountry";else if("fax"==a)a="faxcountry";else if("mobile"==a)a="mobcountry";else return"";b=b[a];a=b.selectedIndex;-1==a&&(a=0);return b.options[a].value}
function getFFPhoneNum(a){var b=getFFPhone3L(a);if(""==b)return"";b=cc3lphone_map[b];var c=document.ffform;if("phone"==a){a="phone_npa";var d="phone_nxx";var e="phone_xxxx";var f="phone_intl"}else if("eve"==a)a="evephone_npa",d="evephone_nxx",e="evephone_xxxx",f="evephone_intl";else if("fax"==a)a="fax_npa",d="fax_nxx",e="fax_xxxx",f="fax_intl";else if("mobile"==a)a="mobilephone_npa",d="mobilephone_nxx",e="mobilephone_xxxx",f="mobilephone_intl";else return"";return"1"==b?""==c[a].value&&""==c[d].value&&
""==c[e].value?"":b+c[a].value+c[d].value+c[e].value:""==c[f].value?"":b+c[f].value}var cc3l_map=[],phone_map=[],cc3lphone_map=[],g_cc3_from_ip2="",numcustomfields=0,statestore,statecombo;
function fix_phone(a,b,c){c=document.ffform;if("phone"==a){idhidden3lcc="phone3lcc";idhiddennum="phone";var d="phonecountry";var e="phoneext";var f="phone_dom";var g="phone_npa";var m="phone_nxx";var h="phone_xxxx";idcc="phone_cc";var n="phone_intl"}else if("eve"==a)idhidden3lcc="evephone3lcc",idhiddennum="evephone",d="evecountry",e="eveext",f="evephone_dom",g="evephone_npa",m="evephone_nxx",h="evephone_xxxx",idcc="evephone_cc",n="evephone_intl";else if("fax"==a)idhidden3lcc="fax3lcc",idhiddennum=
"fax",d="faxcountry",e="faxext",f="fax_dom",g="fax_npa",m="fax_nxx",h="fax_xxxx",idcc="fax_cc",n="fax_intl";else if("mobile"==a)idhidden3lcc="mobilephone3lcc",idhiddennum="mobilephone",d="mobcountry",e="mobileext",f="mobilephone_dom",g="mobilephone_npa",m="mobilephone_nxx",h="mobilephone_xxxx",idcc="mobilephone_cc",n="mobilephone_intl";else return;if(b){b=c[d];var p=c[idhidden3lcc].value;e=c[idhiddennum].value;"undefined"==typeof cc3lphone_map[p]&&(p="");if(""==e)document.getElementById(d).value=
g_cc3_from_ip2,fix_phone(a,!1,"a");else if(""==p)if("1"==e[0])for(f=b.options.length,d=0;d<f;++d){if("USA"==b.options[d].value){c[g].value=e.substring(1,4);c[m].value=e.substring(4,7);c[h].value=e.substring(7,11);b.selectedIndex=d;fix_phone(a,!1,"b");break}}else{f=b.options.length;for(d=0;d<f;++d)if(g=b.options[d].value,""!=g&&!typeof("undefined"==cc3lphone_map[g])&&""!=cc3lphone_map[g]){var r=cc3lphone_map[g];if(e&&0==e.indexOf(r)){c[n].value=e.substring(r.length);b.selectedIndex=d;fix_phone(a,!1,
"c");return}}c[n].value=e;b.selectedIndex=0;fix_phone(a,!1,"d")}else if("undefined"==typeof cc3lphone_map[p]||""==cc3lphone_map[p]||0!=e.indexOf(cc3lphone_map[p]))c[idhidden3lcc].value="",fix_phone(a,!0,"e");else if(r=cc3lphone_map[p],"1"==r){f=b.options.length;for(d=0;d<f;++d)if(b.options[d].value==p){c[g].value=e.substring(1,4);c[m].value=e.substring(4,7);c[h].value=e.substring(7,11);b.selectedIndex=d;fix_phone(a,!1,"f1");return}c[idhidden3lcc].value="";fix_phone(a,!0,"f2")}else{c[n].value=e.substring(r.length);
c=!1;f=b.options.length;for(d=0;d<f;++d)b.options[d].value==p&&(c=!0,b.selectedIndex=d);c||(b.selectedIndex=0);fix_phone(a,!1,"g")}}else b=c[d],d=b.selectedIndex,-1==d&&(d=0),p=b.options[d].value,a=""==p?"":cc3lphone_map[p],""==p?(c[g].disabled=!0,c[m].disabled=!0,c[h].disabled=!0,c[e].disabled=!0,c[idcc].value="",document.getElementById(f).style.display="",document.getElementById(n).style.display="none"):"1"==a?(c[g].disabled=!1,c[m].disabled=!1,c[h].disabled=!1,c[e].disabled=!1,c[idcc].value="",
document.getElementById(f).style.display="",document.getElementById(n).style.display="none"):(c[g].disabled=!1,c[m].disabled=!1,c[h].disabled=!1,c[e].disabled=!1,c[idcc].value=a,document.getElementById(f).style.display="none",document.getElementById(n).style.display="")}
function fix_birthday(){var a=document.ffform,b=a.birthday_month.selectedIndex;b=(2==b?""==a.birthday_year.value?29:checkleapyear(a.birthday_year.value)?29:28:4==b||6==b||9==b||11==b?30:31)+1;a.birthday_day.selectedIndex>=b&&(a.birthday_day.selectedIndex=b-1);for(var c=a.birthday_day.options.length-1;c>=b;c--)a.birthday_day.options[c]=null;for(c=a.birthday_day.options.length;c<b;c++)a.birthday_day.options[c]=new Option(c,c)}var g_dialogonce=!0;
function dialog_show(a,b){"undefined"==typeof b||b?($("#dialog .close").show(),g_dialogonce&&(g_dialogonce=!1,$("#dialog .close").click(function(){dialog_hide()}))):$("#dialog .close").hide();dialog_hide();$("#dialog .content").html(a);a=$("#dialog");var c=$(window);b=c.width();c=c.height();var d=a.width(),e=a.height();a.css({left:Math.floor((b-d)/2),top:Math.floor((c-e)/2),opacity:.9}).show()}function dialog_hide(){$("#dialog .content").html("");$("#dialog").hide();return!1}
function ffenablebuttons(a){$("#updatebutton").attr("disabled",!a);$("#cancelbutton").attr("disabled",!a);$("#helpbutton").attr("disabled",!a)}
function submitFF(a){try{ffenablebuttons(!1);var b=document.ffform,c="";if(a)b.deleteext.value="1";else{""==b.profilename.value&&(c+=gs("You must enter a profile name.")+"<br />\n");""==b.birthday_year.value&&""==b.birthday_month.value&&""==b.birthday_day.value||b.birthday_year.value.match(/^\d{4}$/)&&""!=b.birthday_month.value&&""!=b.birthday_day.value||(c+=gs("You must enter a valid birthday, with a 4 digit year.")+"<br />\n");var d=getFFPhone3L("phone"),e=getFFPhone3L("eve"),f=getFFPhone3L("fax"),
g=getFFPhone3L("mobile"),m=getFFPhoneNum("phone"),h=getFFPhoneNum("eve"),n=getFFPhoneNum("fax"),p=getFFPhoneNum("mobile");if(""!=d&&!m.match(/^\d*$/)||""!=e&&!h.match(/^\d*$/)||""!=f&&!n.match(/^\d*$/)||""!=g&&!p.match(/^\d*$/)||"1"==cc3lphone_map[d]&&""!=m&&!m.match(/^1(?:[2-9]\d{2}){2}\d{4}$/)||"1"==cc3lphone_map[e]&&""!=h&&!h.match(/^1(?:[2-9]\d{2}){2}\d{4}$/)||"1"==cc3lphone_map[f]&&""!=n&&!n.match(/^1(?:[2-9]\d{2}){2}\d{4}$/)||"1"==cc3lphone_map[g]&&""!=p&&!p.match(/^1(?:[2-9]\d{2}){2}\d{4}$/))c+=
gs("You must enter a valid phone number.")+"<br />";b.phoneext.value.match(/^\d*$/)&&b.faxext.value.match(/^\d*$/)&&b.mobileext.value.match(/^\d*$/)&&b.eveext.value.match(/^\d*$/)||(c+=gs("You must enter a valid extension, consisting only of digits.")+"<br />");""==b.ccnum_entry.value||b.ccnum_entry.value.match(/^\d{10,19}$/)||(c+=gs("You must enter your credit card number as a sequence of 10 to 19 digits, without dashes.")+"<br />\n");""==b.ccstart_year.value&&""==b.ccstart_month.value||b.ccstart_year.value.match(/^\d{4}$/)&&
""!=b.ccstart_month.value||(c+=gs("You must enter a valid credit card start date, with a 4 digit year.")+"<br />\n");""==b.ccexp_year.value&&""==b.ccexp_month.value||b.ccexp_year.value.match(/^\d{4}$/)&&""!=b.ccexp_month.value||(c+=gs("You must enter a valid credit card expiration date, with a 4 digit year.")+"<br />\n");""==b.cccsc_entry.value||b.cccsc_entry.value.match(/^\d{3,4}$/)||(c+=gs("You must enter your credit card security code as a sequence of 3 to 4 digits.")+"<br />\n");""==b.ccissuenum_entry.value||
b.ccissuenum_entry.value.match(/^\d{1,3}$/)||(c+=gs("You must enter your credit card issue number as a sequence of 1 to 3 digits.")+"<br />\n");""==b.email.value||b.email.value.match(/^.+@.+\.[A-Za-z]{2,}$/)||(c+=gs("You must enter a valid email address.")+"<br />\n");""==b.bankacctnum.value||b.bankacctnum.value.match(/^[0-9A-Za-z]+$/)||(c+=gs("You must enter a valid bank account number, consisting only of letters and digits.")+"<br />\n");""==b.bankroutingnum.value||b.bankroutingnum.value.match(/^\d+$/)||
(c+=gs("You must enter a valid bank routing number, consisting only of digits.")+"<br />\n");for(a=1;a<=numcustomfields;a++)if(""!=b["customfield"+a+"text"].value||""!=b["customfield"+a+"value"].value||""!=b["customfield"+a+"alttext"].value)if(""==b["customfield"+a+"text"].value||""==b["customfield"+a+"value"].value){c+=gs("All custom fields must have both text and a value.")+"<br />\n";break}}if(""!=c)return lpmessagebox(gs("Cannot Update"),c),ffenablebuttons(!0),!1;if(!ff_checkcreditmon())return!1;
if(!$("#ff_creditmon").attr("checked"))return submitFF2(""),!1;ff_creditmon()}catch(r){return reportError("Error in submitFF(): "+r+" ln: "+r.lineNumber),!1}}function ff_getprettyphone(a){return 11!=a.length?a:"("+a.substring(1,4)+") "+a.substring(4,7)+"-"+a.substring(7)}
function ff_creditmon(){$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:geturltoloadex("creditmon.php"),data:{cmd:"getterms"},success:function(a){if(1!=a.success)alert(gs("ERROR: An error occurred while attempting to contact the LastPass server.")+"\n\n"+a.reason2);else{var b=$(da.firstname).val(),c=$(da.lastname).val(),d=$(da.birthday_year).val()+"-"+$(da.birthday_month).val()+"-"+$(da.birthday_day).val(),e=$(da.ssn_entry).val(),f=$(da.address1).val(),g=$(da.address2).val(),m=$(da.address3).val(),
h=$(da.city).val(),n=statestore.query("name",statecombo.getValue());n=1==n.length?n.itemAt(0).data.code:statecombo.getValue();var p=$(da.country_select).val(),r=$(da.zip).val(),q=ff_getphonenumber();b='<div style="padding-left:20px;"><table style="padding:10px;border:1px solid black;background:#fff;width:100%;">'+('<tr><td style="background:#ccc;padding:5px;">Name</td><td style="padding-left:10px;">'+of(b)+" "+of(c)+"</td></tr>");b+='<tr><td style="background:#ccc;padding:5px;">Birthday</td><td style="padding-left:10px;">'+
of(d)+"</td></tr>";b+='<tr><td style="background:#ccc;padding:5px;">SSN</td><td style="padding-left:10px;">'+of(e)+"</td></tr>";b+='<tr><td style="background:#ccc;padding:5px;">Phone Number</td><td style="padding-left:10px;">'+of(ff_getprettyphone(q));b+='<tr><td style="background:#ccc;padding:5px;">Address</td><td style="padding-left:10px;">'+of(f);""!=g&&(b+=", "+of(g));""!=m&&(b+=", "+of(m));b+=", "+of(h)+", "+of(n)+", "+of(p)+", "+of(r)+"</td></tr>";d='<div style="text-align:left;width:700px;"><div style="font-size:14px;font-weight:bold;">To enable credit monitoring, please agree to the following terms:</div><br/><div style="font-weight:bold;"><ol><li>I permit the following data to be transferred to a remote server:</li></ul></div>'+
(b+"</table></div>")+'<br/><div style="font-weight:bold;"><ol start="2"><li>I allow Identity Rehab Corporation to monitor my credit and alert me of possible fraudlent activity and agree to the below terms and conditions:</li></ul></div>';d+='<div style="padding-left:20px;">';d+='<div style="height:200px;border:1px solid black;overflow-y:auto;background:#fff;">'+a.termshtml+"</div>";d+="</div>";d+="</div>";d+='<br/><form onsubmit="return false;"><input id="creditmonagree" type="submit" value="I AGREE" onclick="ff_creditmon2();"/>&nbsp;&nbsp;&nbsp;<input id="creditmondisagree" type="submit" value="I DO NOT AGREE" onclick="ffenablebuttons(true);dialog_hide();"/></form>';
dialog_show(d,!1)}},error:function(a){alert(gs("ERROR: The LastPass server could not be contacted."))}});return!1}
function ff_creditmon2(){$("#creditmonagree").attr("disabled",!0);$("#creditmondisagree").attr("disabled",!0);var a=$(da.firstname).val(),b=$(da.lastname).val(),c=$(da.birthday_year).val()+"-"+$(da.birthday_month).val()+"-"+$(da.birthday_day).val(),d=$(da.ssn_entry).val(),e=$(da.address1).val(),f=$(da.address2).val(),g=$(da.address3).val(),m=$(da.city).val(),h=statestore.query("name",statecombo.getValue()),n=1==h.length?h.itemAt(0).data.code:statecombo.getValue(),p=$(da.country_select).val(),r=$(da.zip).val(),
q=ff_getphonenumber();h=$(da.ffid).val();var w=$(da.token).val();a={cmd:"enroll",firstname:a,lastname:b,birthday:c,ssn:d,address1:e,address2:f,address3:g,city:m,state:n,country:p,zip:r,phone:q,ffid:h,token:w};"undefined"!=typeof sharedfolderaidmap["ff"+h]&&(a.sharedfolderid=sharedfolderaidmap["ff"+h]);$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:geturltoloadex("creditmon.php"),data:a,success:function(a){if(1!=a.success){alert(gs("ERROR: An error occurred while attempting to contact the LastPass server.")+
"\n\n"+a.reason2);dialog_hide();var b=[];"Zip code does not match state."==a.reason2?(ff_changetab("address"),b.push("state-select"),b.push("zip")):-1!=a.reason2.indexOf("You have another Fill Form profile with an identical SSN")&&(ff_changetab("personal"),b.push("ssn_entry"));for(a=0;a<b.length;++a)$(da[b[a]]).css("background","#FFCBD6").focus().select();ffenablebuttons(!0)}else dialog_hide(),ff_creditmon3(a.subscriberid,a.newffid)},error:function(a){alert(gs("ERROR: The LastPass server could not be contacted."));
dialog_hide()}})}function ff_creditmon3(a,b){submitFF2(b)}
function submitFF2(a){try{var b=document.ffform;b.newffid.value=a;b.profilename.value=lpenc(b.profilename.value,deckey);b.profilelanguage.value=b.profilelanguage_select.value;b.profilelanguage.value=lpenc(b.profilelanguage.value,deckey);b.firstname.value="ja-JP"==b.profilelanguage_select.value?lpenc(b.ff_firstnameja1.value,deckey):lpenc(b.firstname.value,deckey);b.firstname2.value=lpenc(b.firstname2.value,deckey);b.firstname3.value=lpenc(b.firstname3.value,deckey);b.middlename.value=lpenc(b.middlename.value,
deckey);b.lastname.value="ja-JP"==b.profilelanguage_select.value?lpenc(b.ff_lastnameja1.value,deckey):lpenc(b.lastname.value,deckey);b.lastname2.value="ja-JP"==b.profilelanguage_select.value?lpenc(b.ff_lastnameja2.value,deckey):lpenc(b.lastname2.value,deckey);b.lastname3.value=lpenc(b.lastname3.value,deckey);b.email.value=lpenc(b.email.value,deckey);b.mobileemail.value=lpenc(b.mobileemail.value,deckey);b.company.value=lpenc(b.company.value,deckey);b.ssn.value=lpenc(b.ssn_entry.value,deckey);b.ssn_entry.value=
b.ssn.value;b.birthday.value=""!=b.birthday_year.value&&""!=b.birthday_month.value&&""!=b.birthday_day.value?b.birthday_year.value+"-"+b.birthday_month.value+"-"+b.birthday_day.value:"";b.birthday.value=lpenc(b.birthday.value,deckey);b.title.value=b.title_select.value;b.title.value=lpenc(b.title.value,deckey);b.gender.value=b.gender_select.value;b.gender.value=lpenc(b.gender.value,deckey);b.address1.value=lpenc(b.address1.value,deckey);b.address2.value=lpenc(b.address2.value,deckey);b.address3.value=
lpenc(b.address3.value,deckey);b.city.value=lpenc(b.city.value,deckey);b.county.value=lpenc(b.county.value,deckey);b.state_name.value=statecombo.getValue();b.state_name.value=lpenc(b.state_name.value,deckey);var c=statestore.query("name",statecombo.getValue());b.state.value=1==c.length?c.itemAt(0).data.code:statecombo.getValue();b.state.value=lpenc(b.state.value,deckey);b.zip.value=lpenc(b.zip.value,deckey);b.country.value=b.country_select.value;b.country.value=lpenc(b.country.value,deckey);b.country_cc3l.value=
"undefined"!=typeof cc3l_map[b.country_select.value]?cc3l_map[b.country_select.value]:"";b.country_cc3l.value=lpenc(b.country_cc3l.value,deckey);b.country_name.value=b.country_select.options[b.country_select.selectedIndex].text;b.country_name.value=lpenc(b.country_name.value,deckey);var d=getFFPhone3L("phone"),e=getFFPhone3L("eve"),f=getFFPhone3L("fax"),g=getFFPhone3L("mobile"),m=getFFPhoneNum("phone"),h=getFFPhoneNum("eve"),n=getFFPhoneNum("fax"),p=getFFPhoneNum("mobile");b.phone3lcc.value=lpenc(d,
deckey);b.phone.value=lpenc(m,deckey);b.phoneext.value=lpenc(b.phoneext.value,deckey);b.phone_npa.value=lpenc(b.phone_npa.value,deckey);b.phone_nxx.value=lpenc(b.phone_nxx.value,deckey);b.phone_xxxx.value=lpenc(b.phone_xxxx.value,deckey);b.phone_cc.value=lpenc(b.phone_cc.value,deckey);b.phone_intl.value=lpenc(b.phone_intl.value,deckey);b.phonecountry.options[b.phonecountry.selectedIndex].value=lpenc(b.phonecountry.options[b.phonecountry.selectedIndex].value,deckey);b.fax3lcc.value=lpenc(f,deckey);
b.fax.value=lpenc(n,deckey);b.faxext.value=lpenc(b.faxext.value,deckey);b.fax_npa.value=lpenc(b.fax_npa.value,deckey);b.fax_nxx.value=lpenc(b.fax_nxx.value,deckey);b.fax_xxxx.value=lpenc(b.fax_xxxx.value,deckey);b.fax_cc.value=lpenc(b.fax_cc.value,deckey);b.fax_intl.value=lpenc(b.fax_intl.value,deckey);b.faxcountry.options[b.faxcountry.selectedIndex].value=lpenc(b.faxcountry.options[b.faxcountry.selectedIndex].value,deckey);b.mobilephone3lcc.value=lpenc(g,deckey);b.mobilephone.value=lpenc(p,deckey);
b.mobileext.value=lpenc(b.mobileext.value,deckey);b.mobilephone_npa.value=lpenc(b.mobilephone_npa.value,deckey);b.mobilephone_nxx.value=lpenc(b.mobilephone_nxx.value,deckey);b.mobilephone_xxxx.value=lpenc(b.mobilephone_xxxx.value,deckey);b.mobilephone_cc.value=lpenc(b.mobilephone_cc.value,deckey);b.mobilephone_intl.value=lpenc(b.mobilephone_intl.value,deckey);b.mobcountry.options[b.mobcountry.selectedIndex].value=lpenc(b.mobcountry.options[b.mobcountry.selectedIndex].value,deckey);b.evephone3lcc.value=
lpenc(e,deckey);b.evephone.value=lpenc(h,deckey);b.eveext.value=lpenc(b.eveext.value,deckey);b.evephone_npa.value=lpenc(b.evephone_npa.value,deckey);b.evephone_nxx.value=lpenc(b.evephone_nxx.value,deckey);b.evephone_xxxx.value=lpenc(b.evephone_xxxx.value,deckey);b.evephone_cc.value=lpenc(b.evephone_cc.value,deckey);b.evephone_intl.value=lpenc(b.evephone_intl.value,deckey);b.evecountry.options[b.evecountry.selectedIndex].value=lpenc(b.evecountry.options[b.evecountry.selectedIndex].value,deckey);b.ccname.value=
lpenc(b.ccname.value,deckey);b.ccnum.value=lpenc(b.ccnum_entry.value,deckey);b.ccnum_entry.value=b.ccnum.value;b.ccstart.value=""!=b.ccstart_year.value&&""!=b.ccstart_month.value?b.ccstart_year.value+"-"+b.ccstart_month.value+"-01":"";b.ccstart.value=lpenc(b.ccstart.value,deckey);b.ccexp.value=""!=b.ccexp_year.value&&""!=b.ccexp_month.value?b.ccexp_year.value+"-"+b.ccexp_month.value+"-01":"";b.ccexp.value=lpenc(b.ccexp.value,deckey);b.cccsc.value=lpenc(b.cccsc_entry.value,deckey);b.cccsc_entry.value=
b.cccsc.value;b.ccissuenum.value=lpenc(b.ccissuenum_entry.value,deckey);b.ccissuenum_entry.value=b.ccissuenum.value;b.username.value=lpenc(b.username.value,deckey);b.timezone.value=b.timezone_select.value;b.timezone.value=lpenc(b.timezone.value,deckey);b.bankname.value=lpenc(b.bankname.value,deckey);b.bankacctnum.value=lpenc(b.bankacctnum.value,deckey);b.bankroutingnum.value=lpenc(b.bankroutingnum.value,deckey);for(a=1;a<=numcustomfields;a++)b["customfield"+a+"text"].value=lpenc(b["customfield"+a+
"text"].value,deckey),b["customfield"+a+"value"].value=lpenc(b["customfield"+a+"value"].value,deckey),b["customfield"+a+"alttext"].value=lpenc(b["customfield"+a+"alttext"].value,deckey);b.notes.value=lpenc(b.notes.value,deckey);b.profilelanguage_select.options[b.profilelanguage_select.selectedIndex].value=lpenc(b.profilelanguage_select.options[b.profilelanguage_select.selectedIndex].value,deckey);b.birthday_month.options[b.birthday_month.selectedIndex].value=lpenc(b.birthday_month.options[b.birthday_month.selectedIndex].value,
deckey);b.birthday_day.options[b.birthday_day.selectedIndex].value=lpenc(b.birthday_day.options[b.birthday_day.selectedIndex].value,deckey);b.title_select.options[b.title_select.selectedIndex].value=lpenc(b.title_select.options[b.title_select.selectedIndex].value,deckey);b.gender_select.options[b.gender_select.selectedIndex].value=lpenc(b.gender_select.options[b.gender_select.selectedIndex].value,deckey);statecombo.setValue(lpenc(statecombo.getValue(),deckey));b.country_select.options[b.country_select.selectedIndex].value=
lpenc(b.country_select.options[b.country_select.selectedIndex].value,deckey);b.ccstart_month.options[b.ccstart_month.selectedIndex].value=lpenc(b.ccstart_month.options[b.ccstart_month.selectedIndex].value,deckey);b.ccexp_month.options[b.ccexp_month.selectedIndex].value=lpenc(b.ccexp_month.options[b.ccexp_month.selectedIndex].value,deckey);b.timezone_select.options[b.timezone_select.selectedIndex].value=lpenc(b.timezone_select.options[b.timezone_select.selectedIndex].value,deckey);show_waitbox();Ext.Ajax.request({form:"ffform",
extraParams:{extjs:"1"},success:submitFFOk,failure:submitFFFail});return!0}catch(r){return reportError("Error in submitFF2(): "+r+" ln: "+r.lineNumber),!1}}var g_submitIdent=!1;
function submitIdentOk(a,b){g_submitIdent=!1;hide_waitbox();var c=getCurrentStore();if(a.responseXML){var d=a.responseXML.getElementsByTagName("result")[0];if(d){a=d.getAttribute("msg");b=getActionMessage(0===a.indexOf("role")?rolegroupstore:identgroupstore,a.replace(/^(role|ident)/,"account"));showMessageWindow(b);b=d.getAttribute("iid");var e=document.getElementById("iidselect");if("undefined"!=typeof g_localvault&&"function"==typeof refreshsites){refreshsites();hidedialog({closeiframe:!0,force:!0});
return}if("undefined"==typeof g_newvault){var f=searchField.getValue();c.clearFilter();var g=c.query("id",b,!1,!0);if("identupdated"==a||"identdeleted"==a||"roleupdated"==a||"roledeleted"==a)for(var m=0;m<g.length;m++)g.itemAt(m).data.deleted="-1"}else"identdeleted"==a&&addorupdateidentity(d,!0);if(("identupdated"==a||"identdeleted"==a||"roleupdated"==a||"roledeleted"==a)&&e&&("identupdated"==a||"identdeleted"==a))for(g=0;g<e.options.length;g++)e.options[g].value==b&&("identdeleted"==a?e.options[g]=
null:"identupdated"==a&&(e.options[g].text=of(lpdec_u(d.getAttribute("iname")))));if("identadded"==a||"identupdated"==a||"roleadded"==a||"roleupdated"==a){g="roleadded"==a||"roleupdated"==a;m=d.getAttribute("pwprotect");var h=d.getAttribute("token"),n="1"==m?"true":"g_switch_identity_prompt",p="1"==m?"true":"pwprotect_ident('"+b+"', true)",r=g?d.getAttribute("iname"):lpdec_u(d.getAttribute("iname"));r='<span style="display:none;">'+of(r)+"</span><a onclick=\"pa(function(pwhash) { showIdentWindow('"+
b+"', null, "+(g?"1":"null")+", pwhash); }, "+p+', null, null, true); return false;" href="#">'+of(r)+"</a>";h="<a onclick=\"pa(function(pwhash) { showIdentWindow('"+of(b)+"', null, "+(g?"1":"null")+", pwhash); }, "+p+', null, null, true); return false;" href="#">'+gs("Edit")+"</a> | <a onclick=\"pa(function(pwhash) { showIdentWindow(0, '"+of(b)+"', "+(g?"1":"null")+", pwhash); }, "+p+', null, null, true); return false;" href="#">'+gs("Copy")+"</a> | <a onclick=\"pa(function(pwhash){delIid('"+of(b)+
"',"+(g?"1":"null")+",pwhash,'"+of(h)+"');}, "+n+',null,null,true);return false;" href="#">'+gs("Delete")+"</a>";"undefined"==typeof g_newvault?ASR(r,"(none)","",b,"0",h,"","0","","0",!1,"0",!1,!g,!1,"",m,0,null,g):addorupdateidentity(d);"identadded"==a&&e&&(e.options[e.options.length]=new Option(of(lpdec_u(d.getAttribute("iname"))),b))}"undefined"==typeof g_newvault&&("identadded"==a&&"id:0"==f&&(f="id:"+b),searchField.setValue(f),submitSearchForm(searchField,c));send_website_event("refresh");hidedialog({closeiframe:!0,
force:!0});return}}submitFailGeneric(a,b)}var g_submitF=!1;
function submitFOk(a,b){g_submitF=!1;"function"==typeof hide_waitbox&&hide_waitbox();if(a.responseXML){var c=a.responseXML.getElementsByTagName("result")[0];if(c)switch(c.getAttribute("rc")){case "showsharesrefreshtabok":a=c.getAttribute("numsharees");b=extractEmailAttributes(c,"shareeuid",a,!1);var d=extractEmailAttributes(c,"htmlname",a,!1);c=extractEmailAttributes(c,"htmllink",a,!1);if("undefined"!=typeof g_newvault||"undefined"!=typeof g_localvault)return;var e=fgroupstore;e.clearFilter();e.removeAll();
for(e=0;e<a;++e)ASR(d[e],"(none)","",b[e],"0",c[e],"","0","","0",!1,"0",!1,!1,!0,"","0");return}}submitFailGeneric(a,b)}function submitAppOk(a,b){hide_waitbox();if(a.responseXML){var c=a.responseXML.getElementsByTagName("result")[0];if(c){a=c.getAttribute("rc");c.getAttribute("id");switch(a){case "deleteok":showMessageWindow(gs("SUCCESS!")+"\r\n"+gs("You have deleted the application."))}return}}submitFailGeneric(a,b)}
function submitOk(a,b,c){g_submitshow=!1;hide_waitbox();var d=getCurrentStore();if(a.responseXML){var e=a.responseXML.getElementsByTagName("result")[0];if(e){a=e.getAttribute("action");var f=e.getAttribute("msg");b=e.getAttribute("aid");c&&(sharedfolderaidmap[b]=c);f&&"reload"!=f&&(c="accountadded accountreplaced accountupdated accountdeleted accountundeleted accountpurged".split(" ").includes(f)?getActionMessage(d,f):"accountaddednote"===f?gs("Note added!"):f,showMessageWindow(c));if("undefined"==
typeof g_newvault){var g=searchField.getValue();d.clearFilter();var m=d.query("id",b,!1,!0)}if(("updated"==a||"purge"==a)&&"undefined"==typeof g_newvault)for(var h=0;h<m.length;h++)m.itemAt(h).data.deleted="-1";if("delete"==a||"undelete"==a){increment_accts_version();if("undelete"==a&&"reload"==f){showMessageWindow(gs("SUCCESS!")+"\r\n"+gs("Item has been undeleted"));c=getBG();if("undefined"!=typeof b&&"undefined"!=typeof c.g_deleted_sites){d=b.split(",");for(h in d)delete c.g_deleted_sites[d[h]];
repopulate()}else lpmessagebox(null,gs("Please reload the page to view the changes."));return}if("undelete"==a)if("undefined"!=typeof g_newvault)c=getBG(),"undefined"!=typeof c.g_deleted_sites&&(c.g_sites[b]=c.g_deleted_sites[b],c.g_sites[b].deleted=0,delete c.g_deleted_sites[b],repopulate());else for(h=0;h<m.length;h++){c='<span style="display:none;">'+of(lpdec_u(e.getAttribute("acctname4")))+"</span>"+e.getAttribute("acctname6")+e.getAttribute("acctname1")+e.getAttribute("acctname2")+e.getAttribute("acctname3")+
of(lpdec_u(e.getAttribute("acctname4")))+e.getAttribute("acctname5");f=e.getAttribute("editlink");var n=m.itemAt(h);n.data.deleted="delete"==a?"1":"0";n.data.acctname=c;n.data.editlink=f}}if("added"==a||"updated"==a)if(increment_accts_version(),"undefined"==typeof g_newvault){c='<span style="display:none;">'+of(lpdec(e.getAttribute("acctname4"),deckey))+"</span>"+e.getAttribute("acctname6")+e.getAttribute("acctname1")+e.getAttribute("acctname2")+e.getAttribute("acctname3")+of(lpdec(e.getAttribute("acctname4"),
deckey))+e.getAttribute("acctname5");h=AES.hex2url(e.getAttribute("url"));m=lpdec(e.getAttribute("grouping"),deckey);null!=foldername&&(m=0==m.length?foldername:foldername+"\\"+m);""==m&&(m="(none)");f=e.getAttribute("editlink");n=e.getAttribute("count");var p=gDidUserNameDecrypt?lpdec(e.getAttribute("username"),deckey):e.getAttribute("username"),r=e.getAttribute("lasttouch"),q=e.getAttribute("fav"),w=e.getAttribute("launchjs"),v=e.getAttribute("deleted"),u=e.getAttribute("remoteshare");e=e.getAttribute("pwprotect");
ASR(c,m,h,b,n,f,r,q,w,v,getCurrentStore()==bookgroupstore,u,!1,!1,!1,p,e)}else addorupdate(e),repopulate();"undefined"==typeof g_newvault&&("added"==a&&"id:0"==g&&(g="id:"+b),searchField.setValue(g),submitSearchForm(searchField,d));send_website_event("refresh");hidedialog();return}}submitFail(a,b)}
function submitFFOk(a,b){ffenablebuttons(!0);var c=null;"undefined"!=typeof g_token?c=g_token:document.getElementById("csrftoken")&&(c=document.getElementById("csrftoken").value);hide_waitbox();var d=getCurrentStore();if(a.responseXML){var e=a.responseXML.getElementsByTagName("result")[0];if(e){a=e.getAttribute("msg");b=getActionMessage(ffgroupstore,a.replace(/^ff/,"account"));showMessageWindow(b);b=e.getAttribute("ffid");var f=e.getAttribute("pwprotect");if("undefined"==typeof g_newvault){var g=
searchField.getValue();d.clearFilter();var m=d.query("id",b,!1,!0);if("ffupdated"==a||"ffdeleted"==a)for(var h=0;h<m.length;h++)m.itemAt(h).data.deleted="-1"}else"ffdeleted"==a&&addorupdateff(e,!0);if("ffadded"==a||"ffupdated"==a)m='<span style="display:none;">'+of(lpdec_u(e.getAttribute("profilename")))+"</span><a onclick=\"pa(function(pwhash) { showFFWindow('"+b+"',null,null,pwhash); }, "+("1"==f?"true":"g_view_ff_prompt")+', null, null, true); return false;" href="#">'+of(lpdec_u(e.getAttribute("profilename")))+
"</a>",c="<a onclick=\"pa(function(pwhash) { showFFWindow('"+b+"',null,null,pwhash); }, "+("1"==f?"true":"g_view_ff_prompt")+',null,null,true); return false;" href="#">'+gs("Edit")+"</a> | <a onclick=\"pa(function(pwhash) { showFFWindow(0, '"+b+"',null,pwhash); }, "+("1"==f?"true":"g_view_ff_prompt")+',null,null,true); return false;" href="#">'+gs("Copy")+"</a> | <a onclick=\"pa(function(pwhash){delFfid('"+b+"',pwhash,'"+c+'\');}, g_view_ff_prompt, null, null, true);return false;" href="#">'+gs("Delete")+
"</a>","undefined"==typeof g_newvault?ASR(m,"(none)","",b,"0",c,"","0","","0",!1,"0",!0,!1,!1,"",f):addorupdateff(e);"undefined"==typeof g_newvault&&("ffadded"==a&&"id:0"==g&&(g="id:"+b),searchField.setValue(g),submitSearchForm(searchField,d));send_website_event("refresh");hidedialog();return}}submitFFFail(a,b)}
function ASR(a,b,c,d,e,f,g,m,h,n,p,r,q,w,v,u,B,y,G,A,C){b=new Ext.data.Record({store_id:store_id++,acctname:a,group:of(b),url:of(c),id:of(d),count:e,username:of(u),editlink:f,lasttouch:g,fav:"0",launchjs:h,deleted:n,remoteshare:r,pwprotect:B});if("undefined"!=typeof G&&G)return p=[],p[p.length]=b,1==parseInt(m)&&(a=new Ext.data.Record({store_id:store_id++,acctname:a,group:" favorites",url:c,id:d,count:e,username:u,editlink:f,lasttouch:g,fav:m,launchjs:h,deleted:n,remoteshare:r,pwprotect:B}),p[p.length]=
a),p;p||(q?ffgroupstore.addSorted(b):w?identgroupstore.addSorted(b):A?rolegroupstore.addSorted(b):v?fgroupstore.addSorted(b):C?alertgroupstore.addSorted(b):y?appgroupstore.addSorted(b):(groupstore.suspendEvents(),groupstore.add(b),1==parseInt(m)&&(b=new Ext.data.Record({store_id:store_id++,acctname:a,group:" favorites",url:of(c),id:of(d),count:e,username:of(u),editlink:f,lasttouch:g,fav:m,launchjs:h,deleted:n,remoteshare:r,pwprotect:B}),groupstore.addSorted(b)),groupstore.sort("acctname","ASC"),groupstore.resumeEvents()))}
function submitFail(a,b){g_submitshow=!1;hide_waitbox();a=document.accountform;"undefined"!=typeof a&&(a.name.value=lpdec_u(a.name.value),a.grouping.value=lpdec_u(a.grouping.value),a.origurl.value=AES.hex2url(a.origurl.value),a.url.value=AES.hex2url(a.url.value),a.username.value=dec(a.username.value),a.password.value=dec(a.password.value),a.totp.value=dec(a.totp.value),a.extra.value=dec(a.extra.value),a.openid_url.value=dec(a.openid_url.value));showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+
" "+gs("Please try again later."))}
function submitFFFail(a,b){ffenablebuttons(!0);hide_waitbox();a=document.ffform;if("undefined"!=typeof a){a.profilename.value=lpdec(a.profilename.value,deckey);a.profilelanguage.value=lpdec(a.profilelanguage.value,deckey);a.firstname.value=lpdec(a.firstname.value,deckey);a.middlename.value=lpdec(a.middlename.value,deckey);a.lastname.value=lpdec(a.lastname.value,deckey);a.email.value=lpdec(a.email.value,deckey);a.company.value=lpdec(a.company.value,deckey);a.ssn.value=lpdec(a.ssn.value,deckey);a.ssn_entry.value=
a.ssn.value;a.birthday.value=lpdec(a.birthday.value,deckey);a.title.value=lpdec(a.title.value,deckey);a.gender.value=lpdec(a.gender.value,deckey);a.address1.value=lpdec(a.address1.value,deckey);a.address2.value=lpdec(a.address2.value,deckey);a.address3.value=lpdec(a.address3.value,deckey);a.city.value=lpdec(a.city.value,deckey);a.county.value=lpdec(a.county.value,deckey);a.state.value=lpdec(a.state.value,deckey);a.zip.value=lpdec(a.zip.value,deckey);a.country.value=lpdec(a.country.value,deckey);a.ccname.value=
lpdec(a.ccname.value,deckey);a.ccnum.value=lpdec(a.ccnum.value,deckey);a.ccnum_entry.value=a.ccnum.value;a.ccstart.value=lpdec(a.ccstart.value,deckey);a.ccstart.value=lpdec(a.ccstart.value,deckey);a.ccexp.value=lpdec(a.ccexp.value,deckey);a.cccsc.value=lpdec(a.cccsc.value,deckey);a.cccsc_entry.value=a.cccsc.value;a.ccissuenum.value=lpdec(a.ccissuenum.value,deckey);a.ccissuenum_entry.value=a.ccissuenum.value;a.username.value=lpdec(a.username.value,deckey);a.timezone.value=lpdec(a.timezone.value,deckey);
a.bankname.value=lpdec(a.bankname.value,deckey);a.bankacctnum.value=lpdec(a.bankacctnum.value,deckey);a.bankroutingnum.value=lpdec(a.bankroutingnum.value,deckey);for(b=1;b<=numcustomfields;b++)a["customfield"+b+"text"].value=lpdec(a["customfield"+b+"text"].value,deckey),a["customfield"+b+"value"].value=lpdec(a["customfield"+b+"value"].value,deckey),a["customfield"+b+"alttext"].value=lpdec(a["customfield"+b+"alttext"].value,deckey);a.notes.value=lpdec(a.notes.value,deckey);a.profilelanguage_select.options[a.profilelanguage_select.selectedIndex].value=
lpdec(a.profilelanguage_select.options[a.profilelanguage_select.selectedIndex].value,deckey);a.birthday_month.options[a.birthday_month.selectedIndex].value=lpdec(a.birthday_month.options[a.birthday_month.selectedIndex].value,deckey);a.birthday_day.options[a.birthday_day.selectedIndex].value=lpdec(a.birthday_day.options[a.birthday_day.selectedIndex].value,deckey);a.title_select.options[a.title_select.selectedIndex].value=lpdec(a.title_select.options[a.title_select.selectedIndex].value,deckey);a.gender_select.options[a.gender_select.selectedIndex].value=
lpdec(a.gender_select.options[a.gender_select.selectedIndex].value,deckey);statecombo.setValue(lpenc(statecombo.getValue(),deckey));a.country_select.options[a.country_select.selectedIndex].value=lpdec(a.country_select.options[a.country_select.selectedIndex].value,deckey);a.ccstart_month.options[a.ccstart_month.selectedIndex].value=lpdec(a.ccstart_month.options[a.ccstart_month.selectedIndex].value,deckey);a.ccexp_month.options[a.ccexp_month.selectedIndex].value=lpdec(a.ccexp_month.options[a.ccexp_month.selectedIndex].value,
deckey);a.phone3lcc.value=lpdec(a.phone3lcc.value,deckey);a.phone.value=lpdec(a.phone.value,deckey);a.phoneext.value=lpdec(a.phoneext.value,deckey);a.phone_npa.value=lpdec(a.phone_npa.value,deckey);a.phone_nxx.value=lpdec(a.phone_nxx.value,deckey);a.phone_xxxx.value=lpdec(a.phone_xxxx.value,deckey);a.phone_cc.value=lpdec(a.phone_cc.value,deckey);a.phone_intl.value=lpdec(a.phone_intl.value,deckey);a.phonecountry.options[a.phonecountry.selectedIndex].value=lpdec(a.phonecountry.options[a.phonecountry.selectedIndex].value,
deckey);a.fax3lcc.value=lpdec(a.fax3lcc.value,deckey);a.fax.value=lpdec(a.fax.value,deckey);a.faxext.value=lpdec(a.faxext.value,deckey);a.fax_npa.value=lpdec(a.fax_npa.value,deckey);a.fax_nxx.value=lpdec(a.fax_nxx.value,deckey);a.fax_xxxx.value=lpdec(a.fax_xxxx.value,deckey);a.fax_cc.value=lpdec(a.fax_cc.value,deckey);a.fax_intl.value=lpdec(a.fax_intl.value,deckey);a.faxcountry.options[a.faxcountry.selectedIndex].value=lpdec(a.faxcountry.options[a.faxcountry.selectedIndex].value,deckey);a.mobilephone3lcc.value=
lpdec(a.mobilephone3lcc.value,deckey);a.mobilephone.value=lpdec(a.mobilephone.value,deckey);a.mobileext.value=lpdec(a.mobileext.value,deckey);a.mobilephone_npa.value=lpdec(a.mobilephone_npa.value,deckey);a.mobilephone_nxx.value=lpdec(a.mobilephone_nxx.value,deckey);a.mobilephone_xxxx.value=lpdec(a.mobilephone_xxxx.value,deckey);a.mobilephone_cc.value=lpdec(a.mobilephone_cc.value,deckey);a.mobilephone_intl.value=lpdec(a.mobilephone_intl.value,deckey);a.mobcountry.options[a.mobcountry.selectedIndex].value=
lpdec(a.mobcountry.options[a.mobcountry.selectedIndex].value,deckey);a.evephone3lcc.value=lpdec(a.evephone3lcc.value,deckey);a.evephone.value=lpdec(a.evephone.value,deckey);a.eveext.value=lpdec(a.eveext.value,deckey);a.evephone_npa.value=lpdec(a.evephone_npa.value,deckey);a.evephone_nxx.value=lpdec(a.evephone_nxx.value,deckey);a.evephone_xxxx.value=lpdec(a.evephone_xxxx.value,deckey);a.evephone_cc.value=lpdec(a.evephone_cc.value,deckey);a.evephone_intl.value=lpdec(a.evephone_intl.value,deckey);a.evecountry.options[a.evecountry.selectedIndex].value=
lpdec(a.evecountry.options[a.evecountry.selectedIndex].value,deckey);a.timezone_select.options[a.timezone_select.selectedIndex].value=lpdec(a.timezone_select.options[a.timezone_select.selectedIndex].value,deckey)}showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}
function submitFailGeneric(a,b){g_submitIdent=!1;hide_waitbox();showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}function submitSettingsFail(a,b){hide_waitbox();a=document.settingsform;a.password.value="";a.reencrypt.value="";a.newpasswordhash.value="";a.encrypted_username.value="";showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}
function submitSettings(a){try{document.settingsform.ajax.value="1","undefined"!==typeof lp_phpsessid&&(document.settingsform.wxsessid.value=lp_phpsessid),show_waitbox(a),Ext.Ajax.request({form:"settingsform",extraParams:{extjs:"1"},success:submitSettingsOk,failure:submitSettingsFail})}catch(b){reportError("Error in submitSettings(): "+b+" ln: "+b.lineNumber)}}
function submitSettingsOk(a,b){var c=document.settingsform;c.password.value="";c.reencrypt.value="";c.newpasswordhash.value="";c.encrypted_username.value="";localStorage.removeItem(SHA256(fix_username(c.origusername.value))+"_otp");hide_waitbox();if(a.responseXML&&(send_website_event("refresh","settings","0"),c=a.responseXML.getElementsByTagName("result")[0])){c.getAttribute("msg");autologout_secs=parseInt(c.getAttribute("new_autologout_secs"));g_security_level=parseInt(c.getAttribute("seclvl"));
g_login_site_prompt=parseInt(c.getAttribute("login_site_prompt"));g_edit_site_prompt=parseInt(c.getAttribute("edit_site_prompt"));g_edit_sn_prompt=parseInt(c.getAttribute("edit_sn_prompt"));g_view_pw_prompt=parseInt(c.getAttribute("view_pw_prompt"));g_view_ff_prompt=parseInt(c.getAttribute("view_ff_prompt"));g_switch_identity_prompt=parseInt(c.getAttribute("switch_identity_prompt"));g_switch_f_prompt=parseInt(c.getAttribute("switch_f_prompt"));g_switch_a_prompt=0;g_multifactor_reprompt=parseInt(c.getAttribute("multifactor_reprompt"));
parseInt(c.getAttribute("dorefresh"))&&send_website_event("refresh");a=c.getAttribute("yubiresult");b=c.getAttribute("googleauthresult");a&&"invalidlength"==a?alert(gs("Your YubiKey failed to authenticate. Please try again.")):a&&"verifyfailed"==a?alert(gs("Your YubiKey failed to authenticate. Please contact support@lastpass.com for assistance.")):a&&"sesameenabled"==a?alert(gs("YubiKey authentication can not be enabled if Sesame authentication is being used. Please disable Sesame authentication and try again.")):
a&&"gridenabled"==a?alert(gs("YubiKey and Grid authentication can not be enabled at the same time. Please disable one or the other and try again.")):a&&"googleauthenabled"==a?alert(gs("YubiKey and Google Authenticator can not be enabled at the same time. Please disable one or the other and try again.")):b&&"sesameenabled"==b?alert(gs("Google Authenticator authentication can not be enabled if Sesame authentication is being used. Please disable Sesame authentication and try again.")):showMessageWindow(gs("Settings updated!"));
"function"==typeof reset_autologout&&reset_autologout();hidedialog({closeiframe:!0,force:!0});return}submitFail(a,b)}function deleteField(a,b,c,d,e,f){lpconfirmbox(gs("Confirm Delete"),gs("Are you sure you would like to delete this field?"),function(){hidedialog();realDelField(a,b,c,d,e,f)})}
function realDelField(a,b,c,d,e,f){try{show_waitbox();if(f)var g=f;else if(g=document.getElementById(c)){var m="text"==g.type||"password"==g.type||"textarea"==g.type||"email"==g.type||"tel"==g.type;g=g.value;m&&(g=enc(g))}c="&src=website";"string"==typeof e&&(c+="&token="+encodeURIComponent(e));Ext.Ajax.request({url:geturltoloadex("fields.php?delete=1&aid="+encodeURIComponent(a)+"&urid="+encodeURIComponent(b)+"&name="+encodeURIComponent(d)+"&value="+encodeURIComponent(g)+c),failure:function(a,b){hide_waitbox();
lpmessagebox(gs("Cannot Delete Field"),gs("Your field could not be deleted. Please retry later."))},success:function(a,b){hide_waitbox();showMessageWindow(gs("Fields updated!"));send_website_event("refresh");hidedialog()}})}catch(h){reportError("Error in realDelField(): "+h+" ln: "+h.lineNumber)}}
function submitFields(){try{show_waitbox();for(var a=!1,b=0;b<document.fieldsform.elements.length;b++){var c=document.fieldsform.elements[b];if("text"==c.type||"password"==c.type||"textarea"==c.type||"email"==c.type||"tel"==c.type)"undefined"!=typeof origfieldsvalues[c.name]&&c.value==lpdec(origfieldsvalues[c.name],deckey)?c.value=origfieldsvalues[c.name]:(a=!0,c.value=enc(c.value,deckey))}if(!a){hide_waitbox();hidedialog({name:"fieldswin"});return}document.fieldsform.encuser.value=encecb(lp_username,
deckey);Ext.Ajax.request({form:"fieldsform",success:submitFieldsOk,failure:submitFail})}catch(d){reportError("Error in submitFields(): "+d+" ln: "+d.lineNumber)}"function"===typeof hidedialog()&&hidedialog()}
function submitFieldsOk(a,b){hide_waitbox();if(a.responseXML){var c=a.responseXML.getElementsByTagName("result")[0];if(c){var d=c.getAttribute("goto");if(d){hidedialog({name:"fieldswin"});lpwindow({url:geturltoloadex(d)});send_website_event("refresh");return}if(c.getAttribute("close")){showMessageWindow(gs("Fields updated!"));send_website_event("refresh");hidedialog();return}}}submitFail(a,b)}
function send_website_event(a,b,c,d,e,f,g){"refresh"==a&&"settings"!=b&&increment_accts_version();var m="lpwebsiteeventform";"undefined"!=typeof lpwebsiteeventformname&&(m=lpwebsiteeventformname);if(null!=document.getElementById(m)){"logoff"==a&&(loggingoff=!0,"function"==typeof finish_vault_search&&finish_vault_search());var h=document[m];if("undefined"==typeof h||"undefined"==typeof h.eventtype)h=document.getElementById(m);"undefined"==typeof h||"undefined"==typeof h.eventtype?"undefined"==typeof event_bogus_form&&
(event_bogus_form=1,console.log("bogus form? "+m+" "+h.toString())):(h.eventtype.value=a,h.eventdata1.value=b?b:"",h.eventdata2.value=c?c:"",h.eventdata3.value=d?d:"",h.eventdata4.value=e?e:"",h.eventdata5.value=f?f:"",h.eventdata6.value=g?g:"","function"==typeof website_event?website_event():"undefined"!=typeof h.submitbtn&&h.submitbtn.click())}}
function resizeGrid(a){null==a&&(a=getCurrentStore()==bookgroupstore?bookgrid:grid);var b=navigator.userAgent,c=/msie/i.test(b)&&!/opera/i.test(b);b=/Safari/i.test(b);"undefined"!=typeof a&&a.setHeight(get_window_height()-document.getElementById("toprow").offsetHeight-document.getElementById("lptabs").offsetHeight-(c||b?12:0)+7)}
if("undefined"==typeof autologout_secs)var autologout_secs=0,autologout_timer=null,autologout_warn_timer=null,autologout_warning_done=!1,autologout_force_reset=!1,autologout_continue_clicked=!1,autologout_time=Date.now(),auto_logout_interval=null;function do_autologout(){Date.now()-autologout_time<1E3*(autologout_secs-60)?(autologout_secs=86399,reset_autologout()):(send_website_event("logoff"),lpImprove("autologoff"),location.href=geturltoloadex("logout.php?autologout=1"))}
function setUpActivityEventListeners(){var a=document.getElementById("newvault");"undefined"!=typeof a.contentDocument.addEventListener&&(a.contentDocument.addEventListener("mousemove",reset_autologout),a.contentDocument.addEventListener("keydown",reset_autologout));"undefined"!=typeof window.addEventListener?window.addEventListener("keydown",reset_autologout,!1):"undefined"!=typeof document.addEventListener?document.addEventListener("keydown",reset_autologout,!1):"undefined"!=typeof window.attachEvent&&
window.attachEvent("onkeydown",reset_autologout,!1);"undefined"!=typeof window.addEventListener?window.addEventListener("mousemove",reset_autologout,!1):"undefined"!=typeof document.addEventListener?document.addEventListener("mousemove",reset_autologout,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmousemove",reset_autologout,!1)}
function reset_autologout(){61>autologout_secs&&(lpmessagebox(null,sprintf(gs("The autologoff timer is too short, your timeout was set to %s giving you 5 minutes instead"),autologout_secs)),autologout_secs=300);var a=1E3*autologout_secs;-1!=navigator.userAgent.indexOf("Konqueror")&&86399999<a&&(a=86399999);var b=1E3*(autologout_secs-60);if(!autologout_warning_done||autologout_force_reset){var c=Date.now();null!==auto_logout_interval&&clearInterval(auto_logout_interval);auto_logout_interval=setInterval(function(c){var d=
Date.now(),f=c+a;c+b<=d&&!autologout_warning_done&&(console.warn("[AUTO_LOGOFF] Warning user",c,d),warn_autologout());f<=d&&(console.warn("[AUTO_LOGOFF] Logging out user",c,d),do_autologout(),clearInterval(auto_logout_interval))},1E3,c);autologout_continue_clicked&&lpImprove("autologoff_continue");autologout_continue_clicked=autologout_warning_done=autologout_force_reset=!1}}
function warn_autologout(){Date.now()-autologout_time<1E3*(autologout_secs-120)||(autologout_warning_done=!0,lpImprove("autologoff_warn"),title="Session expiring soon",lpwindow({title:title,url:geturltoloadex("autologout_warn.php")}))}function check_email_domain(a){if("undefined"!=typeof valid_email_domains&&0<valid_email_domains.length){for(var b=0;b<valid_email_domains.length;b++){var c="@"+valid_email_domains[b];if(a.toLowerCase().indexOf(c)==a.length-c.length)return!0}return!1}return!0}
function validate_settings(){var a=fix_username($("#origemail").val()),b=fix_username($("#email").val()),c=parseInt($("#origiterations").val()),d=parseInt($("#password_iterations").val()),e=$("#origimprove").val(),f=$("#improve").is(":checked")?"1":"0",g=$("#password_hint").val(),m=$("#origsecurityemail").val(),h=$("#securityemail").val();$("#yubikeypassword").val();$("#yubikeypassword2").val();$("#yubikeypassword3").val();$("#yubikeypassword4").val();$("#yubikeypassword5").val();if(validate_password(b,
"a","","",g,!0)){g=[];if(b!=a)if(!check_email(b))g.push(gs("You must enter a valid email address."));else if(!check_email_domain(b)){for(var n=gs("Your email address must be a part of one of the following domains:")+" ",p=0;p<valid_email_domains.length;++p)n+=(0==p?"":", ")+valid_email_domains[p];g.push(n)}h&&""!=h&&!check_email(h)&&g.push(gs("You must enter a valid security email address."));b!=a&&h!=m&&g.push(gs("You cannot change your account email and security email at the same time.  Please change them one at a time."));
isNaN(d)||1>d?g.push(gs("You have entered an invalid password iterations value.")):d!=c&&lpImprove("changed_password_iterations");e!=f&&lpImprove("help_improve_lp_toggled",{state:f},!0);if(0<g.length){a="";for(p=0;p<g.length;p++)a+=(""==a?"":"<br/>")+g[p];lpmessagebox(gs("Cannot Update Settings"),a);Lpwm.uptopzindex()}else b!=a?verify_email(b,a):h!=m&&""!=h?verify_email(h,a):!0===g_is_recovery?reprompt_for_master_password():confirmMasterPasswordWithToken(function(a,b){validate_settings2(b,void 0,
void 0,void 0,a.confirm_token)},null,"settings")}}
function verify_email(a,b){var c=null;"undefined"!=typeof g_token?c=g_token:document.getElementById("csrftoken")&&(c=document.getElementById("csrftoken").value);var d="";c&&(d+="&token="+encodeURIComponent(c));var e=gs("Verify Email"),f="verifyemail.php?email="+encodeURIComponent(a)+d;$.ajax({url:"lmiapi/users/me/shouldverifyemail",type:"GET",contentType:"application/json",headers:{"X-CSRF-TOKEN":c},success:function(a){a.shouldVerifyEmail?lpwindow({title:e,showcustom:!0,custombuttontext:gs("Send Verification Email"),
customonclick:function(){$.ajax({type:"POST",url:"settings.php",data:{testemail:1,email:b,extra:"verifygeneric",token:c},success:function(){hidedialog();lpwindow({title:"Success",html:"<div>"+gs("Please check your email for the verification message (it may have gone to your spam folder).")+"</div>"})},error:function(){hidedialog();lpwindow({title:"Error",html:"<div>"+gs("There was an error sending your verification email.")+"</div>"})}})},html:"<p>"+gs("To finish what you started, verify your email here: ")+
b+"</p>"}):lpwindow({title:e,url:geturltoloadex(f)})},error:function(a){console.log("Error calling service: shouldverifyemail");lpwindow({title:"Error",html:"<div>"+gs("There was an error connecting with the verification service.")+"</div>"})}})}
function reprompt_for_master_password(){var a=fix_username($("#origemail").val()),b=fix_username($("#email").val()),c="showconfirmpassword.php?confirmpassword=0",d={title:gs("Enter Password"),aftershow:function(){b!==a&&checkemailmistype(b)}};null!==gRecovery&&(c+="&recovery=1",d.closebgclick=!1,d.showclose=!1);d.url=geturltoloadex(c);lpwindow(d)}
function validate_settings2_check_server_pw(a,b,c,d,e,f){var g=null;"undefined"!=typeof g_token?g=g_token:document.getElementById("csrftoken")&&(g=document.getElementById("csrftoken").value);a={cmd:"verify",email:g_username,pwhash:a,iterations:d,from:"accts"};null!=g&&(a.token=g);var m=null;$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:"verifypassword.php",async:!1,data:a,success:function(a){1==a.success?(g_localkey=g_local_key=b,m=validate_settings2(c,e,b,f)):lpmessagebox(gs("Cannot Update Settings"),
gs("You have entered an incorrect LastPass master password."))},error:function(){lpmessagebox(gs("Cannot Update Settings"),gs("You have entered an incorrect LastPass master password."))}});return m}
function validate_settings2(a,b,c,d,e){var f=fix_username($("#origusername").val()),g=g_iterations;if(""==a)lpmessagebox(gs("Cannot Update Settings"),gs("You did not enter your LastPass master password"));else{"undefined"===typeof c&&(c=make_lp_key_iterations(f,a,g),d=make_lp_key_iterations(f,a,1));if("undefined"===typeof g_local_key)return e=make_lp_hash_iterations(c,a,g),validate_settings2_check_server_pw(e,c,a,g,b,d);if(c!=g_local_key)lpmessagebox(gs("Cannot Update Settings"),gs("You have entered an incorrect LastPass master password."));
else if("string"==typeof b&&0<b.length)setupSinglefactor(b,a);else{b=document.getElementsByTagName("input");g="";for(f=0;f<b.length;++f)"countrycheck"==b[f].className&&b[f].checked&&(g+=(""==g?"":",")+b[f].name);$("#countries").val(g);$("#ajax").val("1");$("#newsettings").val("1");show_waitbox(!1);"undefined"!==typeof lp_phpsessid&&(document.settingsform.wxsessid.value=lp_phpsessid);e&&$("#settings-ott").val(e);try{Ext.Ajax.request({form:"settingsform",extraParams:{extjs:"1"},success:function(b,e){settingsupdatedack(b,
e,a,c,d)},failure:settingsupdatednack})}catch(m){reportError("Error in validate_settings2() calling Ext.Ajax.request: "+m+" ln: "+m.lineNumber)}}}}function settingsupdatednack(a,b){hide_waitbox();showMessageWindow(gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}
function settingsupdatedack(a,b,c,d,e){var f=a.responseXML?a.responseXML.getElementsByTagName("result")[0]:null;if(f){autologout_secs=parseInt(f.getAttribute("new_autologout_secs"));g_security_level=parseInt(f.getAttribute("seclvl"));g_login_site_prompt=parseInt(f.getAttribute("login_site_prompt"));g_edit_site_prompt=parseInt(f.getAttribute("edit_site_prompt"));g_edit_sn_prompt=parseInt(f.getAttribute("edit_sn_prompt"));g_view_pw_prompt=parseInt(f.getAttribute("view_pw_prompt"));g_view_ff_prompt=
parseInt(f.getAttribute("view_ff_prompt"));g_switch_identity_prompt=parseInt(f.getAttribute("switch_identity_prompt"));g_switch_f_prompt=parseInt(f.getAttribute("switch_f_prompt"));g_switch_a_prompt=0;g_multifactor_reprompt=parseInt(f.getAttribute("multifactor_reprompt"));g_loglogins=parseInt(f.getAttribute("loglogins"));g_is_legacy_premium=parseInt(f.getAttribute("is_legacy_premium"));g_is_families_trial_started=parseInt(f.getAttribute("is_families_trial_started"));a=parseInt(f.getAttribute("dorefresh"));
b=f.getAttribute("yubiresult");var g=f.getAttribute("googleauthresult");f=parseInt(f.getAttribute("show_improve_prompt"));b&&"invalidlength"==b?alert(gs("Your YubiKey failed to authenticate. Please try again.")):b&&"verifyfailed"==b?alert(gs("Your YubiKey failed to authenticate. Please contact support@lastpass.com for assistance.")):b&&"sesameenabled"==b?alert(gs("YubiKey authentication can not be enabled if Sesame authentication is being used. Please disable Sesame authentication and try again.")):
b&&"gridenabled"==b?alert(gs("YubiKey and Grid authentication can not be enabled at the same time. Please disable one or the other and try again.")):b&&"googleauthenabled"==b?alert(gs("YubiKey and Google Authenticator can not be enabled at the same time. Please disable one or the other and try again.")):g&&"sesameenabled"==g&&alert(gs("Google Authenticator authentication can not be enabled if Sesame authentication is being used. Please disable Sesame authentication and try again."));"function"==typeof reset_autologout&&
reset_autologout();b=fix_username($("#origemail").val());g=fix_username($("#email").val());var m=g_iterations,h=parseInt($("#password_iterations").val()),n=$("#password_hint").val(),p=$("#csrftoken").val(),r=make_lp_hash_iterations(d,c,m),q=$("#currentlanguage").val(),w=$("#languagesettings").val();w=q!==w;q=make_lp_key_iterations(g,c,h);q==d?b!=g||c!=c||m!=h?console.error("mustreencrypt is false but:\noldemail="+b+"\nnewemail="+g+"\nolditerations="+m+"\nnewiterations="+h+"\noldlocalkey.length="+
d.length+"\nnewlocalkey.length="+q.length):(hide_waitbox(),send_website_event("refresh","settings","0"),a&&send_website_event("refresh"),w?lpmessagebox(gs("Your language is set"),gs("You may need to log in again on your devices to apply the change."),function(){hidedialog({closeiframe:!0});"undefined"!==typeof AccountSettingsTabController&&AccountSettingsTabController.closeDialog()},function(){hidedialog({closeiframe:!0});"undefined"!==typeof AccountSettingsTabController&&AccountSettingsTabController.closeDialog()}):
f?lpmessagebox(gs("Restart LastPass to apply changes"),gs("Restart LastPass everywhere you use it to complete this settings change."),function(){hidedialog({closeiframe:!0});"undefined"!==typeof AccountSettingsTabController&&AccountSettingsTabController.closeDialog()},function(){hidedialog({closeiframe:!0});"undefined"!==typeof AccountSettingsTabController&&AccountSettingsTabController.closeDialog()}):(hidedialog({closeiframe:!0}),"undefined"!==typeof AccountSettingsTabController&&AccountSettingsTabController.closeDialog())):
(a=encecb(g,q),$("#encrypted_username").val(a),a=make_lp_hash_iterations(q,c,h),$("#newpasswordhash").val(a),m!=h&&(g_changeiterations=!0,g_target_key_iterations=h),hide_waitbox(),show_waitbox(!0),(new PWCHANGER).changepw(d,r,b,g,c,!1,function(a,b,d,e){chpw_callback_new(a,b,d,e,c)},"",chpw_status,null,p,n,e))}else hide_waitbox(),settingsupdatednack(a,b)}
function chpw_callback_new(a,b,c,d,e){$("#encrypted_username").val("");$("#newpasswordhash").val("");$("#reencrypt").val("");hide_waitbox();1==a?(hidedialog(),lpmessagebox(gs("Cannot Update Settings"),gs("That email address is already in use by a different user."),null,-1!=document.location.href.indexOf("acctsiframe.php")&&"function"==typeof closeiframe?closeiframe:null)):2==a?(a=gs("Your settings could not be updated. Please retry later."),d&&(a=gs("Your settings could not be updated.")+"\n"+d),
hidedialog(),lpmessagebox(gs("Cannot Update Settings"),a,null,-1!=document.location.href.indexOf("acctsiframe.php")&&"function"==typeof closeiframe?closeiframe:null)):3==a?""!=d&&(hidedialog(),lpmessagebox(gs("An Error Occurred"),gs("Your email/password has not been changed.\n\nLastPass should be contacting you soon about the problem you encountered."),null,-1!=document.location.href.indexOf("acctsiframe.php")&&"function"==typeof closeiframe?closeiframe:null)):0!=a?(hidedialog(),lpmessagebox(gs("Cannot Update Settings"),
gs("That email address is already in use by a different user."),null,-1!=document.location.href.indexOf("acctsiframe.php")&&"function"==typeof closeiframe?closeiframe:null)):(send_website_event("clearcache"),setTimeout(function(){if($("#multifactorenabled").length&&$("#multifactorenabled").is(":checked")){var a=$("#multifactortype").val(),b=fix_username($("#email").val());send_website_event("setupsinglefactor",a,b,e,"","1")}},200),passwordChangeComplete())}
var passwordChangeComplete=function(a){a&&("undefined"!==typeof top.g_recover_flow_step&&(top.g_recover_flow_step="completed"),lpImprove("acc_rec_completed",{},!0));send_website_event("logoff");lpmessagebox(null,gs("Your email/password/password iterations change is complete. You should now be automatically logged out, please relogin to your account to verify your new credentials. If you are not automatically logged out, please do so manually."),function(){top.location.href=geturltoloadex("logout.php?login=1")})},
g_orighint=null,g_confirmpassword=0,g_changeiterations=!1;
function validate_settings_formex(a,b,c,d){if(Lpwm){if(Lpwm.lock&&"undefined"==typeof b)return;"undefined"!=typeof Lpwm.lockit&&Lpwm.lockit()}a=0;d&&(a=1);if(a){d=document.settingsform;var e=fix_username(d.origemail.value);a="email password password_hint securityemail password_iterations yubikeypassword yubikeypassword2 yubikeypassword3 yubikeypassword4 yubikeypassword5".split(" ");for(var f in a){var g=a[f],m=document.getElementsByName(g);"undefined"==typeof d[g]&&null!=m&&0<m.length&&(d[g]=document.getElementsByName(g)[0])}var h=
fix_username(d.email.value);a=d.password.value;f=d.password_hint.value;if(validate_password(h,"a",a,a,f,!c)){a="";if(h!=e)if(!check_email(h))a+=gs("You must enter a valid email address.")+"<br />\r\n";else if(!check_email_domain(h)){g=gs("Your email address must be a part of one of the following domains:")+" ";m="";for(var n=0;n<valid_email_domains.length;n++)g+=m+valid_email_domains[n],m=", ";a+=g+"<br />\r\n"}""==d.securityemail.value||check_email(d.securityemail.value)||(a+=gs("You must enter a valid security email address.")+
"<br />\r\n");f==g_orighint&&""!=f&&(a+=gs("When changing your password, you must also change your reminder.")+"<br />\r\n");f=0;"undefined"!=typeof d.password_iterations&&d.password_iterations&&"undefined"!=typeof d.password_iterations.getAttribute&&d.password_iterations.getAttribute("origvalue")?f=d.password_iterations.getAttribute("origvalue"):"undefined"!=typeof g_iterations&&(f=g_iterations);!g_changeiterations&&d.password_iterations&&d.password_iterations.value!=f&&(a+=gs("Please press the 'Increase Iterations' button to change your password iterations.")+
"<br />\r\n");if(""!=a)return lpmessagebox(gs("Cannot Update Settings"),a),Lpwm.uptopzindex(),!1;g_confirmpassword=b&&null==gRecovery?1:0;mistypecheck=function(){h!==e&&checkemailmistype(h)};if(c)return!0;b=1==g_confirmpassword||null!=gRecovery?gs("Change Password"):gs("Enter Password");c="showconfirmpassword.php?confirmpassword="+encodeURIComponent(g_confirmpassword);null!=gRecovery?lpwindow({title:b,url:geturltoloadex(c+"&recovery=1"),showclose:!1,aftershow:mistypecheck}):lpwindow({title:b,url:geturltoloadex(c),
aftershow:mistypecheck})}else if(c)return!1}else validate_settings()}var verify_email_failures=0;
function verifyemailclicked(a){if(""==a.code.value)alert(gs("Please enter the code."));else{var b=null;"undefined"!=typeof g_token?b=g_token:document.getElementById("csrftoken")&&(b=document.getElementById("csrftoken").value);a="code="+encodeURIComponent(a.code.value)+"&token="+b;$.ajax({url:geturltoloadex("verifyemail.php"),type:"POST",dataType:"xml",data:a,timeout:2E4,error:function(){alert(gs("Error, please try again later."))},success:function(a){0<a.getElementsByTagName("ok").length?(hidedialog(),
confirmMasterPasswordWithToken(function(a,b){validate_settings2(b,void 0,void 0,void 0,a.confirm_token)},null,"settings")):5>++verify_email_failures?alert(gs("Invalid code, please check your email and try again.")):(verify_email_failures=0,alert(gs("Invalid code.")),hidedialog())}})}}function passwordComplexityCheck(a){var b=a.match(/.*[0-9].*/),c=a.match(/.*[a-z]/),d=a.match(/.*[A-Z]/);return 12<=a.length&&b&&c&&d}
function confirmpasswordclicked(a,b,c){if(null==gRecovery)b=a.oldpassword.value,a.oldpassword.value="",a.newpassword.value="",a.confirmnewpassword.value="",validate_settings2(b,c);else{b=document.settingsform;var d=fix_username(b.origusername.value),e=gRecovery,f=a.oldpassword.value,g=a.confirmnewpassword.value,m=a.new_password_hint.value,h=function(a,b){lpmessagebox(a,b);Lpwm.uptopzindex()},n="undefined"!=typeof g_key_iterations?g_key_iterations:1;""==f?h(gs("Cannot Update Settings"),gs("You did not enter your LastPass master password")):
"string"==typeof c&&0<c.length?(a.oldpassword.value="",a.newpassword.value="",a.confirmnewpassword.value="",hidedialog(),setupSinglefactor(c,f)):f!=g?h(gs("Cannot Update Settings"),gs("'New Password' and 'Confirm New Password' do not match.")):make_lp_key_iterations(d,f,n)==g_local_key?h(gs("Cannot Update Settings"),gs("Your new password cannot be the same as your old password")):passwordComplexityCheck(f)?("undefined"==typeof b.password&&(c=document.createElement("input"),c.type="hidden",c.name=
"password",b.appendChild(c)),"undefined"==typeof b.password_hint&&(c=document.createElement("input"),c.type="hidden",c.name="password_hint",b.appendChild(c)),c=b.password.value,b.password.value=f,f=b.password_hint.value,b.password_hint.value=m,"function"!=typeof checkpwstrength&&(checkpwstrength=function(){return!0}),validate_settings_formex(checkpwstrength,!1,!0,1)?(a.oldpassword.value="",a.newpassword.value="",a.confirmnewpassword.value="",hidedialog(),gRecovery=null,settings_form_recovery_password_reset(e)):
(b.password.value=c,b.password_hint.value=f)):lpmessagebox(gs("An Error Occurred"),gs("Your master password must be at least 12 characters, using both uppercase and lowercase letters and at least one number."))}}
function settings_form_recovery_password_reset(a){var b=document.settingsform,c=fix_username(b.origemail.value),d=b.password.value,e=$("#csrftoken").val(),f=b.password_hint.value,g=g_local_key,m="undefined"!=typeof g_key_iterations?g_key_iterations:1;g_changeiterations&&document.getElementById("password_iterations")&&(g_target_key_iterations=m=parseInt(document.getElementById("password_iterations").value));var h=make_lp_key_iterations(c,d,m);m=make_lp_hash_iterations(h,d,m);var n=h!=g?!0:!1;h=encecb(c,
h);if(n)show_waitbox(!0),(new PWCHANGER).recoveryChangePassword(g,a,c,d,chpw_callback,chpw_status,e,f);else{a=document.getElementsByTagName("input");c="";for(d=0;d<a.length;d++)"countrycheck"==a[d].className&&a[d].checked&&(c+=(""==c?"":",")+a[d].name);b.countries.value=c;b.password.value="";b.newpasswordhash.value=n?m:"";b.encrypted_username.value=n?h:"";submitSettings(n);return!1}}
function chpw_callback(a,b,c,d){hide_waitbox();b=document.settingsform;var e=b.password.value;b.password.value="";c=function(a,b){hidedialog();lpmessagebox(a,b);Lpwm.uptopzindex()};1==a&&c(gs("Cannot Update Settings"),gs("That email address is already in use by a different user."));if(2==a){sendAccountRecoveryErrorEvent({reason:"Server Error",step:g_recover_flow_step});var f=gs("Your settings could not be updated. Please retry later.");d&&(f=gs("Your settings could not be updated.")+"\n"+d);c(gs("Cannot Update Settings"),
f)}3==a&&(sendAccountRecoveryErrorEvent({reason:"Server Error:Reencryption error",step:g_recover_flow_step}),""!=d&&c(gs("An Error Occurred"),gs("Your email/password has not been changed.\n\nLastPass should be contacting you soon about the problem you encountered.")));0==a&&(send_website_event("clearcache"),setTimeout(function(){document.getElementById("multifactorenabled")&&document.getElementById("multifactorenabled").checked&&send_website_event("setupsinglefactor",document.getElementById("multifactortype").value,
g_username,e,"","1")},200),localStorage.removeItem(SHA256(fix_username(b.origusername.value))+"_otp"),passwordChangeComplete(!0))}var g_chpw_status=0;
function chpw_status(a,b){switch(a){case 0:var c=gs("Downloading your data...");break;case 1:c=gs("Re-encrypting your data...");break;case 2:c=gs("Uploading your re-encrypted data...")}b=parseFloat(b);NaN==b&&(b=0);g_chpw_status=.01>=b?1:1<b?100:100*b;a=Math.round(g_chpw_status*$("#changepw_progress").width()/100);$("#changepw_progress2").css({width:a+"px"});$("#changepw_progress3").text(c);$("#changepw_progress").show()}
function tellFriend(){Ext.Ajax.request({form:"friend",success:friendOk,failure:friendFail})}function friendOk(a,b){0<a.responseText.indexOf("ok")?lpmessagebox(null,gs("Thanks for spreading the word!")):lpmessagebox(null,gs("An error occurred. Please try again later."));if(a=document.getElementById("friendemail"))a.value=""}function friendFail(a,b){lpmessagebox(null,gs("An error occurred. Please try again later."))}
function changeGrid(a,b,c,d,e,f,g,m,h){if("undefined"==typeof init_done)return!1;var n=document.getElementById("ffgrid"),p=document.getElementById("bookmarkgrid"),r=document.getElementById("acctsgrid"),q=document.getElementById("identgrid"),w=document.getElementById("fgrid"),v=document.getElementById("alertgrid"),u=document.getElementById("appgrid"),B=document.getElementById("advertpanel"),y=document.getElementById("rolegrid");p&&r&&(n&&(n.style.display=c?"block":"none"),p&&(p.style.display=b?"block":
"none"),r&&(r.style.display=a?"block":"none"),q&&(q.style.display=d?"block":"none"),w&&(w.style.display=e?"block":"none"),v&&(v.style.display=h?"block":"none"),u&&(u.style.display=f?"block":"none"),B&&(B.style.display=g?"block":"none"),y&&(y.style.display=m?"block":"none"),document.getElementById("aggctrl").style.display=a?"block":"none",b?bookgrid.getView().refresh():c?ffgrid.getView().refresh():d?identgrid.getView().refresh():e?fgrid.getView().refresh():h?alertgrid.getView().refresh():m&&rolegrid.getView().refresh(),
p=n="",a?(n=gs("Add Site"),p=gs("Search Sites")):b?(n="Add Bookmark",p="Search Bookmarks"):c?(n=gs("Add Profile"),p=gs("Search Profiles")):d?(n=gs("Add Identity"),p=gs("Search Identities")):e?(n=gs("Add Friend"),p=gs("Search Friends")):h?(n=gs("Add Alert"),p=gs("Search Alerts")):m?(n=gs("Add Role"),p=gs("Search Roles")):f&&(n=gs("Add Application"),p=gs("Search Applications")),setInnerHTML("addsitetext",n),setInnerHTML("searchtext",p),document.getElementById("addsite").style.display=f||e||h?"none":
"",c||d||e||h||f||m?(document.getElementById("showdeleted").checked=!1,document.getElementById("deletedcheckbox").style.display="none",document.getElementById("addsecurenote").style.display="none",document.getElementById("addsharedfolder")&&(document.getElementById("addsharedfolder").style.display="none"),document.getElementById("openfavs").style.display="none"):(document.getElementById("deletedcheckbox").style.display="",document.getElementById("addsecurenote").style.display="",document.getElementById("addsharedfolder")&&
(document.getElementById("addsharedfolder").style.display=""),document.getElementById("openfavs").style.display=""),document.getElementById("addcreditcard").style.display=c?"":"none",document.getElementById("assignrole").style.display=m?"":"none",document.getElementById("export")&&(document.getElementById("export").style.display=f?"none":""),document.getElementById("exportapp").style.display=f?"":"none");clear_messages();g?(document.getElementById("menucol").style.visibility="hidden",document.getElementById("nlmsg").style.display=
""):(document.getElementById("menucol").style.visibility="visible",document.getElementById("nlmsg").style.display="none",searchField.setValue(""),submitSearchForm(searchField,getCurrentStore()));return!0}function setClassName(a,b){if(a=document.getElementById(a))a.className=b}function setInnerHTML(a,b){if(a=document.getElementById(a))a.innerHTML=b}
function getCurrentStore(){return"undefined"!=typeof g_newvault?getCurrentStoreNew():document.getElementById("acctsgrid")&&"none"!=document.getElementById("acctsgrid").style.display?groupstore:document.getElementById("bookmarksgrid")&&"none"!==document.getElementById("bookmarksgrid").style.display?bookgroupstore:document.getElementById("ffgrid")&&"none"!=document.getElementById("ffgrid").style.display?ffgroupstore:document.getElementById("identgrid")&&"none"!=document.getElementById("identgrid").style.display?
identgroupstore:document.getElementById("fgrid")&&"none"!=document.getElementById("fgrid").style.display?fgroupstore:document.getElementById("alertgrid")&&"none"!=document.getElementById("alertgrid").style.display?alertgroupstore:document.getElementById("appgrid")&&"none"!=document.getElementById("appgrid").style.display?appgroupstore:document.getElementById("advertpanel")&&"none"!=document.getElementById("advertpanel").style.display?advertgroupstore:document.getElementById("rolegrid")&&"none"!=document.getElementById("rolegrid").style.display?
rolegroupstore:null}
function calcStrength(a,b){var c=0;if(b==a)return 0;""!=a&&-1!=a.indexOf(b)&&(c-=15);""!=a&&-1!=b.indexOf(a)&&(c-=a.length);c+=b.length;0<b.length&&4>=b.length?c+=b.length:5<=b.length&&7>=b.length?c+=6:8<=b.length&&15>=b.length?c+=12:16<=b.length&&(c+=18);b.match(/[a-z]/)&&(c+=1);b.match(/[A-Z]/)&&(c+=5);b.match(/\d/)&&(c+=5);b.match(/.*\d.*\d.*\d/)&&(c+=5);b.match(/[!,@,#,$,%,^,&,*,?,_,~]/)&&(c+=5);b.match(/.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~]/)&&(c+=5);b.match(/(?=.*[a-z])(?=.*[A-Z])/)&&(c+=
2);b.match(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/)&&(c+=2);b.match(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!,@,#,$,%,^,&,*,?,_,~])/)&&(c+=2);c*=2;0>c?c=0:100<c&&(c=100);return c}function togglepw(a,b,c,d){"undefined"==typeof a&&(a="p");"password"==document.getElementById(a).type?pa(function(){logToggle(d,c);togglepwprotected(a,b)},g_view_pw_prompt):togglepwprotected(a,b)}
function logToggle(a,b){"undefined"!=typeof g_loglogins&&0!=g_loglogins&&a&&"0"!=a&&""!=a&&(b||(b=""),a="id="+encodeURIComponent(a)+"&method=web"+(""!=b?"&sharedfolderid="+encodeURIComponent(b):""),$.ajax({url:geturltoloadex("loglogin.php"),type:"POST",dataType:"xml",data:a,timeout:2E4,error:function(){},success:function(a){}}))}
function togglepwnote(){if(document.getElementById("note_Password")&&document.getElementById("note_pweye")){var a=document.getElementById("note_Password"),b=document.getElementById("note_pweye");"password"==a.type?(a.type="text",b.src="/images/vault/eye-shown.png"):(a.type="password",b.src="/images/vault/eye-hidden.png")}}
function togglepwprotected(a,b){"undefined"==typeof a&&(a="p");a=document.getElementById(a);b=document.createElement("input");"password"==a.type?(b.type="text",document.getElementById("eye")&&(document.getElementById("eye").src="/images/vault/eye-hidden.png"),b.style.fontFamily="Courier"):(b.type="password",document.getElementById("eye")&&(document.getElementById("eye").src="/images/vault/eye-shown.png"));b.style.paddingRight="30px";b.value=a.value;a.name&&(b.name=a.name);a.id&&(b.id=a.id);a.className&&
(b.className=a.className);a.size&&(b.size=a.size);a.tabIndex&&(b.tabIndex=a.tabIndex);a.accessKey&&(b.accessKey=a.accessKey);a.onkeyup&&(b.onkeyup=a.onkeyup);a.parentNode.replaceChild(b,a)}var g_sec_func=null,g_sec_fail_func=null,g_sec_force=null,g_passhash=null;
function pa(a,b,c,d,e,f,g){1!=b&&1!=b||infav||null!=gRecovery?a():(g_sec_func=a,g_sec_fail_func="undefined"!=typeof d?d:null,g_sec_force="undefined"!=typeof c?c:null,g_passhash="undefined"!=typeof e?e:null,"undefined"!=typeof g_sapr_pwd&&"undefined"!=typeof g_sapr_newpwd?pasubmit(1,g_sapr_pwd):"object"===typeof lpFederatedLoginObj&&lpFederatedLoginObj.wasLastLoginFederated()?($.ajax({global:!1,type:"GET",cache:!1,url:"error.php?msg=This never gonna be called, if you see it in the logs, this path has to be kept"}),
g?confirmMasterPasswordWithToken(function(b){a(b.confirm_token)},null,g):pasubmit(1,lpFederatedLoginObj.getFederatedMasterPassword())):FederatedLogin.isFederated(g_username,function(b){if(b)FederatedLogin.getPassword(g_username,function(b){g?confirmMasterPasswordWithToken(function(b){a(b.confirm_token)},null,g):pasubmit(1,b)},MessageBoxErrorHandler);else if("undefined"!=typeof g_multifactor_reprompt&&g_multifactor_reprompt&&!f)send_website_event("multifactorreprompt","",g_username),counter=0,setTimeout(function(){checkMultifactorReprompt()},
250);else if(g)confirmMasterPasswordWithToken(function(b){a(b.confirm_token)},null,g);else{b=gs("LastPass Login");var d="undefined"!=typeof g_langpassed&&""!=g_langpassed?"&lang="+encodeURIComponent(g_langpassed):"";d="reprompt.php?u="+encodeURIComponent(g_username)+d;c&&(d+="&force=1");lpwindow({name:"secwin",title:b,url:geturltoloadex(d)})}},MessageBoxErrorHandler))}
function checkMultifactorReprompt(){"done"==document.getElementById("eventdata3").value?g_sec_func():"error"==document.getElementById("eventdata3").value?(g_sec_fail_func&&g_sec_fail_func(),lpmessagebox(gs("An Error Occurred"),gs("Authentication Failed."))):(counter++,4<counter&&"working"!=document.getElementById("eventdata3").value?pa(g_sec_func,!0,g_sec_force,g_sec_fail_func,g_passhash,!0):setTimeout(function(){checkMultifactorReprompt()},250))}
function pasubmit(a,b){"function"===typeof tracelog&&tracelog("Password change flow started.");b||(b=document.getElementById("pw").value,document.getElementById("pw").value="",hidedialog({name:"secwin"}));if(a){a="undefined"!=typeof g_key_iterations?g_key_iterations:1;var c=make_lp_key_iterations(g_username,b,a);if(""!=g_local_key&&c==g_local_key)g_passhash?g_sec_func(make_lp_hash_iterations(c,b,a)):g_sec_func();else{if("setbyreprompt"==g_local_key){g_local_key=make_lp_key_iterations(g_username,b,
a);g_passhash?g_sec_func(make_lp_hash_iterations(c,b,a)):g_sec_func();return}null!=g_sec_fail_func&&g_sec_fail_func();lpmessagebox(null,gs("Invalid Password."))}}else null!=g_sec_fail_func&&g_sec_fail_func(),"function"===typeof parent_callback_finished&&parent_callback_finished();g_passhash=null}function clickcheck(a,b,c){selrows[b]=a?b:null}function clearselected(){for(var a in selrows)null!=selrows[a]&&"remove"!=a&&(selrows[a]=null)}
function getselcount(){var a=0,b;for(b in selrows)null!=selrows[b]&&"remove"!=b&&a++;return a}function delSel(a){if(0==getselcount())lpmessagebox(gs("Please Make a Selection"),gs("You have not selected any sites. Please click on the checkbox next to the sites you wish to delete."));else{var b=getActionMessage(getCurrentStore(),"DelTitle");var c=getActionMessage(getCurrentStore(),"Del");lpconfirmbox(b,c,function(){delSelReal(a)})}}
function delSelReal(a){var b=[],c;for(c in selrows)null!=selrows[c]&&"remove"!=c&&(b[b.length]=c);if(checkIllegalSharedFolderDelete(b)){var d=0,e=getCurrentStore();for(c=0;c<b.length&&!d;c++)for(var f=e.query("id",b[c],!1,!0),g=0;g<f.length&&!d;g++){var m=f.itemAt(g);if(1==m.data.pwprotect||("http://sn"==m.data.url?g_edit_sn_prompt:g_edit_site_prompt))d=1}pa(function(c){realDelAid(b,c,a)},d,null,null,!0);clearselected()}}
function purgeSel(a){if(0==getselcount())lpmessagebox(gs("Please Make a Selection"),gs("You have not selected any sites. Please click on the checkbox next to the sites you wish to delete."));else{var b=gs("Delete Forever?");var c=getActionMessage(getCurrentStore(),"DelForeverConfirmMultiple");lpconfirmbox(b,c,function(){purgeSelReal(a)})}}
function undelSel(a){if(0==getselcount())lpmessagebox(gs("Please Make a Selection"),gs("You have not selected any sites. Please click on the checkbox next to the sites you wish to undelete."));else{var b="",c="",d;for(d in selrows)null!=selrows[d]&&"remove"!=d&&(b+=c+d,c=",");undelAid(b,null,a)}}function purgeSelReal(a){var b=[],c;for(c in selrows)null!=selrows[c]&&"remove"!=c&&(b[b.length]=c);purgeSite(b,null,a);clearselected()}
function grpmove(a,b,c){a=trim(a);var d="",e="";""==a&&(a=gs("(none)"));var f=-1==a.indexOf("\\")?a:a.substr(0,a.indexOf("\\")),g=!1;if("undefined"!=typeof sharedfoldergroups[f]){if("undefined"==typeof g_newvault)return alert(gs("You currently cannot move sites in/out of shared folders on the website, please use the browser plugin instead.")),!1;g=!0}var m="",h=a,n=null;"string"==typeof b&&(m+="&token="+encodeURIComponent(b));for(var p=-1,r=c.split(","),q=0;q<r.length;q++)if("undefined"!=typeof sharedfolderaidmap[r[q]])if(-1==
p)p=sharedfolderaidmap[r[q]];else{if(p!=sharedfolderaidmap[r[q]]){alert(gs("Please move from/to one shared folder at a time"));return}}else if(-1==p)p="";else if(""!=p){alert(gs("Please move from/to one shared folder at a time"));return}if(g||""!=p)if(n=getShareId(f),-1==n&&(n=""),p==n)m+="&sharedfolderid="+encodeURIComponent(n),h=h.substr(f.length+1),n=getSharedFolderKey(n);else return moveIntoSharedFolder(p,n,a,c,b),!1;if("undefined"==typeof g_newvault)for(q in b=getCurrentStore(),selrows){if(null!=
selrows[q]&&"remove"!=q){if("undefined"!=typeof sharedfolderaidmap[q])return alert(gs("You currently cannot move sites in/out of shared folders on the website, please use the browser plugin instead.")),!1;d+=e+q;e=",";c=b.query("id",q,!1,!0);for(f=0;f<c.length;f++)p=c.itemAt(f)," favorites"!=p.data.group&&(p.data.group=a)}}else{r=c.split(",");for(q=0;q<r.length;q++)updateGroup(a,r[q]);d=c}Ext.Ajax.request({url:geturltoloadex("groups.php?src=website&aids="+encodeURIComponent(d)+"&newgrp="+encodeURIComponent(lpenc(h,
n))+m),success:function(){},failure:function(){lpmessagebox(gs("An Error Occurred"),gs("An Error occurred"))}});"undefined"==typeof g_newvault?(hidedialog(),searchagain(50)):repopulate()}function en(a){return encodeURIComponent(a)}
function moveIntoSharedFolder(a,b,c,d,e,f,g){e=gs("By moving sites to a shared folder, you may make them unavailable to others.")+"\n\n"+gs("Continue?");if(!f||"undefined"==typeof f.skipConfirm||!f.skipConfirm)if(""!=a&&""==b?e=gs("By moving sites from a shared folder to your general vault, you may make them unavailable to others.")+"\n\n"+gs("Continue?"):""!=a&&""!=b&&(e=gs("By moving sites to a different shared folder, you may change who can access them.")+"\n\n"+gs("Continue?")),!confirm(e))return!1;
f||show_waitbox();e="cmd=sfdownloadaccounts&aids="+encodeURIComponent(d);""!=a&&(e+="&sharedfolderid="+encodeURIComponent(a));"undefined"!=typeof g&&g&&0<g.length&&(e+="&from="+encodeURIComponent(g));$.ajax({url:geturltoloadex("lastpass/api.php"),type:"POST",dataType:"xml",data:e,timeout:2E4,error:function(){f?f.errorCallback&&f.errorCallback():hide_waitbox()},success:function(e){var h=""!=b?getSharedFolderKey(b):g_local_key,n=""!=a?getSharedFolderKey(a):g_local_key,m="cmd=uploadaccounts&username="+
encodeURIComponent(lp_username);"undefined"!=typeof g&&g&&0<g.length&&(m+="&from="+encodeURIComponent(g));for(var r="",q=0,w=[],v=!1;e.getElementsByTagName("accountinfo"+q).length;){var u=e.getElementsByTagName("accountinfo"+q)[0],B=u.getAttribute("aid");null!=u.getAttribute("appname")&&(B="app"+B);var y=get_record(B),G=!1;if("undefined"!=typeof y.individualshare&&y.individualshare){if("undefined"!=typeof y.sharedfromaid&&null!=y.sharedfromaid&&""!=y.sharedfromaid&&"0"!=y.sharedfromaid)return alert(gs("You cannot move individually shared sites into a shared folder.")),
!1;if(v)G=!0;else if(v=gs("This item has already been shared, so you can't move it to a shared folder.")+"\n\n"+gs("Make a copy?"),confirm(v))v=G=!0;else return!1}var A="";y=c;if(""!=b){var C=y.indexOf("\\");A=-1!=C?y.substr(C+1):""}else A=y;w[u.getAttribute("aid")]=y;y=!1;C="";u.getAttribute("appname")?(y=!0,C="&appname"+q+"="+en(u.getAttribute("appname"))+"&name"+q+"="+en(lpenc(lpdec(u.getAttribute("name"),n),h))+"&type"+q+"="+en("web")+"&group"+q+"="+en(lpenc(A,h))+"&extra"+q+"="+en(lpenc(lpdec(u.getAttribute("extra"),
n),h))+"&script"+q+"="+en(u.getAttribute("script"))+"&pwprotect"+q+"="+en(u.getAttribute("pwprotect"))+"&wininfo"+q+"="+en(u.getAttribute("wininfo"))+"&wintitle"+q+"="+en(u.getAttribute("wintitle"))+"&exeversion"+q+"="+en(u.getAttribute("exeversion"))+"&exehash"+q+"="+en(u.getAttribute("exehash"))+"&fiid"+q+"="+en(u.getAttribute("fiid"))):(C="&url"+q+"="+en(u.getAttribute("url"))+"&username"+q+"="+en(lpenc(lpdec(u.getAttribute("username"),n),h))+"&password"+q+"="+en(lpenc(lpdec(u.getAttribute("password"),
n),h))+"&totp"+q+"="+en(lpenc(lpdec(u.getAttribute("totp"),n),h))+"&name"+q+"="+en(lpenc(lpdec(u.getAttribute("name"),n),h))+"&type"+q+"="+en("web")+"&grouping"+q+"="+en(lpenc(A,h))+"&extra"+q+"="+en(lpenc(lpdec(u.getAttribute("extra"),n),h))+"&pwprotect"+q+"="+en(u.getAttribute("pwprotect"))+"&realm"+q+"="+en(lpenc(lpdec(u.getAttribute("realm_data"),n),h)),"1"==u.getAttribute("save_all")&&(C+="&save_all"+q+"=1"),u.getAttribute("notetype")&&""!=u.getAttribute("notetype")&&(C+="&notetype"+q+"="+en(u.getAttribute("notetype"))),
u.getAttribute("template")&&""!=u.getAttribute("template")&&(C+="&template"+q+"="+en(u.getAttribute("template"))));""!=u.getAttribute("attachkey")&&(C+="&attachkey"+q+"="+en(lpenc(lpdec(u.getAttribute("attachkey"),n),h)));C+="&aid"+q+"="+en(u.getAttribute("aid"));A="";for(var D=0;null!=u.getAttribute("field"+D+"value");D++){var I=u.getAttribute("field"+D+"value"),F=u.getAttribute("field"+D+"type");if(y||"text"==F||"email"==F||"tel"==F||"password"==F||"textarea"==F||"hidden"==F)I=lpenc(lpdec(I,n),
h);else if("checkbox"==F||"radio"==F)I+=null!=u.getAttribute("field"+q+"check")?"-1":"-0";A=y?A+("&fields"+q+"id"+D+"="+en(u.getAttribute("field"+D+"id"))+"&fields"+q+"type"+D+"="+en(u.getAttribute("field"+D+"type"))+"&fields"+q+"value"+D+"="+en(I)):A+("&fields"+q+"name"+D+"="+en(u.getAttribute("field"+D+"name"))+"&fields"+q+"type"+D+"="+en(u.getAttribute("field"+D+"type"))+"&fields"+q+"value"+D+"="+en(I)+"&fields"+q+"formname"+D+"="+en(u.getAttribute("field"+D+"formname")))}m+=C;m+=A;G||(r+=en(B)+
",");q++;4===(g_loglogins&4)&&(m+="&reportname="+en(lpdec(u.getAttribute("name"),n)));8===(g_loglogins&8)&&(m+="&reportusername="+en(lpdec(u.getAttribute("username"),n)))}m+="&sharedfolderid="+en(b);""!=a&&(m+="&origsharedfolderid="+en(a));m+="&todelete="+r;$.ajax({url:geturltoloadex("lastpass/api.php"),type:"POST",dataType:"xml",data:m,timeout:2E4,error:function(){f?f.errorCallback&&f.errorCallback():hide_waitbox()},success:function(a){if(f)f.successCallback&&f.successCallback(),"function"==typeof get_data&&
get_data();else{for(var c=d.split(","),e=0;e<c.length;e++){var h=0==c[e].indexOf("app")?c[e].substring(3):c[e],g=w[h];try{var m=a.getElementsByTagName("result")[0].getAttribute("aidmap"+h);updateAid(m,c[e]);updateSharedFolder(b,m);updateGroup(g,m)}catch(O){alert(gs("Your share has been denied, probably because you lack permissions"))}}repopulate();hide_waitbox();hidedialog()}}})}})}
function searchagain(a){setTimeout(function(){var a=searchField.getValue();store.clearFilter();searchField.setValue(a);submitSearchForm(searchField,store);send_website_event("refresh");groupstore.sort("group","ASC");groupstore.sort("acctname","ASC")},a)}var lperrorcount=0;
function reportError(a){try{if("undefined"==typeof lpbImprove||0!=lpbImprove)if(lperrorcount++,!(100<lperrorcount)){var b=a.match(/^(.*)location:\s+/);b&&(a=b[1]);var c="msg=website errors("+lperrorcount+"): "+encodeURIComponent(a);Ext.Ajax.request({url:geturltoloadex("error.php?"+c)})}}catch(d){}}function decitemname(a,b){if(a=document.getElementById(a)){var c=dec(a.innerHTML);a.innerHTML=b&&c.length>b?of(c.substring(0,b)+"..."):of(c)}}
function extractEmailAttributes(a,b,c,d){for(var e=[],f="",g=0;g<c;++g){0!=g&&(f+=",");var m=a.getAttribute(b+g);e.push(m);f+=a.getAttribute(b+g)}return d?f:e}
function rebuildSharesTab(a,b){a="undefined"!=typeof a&&a?"showshare2.php":"showshare.php";var c=[];c.cmd="showsharesrefreshtab";"undefined"!=typeof b&&b&&(c.token=b);try{(new Ext.data.Connection).request({url:geturltoloadex(("undefined"!=typeof g_urlprefix?g_urlprefix:"")+a),method:"POST",params:c,success:submitFOk,failure:submitFailGeneric})}catch(d){reportError("Error in rebuildSharesTab(): "+d+" ln: "+d.lineNumber)}}
function checkcapslock(a,b,c){if(document.getElementById(b)){var d=a.keyCode?a.keyCode:a.which;a=a.shiftKey?a.shiftKey:16==d?!0:!1;d=65<=d&&90>=d&&!a||97<=d&&122>=d&&a?!0:!1;document.getElementById(b).style.display=d?"":"none";c&&document.getElementById(c)&&(document.getElementById(c).style.display="none")}}
function UpdatePasswordMeter(a,b,c,d){(""==a||document.getElementById(a))&&document.getElementById(b)&&document.getElementById(c)&&(d=("undefined"!=typeof d?d:200)-2,a=""==a?"":document.getElementById(a).value,b=document.getElementById(b).value,b=top.calculateStrength(b,a),d=Math.round(b*d/4),document.getElementById(c).style.width=d+"px")}
function domain_delete(a,b,c){var d="settings.php?extjs=1";d+="&delete_edid="+encodeURIComponent(a);d+="&token="+encodeURIComponent(c);d+="&orig_uid="+encodeURIComponent(b);b="";(a=document.getElementById("edid_"+a))&&a.innerHTML.length&&(b="<br/>("+of(a.innerHTML)+")");lpconfirmbox(gs("Delete Equivalent Domains?"),gs("Are you sure you would like to delete this set of equivalent domains?")+b,function(){lpImprove("delete_equiv_domain");loadsettingswin(d)})}
function domain_submit(a,b,c,d){var e=trim(document.getElementById("domains").value).toLowerCase();if(""==e)return lpmessagebox(null,gs("The list of equivalent domains cannot be blank.")),Lpwm.uptopzindex(),!1;e=e.split(/,/);for(var f=0;f<e.length;f++){var g=trim(e[f]),m=g.match(/[\w\s-]+/g),h=m[m.length-1],n=2;if(2<=m.length)if(g.match(/^\d+\.\d+\.\d+\.\d+$/))n=4;else if("undefined"!=typeof all_tlds[h])for(var p=m[m.length-2],r=0;r<all_tlds[h].length;r++)if(3<=m.length&&all_tlds[h][r]==m[m.length-
3]+"."+p){n=4;break}else if(all_tlds[h][r]==p){n=3;break}if(m.length<n)return c=sprintf(gs("'%s' is not a valid domain"),of(g)),c+="<br><br>"+sprintf(gs("%sClick here%s to view examples and learn more about equivalent domains."),'<a target ="_blank" href="https://link.lastpass.com/help-invalid-domain">',"</a>"),lpmessagebox(null,c),Lpwm.uptopzindex(),!1}lpImprove("add_equiv_domain_end");a={type:"POST",data:{update_edid:a,domains:document.getElementById("domains").value,token:b,extjs:1,ott:d}};g_settingswin=
Lpwm.gettophtmlid();loadsettingswin("settings.php",null,c,a);return!0}function restrictmobile_enable(a){a="settings.php?extjs=1&enable_restrictmobile=1&token="+encodeURIComponent(a);loadsettingswin(a)}function restrictmobile_disable(a){a="settings.php?extjs=1&disable_restrictmobile=1&token="+encodeURIComponent(a);loadsettingswin(a)}function mobiledevice_enable(a,b){a="settings.php?extjs=1&enable_muid="+encodeURIComponent(a);a+="&token="+encodeURIComponent(b);loadsettingswin(a)}
function mobiledevice_disable(a,b,c){c="undefined"!=typeof c&&c?1:0;a="settings.php?extjs=1&disable_muid="+encodeURIComponent(a);a+="&token="+encodeURIComponent(b);a+="&killsessions="+encodeURIComponent(c);loadsettingswin(a)}
function mobiledevice_delete(a,b){var c="settings.php?extjs=1";c+="&delete_muid="+encodeURIComponent(a);c+="&token="+encodeURIComponent(b);lpconfirmbox(gs("Delete Mobile Device?"),gs("Are you sure you would like to delete this mobile device?"),function(){lpImprove("delete_mobile_device");loadsettingswin(c)})}
function trusted_delete(a,b){var c="settings.php?extjs=1";c+="&delete_tuid="+encodeURIComponent(a);c+="&token="+encodeURIComponent(b);lpconfirmbox(gs("Delete Trusted Device?"),gs("Are you sure you would like to delete this trusted device?"),function(){lpImprove("delete_trusted_device",{action:"single"});updateTrustedDeviceList();loadsettingswin(c)})}
function updateTrustedDeviceList(){var a=-1===window.location.search.indexOf("webvault=1");!a&&parent.parent.window.reduxApp&&"function"===typeof parent.parent.window.reduxApp.updateTrustedDeviceList&&parent.parent.window.reduxApp.updateTrustedDeviceList();a&&send_message_to_parent("update_trusted_device_list")}function mobiledevice_edit(a,b){hidedialog();a="settings.php?extjs=1&edit_muid="+encodeURIComponent(a);a+="&token="+encodeURIComponent(b);loadsettingswin(a)}
function mobiledevice_update(a,b,c){a="settings.php?extjs=1&update_muid="+encodeURIComponent(a);a+="&mobiledevice_label="+encodeURIComponent(document.getElementById("mobiledevice_label").value);a+="&token="+encodeURIComponent(b);b=document.getElementById("mobiledevice_label")?document.getElementById("mobiledevice_label").value:"";lpImprove("edit_mobile_device",{action:c===b?"unchanged":"changed"});loadsettingswin(a)}
function trusted_toggle(a,b,c){a="settings.php?extjs=1"+("&set_enabled="+encodeURIComponent(a)+"&for_tuid="+encodeURIComponent(b));a+="&token="+encodeURIComponent(c);loadsettingswin(a)}function trusted_edit(a,b){a="settings.php?extjs=1&edit_label=1&for_tuid="+encodeURIComponent(a);a+="&token="+encodeURIComponent(b);loadsettingswin(a)}
function trusted_update(a,b,c){a="settings.php?extjs=1"+("&update_label="+encodeURIComponent(document.getElementById("trust_label").value)+"&for_tuid="+encodeURIComponent(a));a+="&token="+encodeURIComponent(b);b=document.getElementById("trust_label")?document.getElementById("trust_label").value:"";lpImprove("edit_trusted_device",{action:c===b?"unchanged":"changed"});loadsettingswin(a)}
function oauth_delete(a,b){var c="settings.php?extjs=1";c+="&delete_oauth="+encodeURIComponent(a);c+="&token="+encodeURIComponent(b);lpconfirmbox(gs("Revoke Third Party Access?"),gs("Are you sure you would like to revoke this third party's access to your LastPass account?"),function(){loadsettingswin(c)})}function trim(a){return a.replace(/^\s+|\s+$/g,"")}
function never_delete(a,b,c){var d="settings.php?extjs=1";d+="&delete_anid=1&type="+encodeURIComponent(a)+"&url="+encodeURIComponent(b);d+="&token="+encodeURIComponent(c);lpconfirmbox(gs("Delete Never URL?"),gs("Are you sure you would like to delete this never URL?"),function(){lpImprove("delete_never_url");loadsettingswin(d)})}
function never_submit(a){var b=trim(document.getElementById("neverurl").value);if(""==b)lpmessagebox(null,gs("The URL cannot be blank.")),Lpwm.uptopzindex();else if(0==document.getElementById("nevertype").selectedIndex)lpmessagebox(null,gs("Please select a type.")),Lpwm.uptopzindex();else{var c=document.getElementById("neverurl").value,d=document.getElementById("nevertype"),e=d.options[d.selectedIndex].text;b="settings.php?extjs=1&update_anid=0&url="+encodeURIComponent(c);b+="&type="+encodeURIComponent(d.value);
b+="&token="+encodeURIComponent(a);lpImprove("add_never_url_end",{type:e,url:c});loadsettingswin(b)}}function urlrule_delete(a,b){var c="settings.php?extjs=1";c+="&delete_rid="+encodeURIComponent(a);c+="&token="+encodeURIComponent(b);lpconfirmbox(gs("Delete URL Rule?"),gs("Are you sure you would like to delete this URL Rule?"),function(){lpImprove("url_rule_delete");loadsettingswin(c)})}
function urlrule_submit(a){var b=trim(document.getElementById("urlruleurl").value);if(""==b)lpmessagebox(null,gs("The domain cannot be blank.")),Lpwm.uptopzindex();else{var c=document.getElementById("hostmatch_no").checked?"0":"1",d=document.getElementById("portmatch_no").checked?"0":"1";"0"==c&&"0"==d&&""==document.getElementById("urlrulepath").value?(lpmessagebox(null,gs("Please limit URL Rule by hostname, path, or port.")),Lpwm.uptopzindex()):(b="settings.php?extjs=1&add_rid=1&host="+encodeURIComponent(document.getElementById("urlruleurl").value),
b+="&path="+encodeURIComponent(document.getElementById("urlrulepath").value),b=b+("&exacthost="+c)+("&exactport="+d)+("&token="+encodeURIComponent(a)),loadsettingswin(b))}}
function chgseclvl(a){"undefined"===typeof switch_identity_prompt&&(switch_identity_prompt=document.getElementById("switch_identity_prompt"));"High"==a.value?(login_site_prompt.checked=edit_site_prompt.checked=edit_sn_prompt.checked=view_pw_prompt.checked=view_ff_prompt.checked=switch_identity_prompt.checked=switch_f_prompt.checked=1,allow_revert.checked=0):"MedHigh"==a.value?(allow_revert.checked=view_pw_prompt.checked=edit_sn_prompt.checked=switch_identity_prompt.checked=1,login_site_prompt.checked=
edit_site_prompt.checked=view_ff_prompt.checked=switch_f_prompt.checked=0):"Normal"==a.value&&(allow_revert.checked=switch_identity_prompt.checked=1,login_site_prompt.checked=edit_site_prompt.checked=edit_sn_prompt.checked=view_pw_prompt.checked=view_ff_prompt.checked=switch_f_prompt.checked=0)}
function sprintf(){if(arguments&&!(1>arguments.length)&&RegExp){for(var a,b=arguments[0],c=/([^%]*)%('.|0|\x20)?(-)?(\d+)?(\.\d+)?(%|b|c|d|u|f|o|s|x|X)(.*)/,d,e=0,f=0;d=c.exec(b);){b=d[1];var g=d[2],m=d[4];a=d[5];var h=d[6];d=d[7];var n="";f++;if("%"==h)a="%";else{e++;e>=arguments.length&&console.error("Error! Not enough function arguments ("+(arguments.length-1)+", excluding the string)\nfor the number of substitution parameters in string ("+e+" so far).");var p=arguments[e];n="";g&&"'"==g.substr(0,
1)?n=b.substr(1,1):g&&(n=g);g=-1;m&&(g=parseInt(m));m=-1;a&&"f"==h&&(m=parseInt(a.substring(1)));a=p;switch(h){case "b":a=parseInt(p).toString(2);break;case "c":a=String.fromCharCode(parseInt(p));break;case "d":a=parseInt(p)?parseInt(p):0;break;case "u":a=Math.abs(p);break;case "f":h=Math.pow(10,m);a=-1<m?Math.round(parseFloat(p)*h)/h:parseFloat(p);break;case "o":a=parseInt(p).toString(8);break;case "s":a=p;break;case "x":a=(""+parseInt(p).toString(16)).toLowerCase();break;case "X":a=(""+parseInt(p).toString(16)).toUpperCase()}h=
g-a.toString().length;n=0<h?Array(h+1).join(n?n:" "):""}b=b+n+a+d}return b}}
function validate_password(a,b,c,d,e,f){if(""==a)return lpmessagebox(null,gs("You must enter an email address.")),!1;if(""==b)return lpmessagebox(gs("An Error Occurred"),gs("You did not enter your LastPass master password")),!1;if(d!=c)return a='<span automation-id="errorPopUpTextContainer">'+gs("'New Password' and 'Confirm New Password' do not match.")+"</span>",lpmessagebox(gs("An Error Occurred"),a),!1;if(8>c.length&&(!f||0<c.length))return lpmessagebox(gs("An Error Occurred"),gs("Your password is too short. It must be at least 8 characters long.")),
!1;if("undefined"!==typeof g_isFederatedEmailChng&&!g_isFederatedEmailChng&&c==b)return lpmessagebox(gs("An Error Occurred"),gs("Your new password cannot be the same as your old password")),!1;if(c==a)return lpmessagebox(gs("An Error Occurred"),gs("Your password can not be the same as your email.")),!1;if("Password1234"==c)return lpmessagebox(gs("An Error Occurred"),gs("Your password is easily guessable.")),!1;if(""!=c){if(e.toLowerCase()==c.toLowerCase())return lpmessagebox(gs("An Error Occurred"),
gs("Password and password reminder cannot match.")),!1}else if("undefined"!=typeof g_local_key&&"undefined"!=typeof make_lp_key_iterations&&make_lp_key_iterations(a,e,"undefined"!=typeof g_key_iterations?g_key_iterations:1)==g_local_key)return lpmessagebox(gs("An Error Occurred"),gs("Password and password reminder cannot match.")),!1;return f&&!(0<c.length)||"function"!=typeof checkpwstrength||checkpwstrength(c)?!0:!1}
var g_rsa=null,g_rsakey=null,g_rsaencryptedids=[],g_rsaencryptedkeys=[],g_rsaaesencryptedkeys=[],g_rsadecryptedkeys=[],g_rsafailures=0,g_rsaencryptindex=0,shared_folder_keys_upload={},shared_folder_keys_upload_counter=0;
function decryptrsakeys(){if(null!=g_rsakey)if(0==g_rsaencryptindex&&(shared_folder_keys_upload={},shared_folder_keys_upload_counter=0),g_rsaencryptindex==g_rsaencryptedids.length)"undefined"==typeof g_newvault?("undefined"!=typeof populateAcctsShareData0&&setTimeout(function(){populateAcctsShareData0()},0),"undefined"!=typeof populateAppGridData0&&setTimeout(function(){populateAppGridData0()},0),"function"==typeof exportProcessSharedFolders&&setTimeout(function(){exportProcessSharedFolders()},0)):
"function"==typeof decryptdelayed&&decryptdelayed(),0<shared_folder_keys_upload_counter&&$.ajax({type:"POST",url:geturltoloadex("shared_folder_keys_upload.php?fromwebsite=1"),data:shared_folder_keys_upload,success:function(){},error:function(){}});else{var a=g_rsaencryptedids[g_rsaencryptindex],b="";"undefined"!=typeof g_rsaaesencryptedkeys[a]&&(b=lpdec(g_rsaaesencryptedkeys[a]));null!=b&&""!=b?(g_rsadecryptedkeys[a]=AES.hex2bin(b),decryptfoldername(a,g_rsadecryptedkeys[a]),g_rsaencryptindex++,decryptrsakeys()):
10<=g_rsafailures?decryptrsanobin(a,g_rsaencryptedkeys[a]):(send_website_event("rsadecrypt",g_rsakey,"",g_rsaencryptedkeys[a]),rsadecryptcheck())}}
function rsadecryptcheck(){var a=document.getElementById("eventtype").value,b=document.getElementById("eventdata4").value;switch(a){case "ok":a=g_rsaencryptedids[g_rsaencryptindex];var c=AES.hex2bin(AES.hex2bin(b));g_rsadecryptedkeys[a]=c;shared_folder_keys_upload["shareid"+shared_folder_keys_upload_counter]=a;shared_folder_keys_upload["sharekey"+shared_folder_keys_upload_counter]=g_rsaencryptedkeys[a];shared_folder_keys_upload["sharekeyaes"+shared_folder_keys_upload_counter]=lpenc(AES.hex2bin(b));
shared_folder_keys_upload_counter++;decryptfoldername(a,c);g_rsaencryptindex++;decryptrsakeys();return}g_rsafailures++;10<=g_rsafailures?decryptrsakeys():setTimeout(function(){rsadecryptcheck()},20)}
function decryptrsanobin(a,b){if(!g_rsa&&(g_rsa=new RSAKey,!parse_private_key(g_rsa,getDecryptedPrivateKey(g_rsakey)))){g_rsa=null;return}b=g_rsa.decrypt(b);var c=AES.hex2bin(b);g_rsadecryptedkeys[a]=c;shared_folder_keys_upload["shareid"+shared_folder_keys_upload_counter]=a;shared_folder_keys_upload["sharekey"+shared_folder_keys_upload_counter]=g_rsaencryptedkeys[a];shared_folder_keys_upload["sharekeyaes"+shared_folder_keys_upload_counter]=lpenc(b);shared_folder_keys_upload_counter++;decryptfoldername(a,
c);g_rsaencryptindex++;setTimeout(function(){decryptrsakeys()},10)}function decryptfoldername(a,b){"undefined"!=typeof sharedfolderdata[a]&&(sharedfoldergroups[lpdecsafe(sharedfolderdata[a].name,b)]=sharedfolderdata[a].readonly)}function getsharekey(a){return g_rsadecryptedkeys[a]}
function checktogglepw(a,b){var c=document.accountform,d="";if("undefined"!=typeof sharedfolderaidmap[c.aid.value]&&(d=sharedfolderaidmap[c.aid.value],"undefined"!=typeof sharedfolderdata[d]&&"0"==sharedfolderdata[d].give)){alert(gs("This is a shared site. You are not permitted to view the password."));return}togglepw(a,b,d,c.aid.value)}
function unlinkpersonal(a,b,c){a="unlink=1&uid="+encodeURIComponent(a)+"&token="+encodeURIComponent(b);$.ajax({url:geturltoloadex(("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php"),type:"POST",dataType:"xml",data:a,timeout:2E4,error:function(){alert(gs("Timeout error, please try again later."))},success:function(a){send_website_event("refresh");c?alert(gs("Your personal account is no longer linked with your Enterprise account.")+"\n\n"+gs("Log back in to see the changes.")):(alert(gs("Your personal account is no longer linked with your Enterprise account.")+
"\n\n"+gs("This page will automatically refresh.")),document.location.reload())}})}function testemail2(a,b,c,d,e){a="testemail=1&email="+encodeURIComponent(a);b&&(a+="&token="+encodeURIComponent(b));c&&(a+="&extra="+encodeURIComponent(c));e&&(a+="&code=1");testemailreal(a,d)}function testemail(a,b,c,d){a="testemail=1&email="+encodeURIComponent(a);b&&(a+="&extra="+encodeURIComponent(b));d&&(a+="&code=1");testemailreal(a,c)}
function testemailreal(a,b){$.ajax({url:geturltoloadex("settings.php"),type:"POST",data:a,timeout:2E4,error:function(){lpmessagebox(null,gs("Timeout error, please try again later."))},success:function(a){b?b(a):lpmessagebox(null,a)}})}
function renameShare(a,b){var c=document.getElementById("newname").value;if(0==c.length)alert(gs("Please specify a name"));else if(0<=c.indexOf("\\"))lpmessagebox(null,gs("Invalid folder name. Please enter a folder name without slashes."));else{var d=new RSAKey,e=getDecryptedPrivateKey(myprivkey);null!=e&&parse_private_key(d,e)?(d=d.decrypt(sharekey),d=lpenc("Shared-"+c,AES.hex2bin(d)),b={update:"1",rename:"1",id:a,name:c,sharename:d,token:b},$.ajax({type:"POST",url:geturltoloadex(("undefined"!=typeof g_urlprefix?
g_urlprefix:"")+"share.php"),data:b,success:function(b){"alreadyexists"==b?lpmessagebox(null,gs("Sorry, a shared folder with that name already exists within this company.  It is possible that this is a deleted folder name.")):"error"==b?lpmessagebox(null,gs("Sorry, an error occurred while trying to rename the shared folder. Please relogin and try again.")):(loadurl(shwin,("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php?id="+a),"undefined"!=typeof g_localvault&&"function"==typeof refreshsites?
refreshsites():send_website_event("refresh"))},error:function(){genericerror()}})):lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse private key."))}}
function togglesfdl(a,b,c){0==b&&lpmessagebox(null,gs("You are choosing to prevent downloading the contents of this Shared Folder to your vault. This is typically a good idea to improve performance if you have a lot of sites in Shared Folders that are not regularly used. You may always begin to download the folder contents again by going back to this menu."));b={id:a,token:c,download:b};$.ajax({type:"POST",url:geturltoloadex(("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php"),data:b,success:function(b){loadurl(shwin,
("undefined"!=typeof g_urlprefix?g_urlprefix:"")+"share.php?id="+a);"undefined"!=typeof g_localvault&&"function"==typeof refreshsites?refreshsites():send_website_event("refresh")},error:function(){genericerror()}})}function getNoteValue(a,b,c){a+=":";if(!b)return null;b="\n"+b;var d=b.indexOf("\n"+a);if("NoteType:"==a){if(0!=d)return null}else if(-1==d)return null;d++;c=c?"-1":b.indexOf("\n",d);-1==c&&(c=b.length);return b.substring(d+a.length,c).replace(/^\s*/,"").replace(/\s*$/,"")}
do_modal=function(){var a=!0;try{navigator.userAgent&&-1!=navigator.userAgent.indexOf("MSIE 8.0")&&(a=!1)}catch(b){}return a};
function addNewGroup(a,b){a||(a="");-1==a.indexOf("\\")||a.substr(0,a.indexOf("\\"));var c=getShareIdFromGroup(a);if(c&&"1"==sharedfolderdata[c].readonly)alert(gs("Sorry, this shared folder is read-only."));else{var d=null==c?g_local_key:getSharedFolderKey(c),e=a;c&&(e=lpdec(sharedfolderdata[c].name,d),e=a.substr(e.length+1));a="ajax=1&extjs=1&name=&token="+en(b)+"&url="+en(AES.bin2hex("http://group"))+"&grouping="+en(lpenc(e,d))+"&username=&password=$totp=&extra=&aid=0&openid_url=&isbookmark=0";
a+=null==c?"":"&sharedfolderid="+en(c);$.ajax({url:geturltoloadex("show_website.php"),type:"POST",dataType:"xml",data:a,timeout:2E4,error:function(){alert(gs("Timeout error, please try again later."))},success:function(a){addorupdate(a.getElementsByTagName("result")[0]);repopulate();send_website_event("refresh")}})}}function issharedfolder(a){a||(a="");-1==a.indexOf("\\")||a.substr(0,a.indexOf("\\"));return(a=getShareIdFromGroup(a))?a:!1}
function toggleWeakAlerts(a){var b=-1===window.location.search.indexOf("webvault=1");!b&&parent.parent.window.reduxApp&&"function"===typeof parent.parent.window.reduxApp.setDisablePasswordAlerts&&parent.parent.window.reduxApp.setDisablePasswordAlerts();b&&send_message_to_parent("set_disable_password_alerts");a="settings.php?extjs=1&toggle_weak=1&token="+encodeURIComponent(a);loadsettingswin(a)}
function shareOut(a){lpwindow({name:"shareout",title:"Share Folders",url:geturltoloadex("shareout.php?a=1"+(a?a:""))})}function increment_accts_version(){"undefined"!=typeof g_accts_version&&g_accts_version++}function resendInvite(a,b,c,d){a={reinvite:1,token:a,invitee:b,folder:c,ent:d};$.ajax({type:"POST",url:geturltoloadex("share.php"),data:a,success:function(){lpmessagebox(null,gs("SUCCESS!"))},error:function(){genericerror()}})}
function updateCountryBlock(){var a=document.getElementById("countryblock"),b=document.getElementsByClassName("countrycheck");if(a&&0!=b.length)for(var c=0;c<b.length;c++)"checkbox"==b[c].type&&(b[c].disabled=!a.checked)}
function checkemailmistype(a){var b={};b.emailcheck=a;$.ajax({type:"POST",async:!1,url:geturltoloadex("mistype.php"),data:b,success:function(a){setsettingsformemail=function(){"undefined"!==typeof document.settingsform&&(document.settingsform.email.value=a.corrected)};!0===a.mistyped&&lpconfirmbox(null,a.message,setsettingsformemail)},dataType:"json"})}function paramarraybuilder(a){parambuilt="";for(var b in a)parambuilt+=b+"="+a[b]+"&";return parambuilt}
function genericerror(a){lpmessagebox(a,gs("Something went wrong. Please try again."))}function hostof(a){try{var b=document.createElement("a");b.href=a;return b.host}catch(c){return""}}function lpImprove(a,b,c){try{LastpassApiHelper.sendLpImprove(a,c||g_lpImprove,b)}catch(d){}}
var getActionMessage=function(){var a=!1;return function(b,c){a||(a={site:{UndeleteConfirm:gs("Are you sure you would like to undelete this site?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected sites?"),Undelete:gs("Undelete Site?"),Del:gs("Are you sure you would like to delete the selected sites?"),DelTitle:gs("Delete Sites?"),Delete:gs("Delete Site?"),DeleteConfirm:gs("Are you sure you want to delete this item?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this item?"),
DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected sites?"),NoResults:gs("Your search didn't match any sites!"),accountadded:gs("Site added!"),accountreplaced:gs("Site replaced!"),accountupdated:gs("Site updated!"),accountdeleted:gs("Site deleted!"),accountundeleted:gs("Site undeleted!"),accountpurged:gs("Site purged!")},alert:{Undelete:gs("Undelete Alert?"),UndeleteConfirm:gs("Are you sure you would like to undelete this alert?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected alerts?"),
Del:gs("Are you sure you would like to delete the selected alerts?"),DelTitle:gs("Delete Alerts?"),Delete:gs("Delete Alert?"),DeleteConfirm:gs("Are you sure you want to delete this alert?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this alert?"),DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected alerts?"),NoResults:gs("Your search didn't match any alerts!"),accountadded:gs("Alert added!"),accountreplaced:gs("Alert replaced!"),accountupdated:gs("Alert updated!"),
accountdeleted:gs("Alert deleted!"),accountundeleted:gs("Alert undeleted!"),accountpurged:gs("Alert purged!")},application:{Undelete:gs("Undelete Application?"),UndeleteConfirm:gs("Are you sure you would like to undelete this application?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected applications?"),Del:gs("Are you sure you would like to delete the selected applications?"),DelTitle:gs("Delete Applications?"),Delete:gs("Delete Application?"),DeleteConfirm:gs("Are you sure you want to delete this application?"),
DelForeverConfirm:gs("Are you sure you want to permanently delete this application?"),DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected applications?"),NoResults:gs("Your search didn't match any applications!"),accountadded:gs("Application added!"),accountreplaced:gs("Application replaced!"),accountupdated:gs("Application updated!"),accountdeleted:gs("Application deleted!"),accountundeleted:gs("Application undeleted!"),accountpurged:gs("Application purged!")},
profile:{Undelete:gs("Undelete Profile?"),UndeleteConfirm:gs("Are you sure you would like to undelete this profile?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected profiles?"),Del:gs("Are you sure you would like to delete the selected profiles?"),DelTitle:gs("Delete Profiles?"),Delete:gs("Delete Profile?"),DeleteConfirm:gs("Are you sure you want to delete this profile?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this profile?"),DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected profiles?"),
NoResults:gs("Your search didn't match any profiles!"),accountadded:gs("Profile added!"),accountreplaced:gs("Profile replaced!"),accountupdated:gs("Profile updated!"),accountdeleted:gs("Profile deleted!"),accountundeleted:gs("Profile undeleted!"),accountpurged:gs("Profile purged!")},friend:{Undelete:gs("Undelete Friend?"),UndeleteConfirm:gs("Are you sure you would like to undelete this friend?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected friends?"),Del:gs("Are you sure you would like to delete the selected friends?"),
DelTitle:gs("Delete Friends?"),Delete:gs("Delete Friend?"),DeleteConfirm:gs("Are you sure you want to delete this friend?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this friend?"),DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected friends?"),NoResults:gs("Your search didn't match any friends!"),accountadded:gs("Friend added!"),accountreplaced:gs("Friend replaced!"),accountupdated:gs("Friend updated!"),accountdeleted:gs("Friend deleted!"),
accountundeleted:gs("Friend undeleted!"),accountpurged:gs("Friend purged!")},identity:{Undelete:gs("Undelete Identity?"),UndeleteConfirm:gs("Are you sure you would like to undelete this identity?"),UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected identities?"),Del:gs("Are you sure you would like to delete the selected identities?"),DelTitle:gs("Delete Identities?"),Delete:gs("Delete Identity?"),DeleteConfirm:gs("Are you sure you want to delete this identity?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this identity?"),
DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected identities?"),NoResults:gs("Your search didn't match any identities!"),accountadded:gs("Identity added!"),accountreplaced:gs("Identity replaced!"),accountupdated:gs("Identity updated!"),accountdeleted:gs("Identity deleted!"),accountundeleted:gs("Identity undeleted!"),accountpurged:gs("Identity purged!")},role:{Undelete:gs("Undelete Role?"),UndeleteConfirm:gs("Are you sure you would like to undelete this role?"),
UndeleteConfirmMultiple:gs("Are you sure you would like to undelete the selected roles?"),Del:gs("Are you sure you would like to delete the selected roles?"),DelTitle:gs("Delete Roles?"),Delete:gs("Delete Role?"),DeleteConfirm:gs("Are you sure you want to delete this role?"),DelForeverConfirm:gs("Are you sure you want to permanently delete this role?"),DelForeverConfirmMultiple:gs("Are you sure you want to permanently delete the selected roles?"),NoResults:gs("Your search didn't match any roles!"),
accountadded:gs("Role added!"),accountreplaced:gs("Role replaced!"),accountupdated:gs("Role updated!"),accountdeleted:gs("Role deleted!"),accountundeleted:gs("Role undeleted!"),accountpurged:gs("Role purged!")}});return a[b===ffgroupstore||"ff"===b?"profile":b===identgroupstore||"ident"===b?"identity":b===fgroupstore||"shares"===b?"friend":b===alertgroupstore||"credmon"===b?"alert":b===appgroupstore?"application":b===rolegroupstore?"role":"site"][c]}}();function es(a){a=a.replace(/\\/g,"\\\\");a=a.replace(/'/g,"\\'");return a=a.replace(/"/g,'\\"')}function of(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML}function strip_tags(a){return a.replace(/<[^>]+>/g,"")}function trim(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var g_override_force_logout="";
function force_logout(a){window.location.href=g_override_force_logout.length?g_override_force_logout:null!=a?a:"https://lastpass.com/logout.php?nk_enc=1"}function encecb(a,b){if(null==a||0==a.length)return"";if(!b){if("string"!=typeof g_local_key||0==g_local_key.length){if("undefined"==typeof ischrome||lploggedin)g_one_alert||(g_one_alert=1,alert("No encryption key found, forcing logoff!")),force_logout();return""}b=g_local_key}return AES.Encrypt({pass:b,data:a,b64:!0,bits:256})}
var g_one_alert=0,g_aKeys={},allowWebCryptoApi=!0;
function enccbc(a,b,c){if(null==a||0==a.length){if("function"==typeof c){c("");return}return""}if("undefined"!=typeof b&&null!=b)var d=b;else{if("string"!=typeof g_local_key||0==g_local_key.length){if("undefined"==typeof ischrome||lploggedin)g_one_alert||(g_one_alert=1,alert("No encryption key found, forcing logoff!")),force_logout();if("function"==typeof c){c("");return}return""}d=g_local_key}if(1E3<a.length)if("undefined"!==typeof g_isie&&g_isie){if("function"==typeof lpusexpcomencrypt&&lpusexpcomencrypt()&&
"function"==typeof lpxpcomobj.encryptcbc){b=lpxpcomobj.encryptcbc(lp_bin2hex(d),a);if("function"==typeof c){c(b);return}return b}if("function"==typeof have_nplastpass&&have_nplastpass()&&"undefined"!=typeof g_nplastpass&&"function"==typeof g_nplastpass.encryptcbc){b=g_nplastpass.encryptcbc(AES.bin2hex(d),a);if("function"==typeof c){c(b);return}return b}if("function"==typeof c&&"function"==typeof have_binary_function&&have_binary_function("encryptcbc")){call_binary_function("encryptcbc",AES.bin2hex(d),
a,c);return}}else if(c&&allowWebCryptoApi&&"undefined"!==typeof crypto&&crypto.subtle&&crypto.subtle.importKey&&crypto.subtle.encrypt){var e=crypto.getRandomValues(new Uint8Array(16));return crypto.subtle.importKey("raw",bin2ab(d),"AES-CBC",!1,["encrypt"]).then(function(b){return crypto.subtle.encrypt({name:"AES-CBC",iv:e},b,bin2ab(a))}).then(function(a){var b="!"+btoa(ab2bin(e));b=b+"|"+btoa(ab2bin(a));c(b)}).catch(function(b){console.error("Web Crypto API encryption failed, falling back to legacy crypto functions");
console.error(b);lpReportError("Web Crypto API encryption failed, falling back to legacy crypto functions. uid="+g_uid);allowWebCryptoApi=!1;enccbc(a,d,c)})}if("undefined"==typeof g_aKeys[d]){var f=[],g=d.length;for(b=0;b<g;++b)f[b]=d.charCodeAt(b);g_aKeys[d]=f}b=AES.CreateIV(16);e=b.str;b=b.arr;b="!"+AES.eb64(e)+"|"+AES.Encrypt({key:g_aKeys[d],iv:b,data:a,b64:!0,bits:256,mode:"cbc"});if("function"==typeof c)c(b);else return b}function enc(a,b){return enccbc(a,b)}
function dec(a,b,c,d){if(null==a||0==a.length){if("function"==typeof d){d("");return}return""}if("(none)"===a||"function"===typeof gs&&a===gs("(none)")){if("function"==typeof d){d(a);return}return a}if("undefined"==typeof b||null==b){if("string"!=typeof g_local_key||0==g_local_key.length){if("undefined"==typeof ischrome||lploggedin)g_one_alert||(g_one_alert=1,alert("No encryption key found, forcing logoff! "+typeof g_local_key)),force_logout("https://lastpass.com/logout.php?nk_dec=1");if("function"==
typeof d){d("");return}return""}b=g_local_key}g_to_dec=a;var e="",f=!0;if("object"==typeof lptoolband&&"undefined"==typeof c&&!c){f=!1;try{e=lptoolbandcall(["lpdecie",AES.bin2hex(b),a])}catch(g){f=!0}}if("function"==typeof have_nplastpass&&have_nplastpass()&&"undefined"!=typeof g_nplastpass&&"function"==typeof g_nplastpass.decrypt&&"function"==typeof g_nplastpass.decryptcbc){b=AES.bin2hex(b);b="!"==a.charAt(0)?g_nplastpass.decryptcbc(b,a):g_nplastpass.decrypt(b,a);if("function"==typeof d){d(b);return}return b}if("function"==
typeof d&&"function"==typeof have_binary_function&&have_binary_function("decrypt")&&have_binary_function("decryptcbc"))b=AES.bin2hex(b),"!"==a.charAt(0)?call_binary_function("decryptcbc",b,a,d):call_binary_function("decrypt",b,a,d);else{if(f)if("!"!=a.charAt(0))e=atob(a),"!"==e.charAt(0)&&1==e.length%16&&32<e.length?(c=e.substring(1,17),e=e.substring(17),e=dec("!"+btoa(c)+"|"+btoa(e),b),""==e&&(e=AES.Decrypt({pass:b,data:a,b64:!0,bits:256}))):e=AES.Decrypt({pass:b,data:a,b64:!0,bits:256});else{a=
a.split("|",2);if(2!=a.length){if("function"==typeof d){d("");return}return""}if("undefined"==typeof g_aKeys[b]){c=[];e=b.length;for(k=0;k<e;++k)c[k]=b.charCodeAt(k);g_aKeys[b]=c}e=AES.Decrypt({key:g_aKeys[b],iv:AES.B64ToBytes(a[0].substring(1)),data:a[1],b64:!0,bits:256,mode:"cbc"})}if("function"==typeof d)d(e);else return e}}function lpenc(a){return enc(a)}function lpenc(a,b){return enc(a,b)}function lpdec(a){return dec(a)}function lpdec(a,b,c){return dec(a,b,!1,c)}
function lpenc_u(a){return updated_enc?enc(a):a}var lpdec_u_cache=[];function lpdec_u(a){return updated_enc?("undefined"==typeof lpdec_u_cache[a]&&(lpdec_u_cache[a]=dec(a)),lpdec_u_cache[a]):a}function lpbin2hex_u(a){return updated_enc?AES.bin2hex(a):a}function lphex2bin_u(a){return updated_enc?AES.hex2bin(a):a}function fix_username(a){return a?a.toLowerCase().replace(/\s*/g,""):""}function utf8_string(a){if("undefined"==typeof g_oldpbkdf2||1!=g_oldpbkdf2)a=lp_sha2lib.utf8encode(a);return a}
function make_lp_hash(a,b){return SHA256(SHA256(fix_username(a)+b)+b)}function make_lp_key(a,b){return AES.hex2bin(SHA256(fix_username(a)+b))}function make_lp_key_iterations(a,b,c,d){if(1==c){if("function"==typeof d){d(make_lp_key(a,b),b,c);return}return make_lp_key(a,b)}a=utf8_string(a);var e=b;b=utf8_string(b);return AES.hex2bin(lp_pbkdf2(b,a,c,32,"function"==typeof d?function(a){d(a,e,c)}:null))}
function make_lp_hash_iterations(a,b,c,d){if(1==c)return a=SHA256(AES.bin2hex(a)+b),"function"===typeof d&&d(a),a;b=utf8_string(b);return lp_pbkdf2(a,b,1,32,"function"===typeof d?function(a){d(AES.bin2hex(a))}:null)}function make_lp_key_hash(a,b,c){var d=get_key_iterations(a);make_lp_key_hash_iterations(a,b,d,function(a,b){c(a,b,d)})}
function make_lp_key_hash_iterations(a,b,c,d){make_lp_key_iterations(a,b,c,function(a){var e=make_lp_hash_iterations(a,b,c);d(a,e);b="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"})}function check_email(a){return a.match(/^.+@.+\.[A-Za-z]{2,}$/)}var iebody=null;"undefined"!=typeof document&&(iebody=document.compatMode&&"BackCompat"!=document.compatMode?document.documentElement:document.body);
function offsetL(){return document.all?iebody.scrollLeft:pageXOffset}function offsetT(){return document.all?iebody.scrollTop:pageYOffset}var FILENAME_FRAGMENT_VALID=1,FILENAME_FRAGMENT_EMPTY=0,FILENAME_FRAGMENT_BAD_SHELL_CHARS=-1,FILENAME_FRAGMENT_BAD_CONTROL_CHARS=-2;
function check_filename_badchars(a){0==a.length?a=FILENAME_FRAGMENT_EMPTY:/[;\$\|\*\?]/.test(a)?(alert(gs("Suspicious characters found in selected filename, will not process it")),a=FILENAME_FRAGMENT_BAD_SHELL_CHARS):a=/[\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x7f]/.test(a)?FILENAME_FRAGMENT_BAD_CONTROL_CHARS:FILENAME_FRAGMENT_VALID;return a}
function get_mimetype_from_filename(a){var b="";if("undefined"==typeof a||0>=a.length)return b;a=a.toLowerCase();b="other:"+a.split(".").pop();-1==a.indexOf(".")?b="other:application/octet-stream":-1!=a.indexOf(".png")?b="data:image/png":-1!=a.indexOf(".gif")?b="data:image/gif":-1!=a.indexOf(".jpg")||-1!=a.indexOf(".jpeg")?b="data:image/jpg":-1!=a.indexOf(".wav")&&(b="data:audio/wav");return b}
function getAllowedFileExtensionsGrouped(){var a={};a[StringUtils.translate("Documents")]="csv tsv doc docx odt ppt pptx txt xls xlsx pdf rtf html htm xml".split(" ");a[StringUtils.translate("Media")]="png gif jpg m4a mpg wav avi mov tiff tif jpeg wmv".split(" ");a[StringUtils.translate("Other")]=["zip","rar","log","key"];return a}
function getInvalidFileExtensionMessageStrings(){var a=[StringUtils.translate("Sorry, you can't attach that file. Supported file types are:")],b=getAllowedFileExtensionsGrouped();Object.keys(b).forEach(function(c){a.push("\u2022 "+c+": "+b[c].join(", "))});return a}function getAllowedFileExtensions(){var a=getAllowedFileExtensionsGrouped();return Object.keys(a).reduce(function(b,c){return b.concat(a[c])},[])}
function isAllowedFileExtension(a){var b=getAllowedFileExtensions();a=a.toLowerCase().replace(/\\/g,"/").replace(/.*\//,"").match(/(?:\.([^.]+))?$/)[1]||"";return-1<b.indexOf(a)}function can_copy_to_clipboard(){return!0}function can_clear_clipboard(){return!0};var g_lptoolbandcallalert=!1,g_lpusingnewtoolbar=null,g_wr=!1,g_mc=!1;function wrtoolbandcall(a,b){g_wr=!0;return"undefined"==typeof b?lptoolbandcall(a):lptoolbandcall(a,b)}function lptoolbandcall(a,b){"string"==typeof a&&(a=[a]);return lptoolbandcallall(a,!0,"undefined"==typeof b?"":b)}function lptoolbanderror(a){g_lptoolbandcallalert&&(g_lptoolbandcallalert=!1,alert(__(a)))}
function lptoolbandcallall(a,b,c){b="undefined"!=typeof b&&b?!0:!1;var d="undefined"!=typeof c?c:"",e=[];c=null;d=b?d:b?[0,d]:[];try{if(g_wr&&"object"==typeof wrtoolband)c=wrtoolband;else if(g_mc&&"object"==typeof mcafeetoolband)c=mcafeetoolband;else{if(g_wr||"object"!=typeof lptoolband)return lptoolbanderror("Toolband is not an object"),d;c=lptoolband}}catch(g){return lptoolbanderror("Exception accessing toolband Z"),d}if(null==g_lpusingnewtoolbar)try{if("undefined"!=typeof c.getpluginver)g_lpusingnewtoolbar=
!1;else if("undefined"!=typeof c.call)g_lpusingnewtoolbar=!0;else return lptoolbanderror("Failed to determine toolbar version"),d}catch(g){return lptoolbanderror("Exception accessing toolband A"),d}if(g_lpusingnewtoolbar){try{var f=c.call("undefined"==typeof a?[]:a);e=(new VBArray(f)).toArray();if("undefined"==typeof e.length)return lptoolbanderror("Toolband result is not an array"),d;if("undefined"==typeof e[0]||"ok"!=e[0])return lptoolbanderror("Toolband result failed"),d;if(b&&"undefined"==typeof e[1])return lptoolbanderror("Toolband did not return a value"),
d;e.splice(0,1)}catch(g){return lptoolbanderror("Exception accessing toolband B"),d}return b?e[0]:e}f="";try{if(0<a.length)switch(f="undefined"==typeof a[0]?"":a[0],f){case "call":return c.call(a[1]);case "xhrsend":return c.xhrsend(a[1],a[2]);case "highlightfield":return c.highlightfield(a[1],a[2]);case "lpdecie":return c.lpdecie(a[1],a[2]);case "context":return c.context(a[1]);case "getpluginver":return c.getpluginver();case "editformfill":return c.editformfill();case "addsecurenote":return c.addsecurenote();
case "isloggedin":return c.isloggedin();case "getusername":return c.getusername();case "openprefs":return c.openprefs();case "login":return c.login();case "logoff":return c.logoff();case "getacctsversion":return c.getacctsversion();case "getinstalldir":return c.getinstalldir();case "geturlprefix2":return c.geturlprefix2();case "anysites":return c.anysites();case "opensettings":return c.opensettings();case "lpformsubmit":return c.lpformsubmit(a[1],a[2]);case "atob":return c.atob(a[1]);case "btoa":return c.btoa(a[1]);
case "lpxlat":return c.lpxlat(a[1]);case "pageopensametab":return c.pageopensametab();case "getidentities":return c.getidentities();case "getcurridentity":return c.getcurridentity();case "setcurridentity":return c.setcurridentity(a[1]);case "lpisp":return c.lpisp();case "loginsesame":return c.loginsesame(a[1],a[2]);case "opensharedfolders":return c.opensharedfolders();case "isenterpriseuser":return c.isenterpriseuser();case "getiehomedir":return c.getinstalldir();default:return lptoolbanderror("Invalid method.  method="+
f),d}else return lptoolbanderror("No arguments passed"),d}catch(g){return lptoolbanderror("Exception accessing toolband C\nDetails:\ncmd                  = "+f+"\nwr                   = "+(g_wr?"1":"0")+"\ntoolbandstatus       = "+("object"==typeof c?"ok":"error")+"\nwrtoolbandstatus     = "+("object"==typeof wrtoolband?"ok":"none")+"\nlptoolbandstatus     = "+("object"==typeof lptoolband?"ok":"none")+"\ntoolbandmethodstatus = "+("object"==typeof c.lpdecie?"ok":"none")+"\nwrmethodstatus       = "+
("object"==typeof wrtoolband.lpdecie?"ok":"none")+"\nlpmethodstatus       = "+("object"==typeof lptoolband.lpdecie?"ok":"none")),d}};function Arcfour(){this.j=this.i=0;this.S=[]}function ARC4init(a){var b,c;for(b=0;256>b;++b)this.S[b]=b;for(b=c=0;256>b;++b){c=c+this.S[b]+a[b%a.length]&255;var d=this.S[b];this.S[b]=this.S[c];this.S[c]=d}this.j=this.i=0}function ARC4next(){this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;var a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[a+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;
function prng_newstate(){return new Arcfour}var rng_psize=256;var rng_state,rng_pool,rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=a>>8&255;rng_pool[rng_pptr++]^=a>>16&255;rng_pool[rng_pptr++]^=a>>24&255;rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}
if(null==rng_pool){rng_pool=[];rng_pptr=0;var t;if("undefined"!=typeof navigator&&"Netscape"==navigator.appName&&"5">navigator.appVersion&&"undefined"!=typeof window&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}try{var crypt_obj=null;"undefined"!=typeof window&&"undefined"!=typeof window.crypto?crypt_obj=window.crypto:"undefined"!=typeof window&&"undefined"!=typeof window.msCrypto&&(crypt_obj=window.msCrypto);if("undefined"!=typeof crypt_obj&&
"function"==typeof crypt_obj.getRandomValues&&rng_pptr<rng_psize){var num=Math.floor((rng_psize-rng_pptr)/2)+1,buf=new Uint16Array(num);crypt_obj.getRandomValues(buf);for(var i=0;i<buf.length;i++)t=buf[i],rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255}}catch(a){}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255;rng_pptr=0;rng_seed_time()}
function rng_get_byte(){if("undefined"!==typeof window.crypto){var a=new Uint8Array(1);window.crypto.getRandomValues(a);return a[0]}if(null==rng_state){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(a){var b;for(b=0;b<a.length;++b)a[b]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;
function get_random(a,b){b=b-a+1;rng_seed_time();for(var c=[],d=0;4>d;d++)c[d]=0;rng_get_bytes(c);var e=0;for(d=0;4>d;d++)e*=256,e+=c[d];return e%b+a}function get_random_password(a,b){"number"!==typeof a&&(a=12);"number"!==typeof b&&(b=16);if(b<a){var c=a;a=b;b=c}pwlen=get_random(a,b);return rand_str(pwlen)}function rand_str(a,b){var c="";b="undefined"!==typeof b?b:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890";for(var d=0;d<a;d++)c+=b.charAt(get_random(0,b.length-1));return c}
var createRandomHexString=function(a){for(var b="",c=0;c<a;++c){var d=get_random(0,15);b+="0123456789ABCDEF".substring(d,d+1)}return b};function calculate_time_zone(a){var b=new Date,c=new Date(b.getFullYear(),0,1,0,0,0,0);b=new Date(b.getFullYear(),6,1,0,0,0,0);var d=c.toGMTString(),e=new Date(d.substring(0,d.lastIndexOf(" ")-1));d=b.toGMTString();d=new Date(d.substring(0,d.lastIndexOf(" ")-1));c=(c-e)/36E5;b=(b-d)/36E5;c==b?b="0":(0<=c-b&&(c=b),b="1");if(null==a)for(a=0;a<document.getElementById("timezone").options.length;a++)if(document.getElementById("timezone").options[a].value==convert(c)+","+b){document.getElementById("timezone").selectedIndex=
a;break}return convert(c)+","+b}function convert(a){var b=parseInt(a);a-=parseInt(a);a*=60;var c=Math.abs(parseInt(a));a-=parseInt(a);parseInt(60*a);return(0>b&&-10<b?"-0"+Math.abs(b):0==b?"0"+b:10>b&&0<b?"+0"+b:"+"+b)+":"+(10>c?"0"+c:c)};String.prototype.includes||(String.prototype.includes=function(a,b){"number"!==typeof b&&(b=0);return b+a.length>this.length?!1:-1!==this.indexOf(a,b)});
function PWCHANGER(){function a(){return"undefined"!==typeof $?$.ajax:LPPlatform.doAjax}function b(a,b,d,e,f,h,g,m,n,r,q,v,u,B,y){var X="undefined"!=typeof u?u:"";"undefined"!=typeof B&&B&&(Q=B);if("undefined"==typeof q||null==q)q="";"function"!=typeof g&&(g=function(){});F=q;J=v;w=m;"function"==typeof n&&n(0,0);c(d,b,e,h,function(c){"string"!=typeof c?g(4,!1,!1,"A : Invalid Response"):"usernametaken"==c?g(1,!1,!1,"B : Username Taken"):("function"==typeof n&&n(0,1),c={oldkey:a,oldkey1:X,oldpwhash:b,
oldemail:d,newemail:e,newpassword:f,callback:g,reencrypt:c,status:n,foundendmarker:!1},y&&(c.ks="true"),x=c,setTimeout(function(){p()},0))},function(a,b,c){g(2,!1,!1,"C : "+b+" suberror="+c)},r)}function c(b,c,d,e,f,h,g){aa(function(){V(function(){var n="undefined"!=typeof c&&null!=c&&""!=c?{wxusername:b,wxhash:c}:{};"undefined"!=typeof g&&null!=g&&""!=g&&(n.vendor=g);var m=w+"getaccts.php?changepw=1&changepw2=1&includersaprivatekeyenc=1&changeun="+(b!=d?encodeURIComponent(d):"")+"&resetrsakeys="+
(e?"1":"0")+"&includeendmarker=1";"undefined"!=typeof g_recovery_uid&&(m+="&recovery_uid="+encodeURIComponent(g_recovery_uid));a()({url:m,type:"POST",data:n,timeout:3E5,success:"function"==typeof f?f:null,error:"function"==typeof h?h:null})},h)},h)}function d(b,c,d,e,h){""===d&&e();var g=F||token;a()({url:w+"lmiapi/one-time-password",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({masterPasswordHash:d}),headers:{"X-CSRF-TOKEN":g},success:function(a,g){if("object"!==
typeof a.oneTimePasswords)"function"===typeof h&&h(a,g,"Invalid one time password response");else if(T=[],0===a.oneTimePasswords.length)"function"===typeof e&&e();else{var n=[];try{for(var m=fix_username(x.newemail),p=0;p<a.oneTimePasswords.length;p++){var r=a.oneTimePasswords[p],q={},u=dec(r.encryptedOneTimePassword,b),v=AES.hex2bin(u),w=make_lp_hash(m,v),X=make_lp_key(m,v);r.oneTimePasswordHash=w;r.randomEncryptedKey=enc(AES.bin2hex(b),X);q.encryptedOneTimePassword=enc(u,c);q.randomEncryptedKey=
enc(AES.bin2hex(c),X);q.oneTimePasswordHash=w;n.push(q);T.push(r)}}catch(oa){"function"===typeof h&&h(a,g,"OTP Encryption failed");return}f(n,d,e,h)}},error:function(a,b){"function"===typeof h&&h(a,b,"GET one time passwords failed")}})}function e(a){0!==T.length?f(T,pwhash,a,function(){"function"===typeof a&&a()}):"function"===typeof a&&a()}function f(b,c,d,e){""===c&&d();b=JSON.stringify({oneTimePasswords:b,masterPasswordHash:c});c=F||token;a()({url:w+"lmiapi/one-time-password/update",type:"POST",
contentType:"application/json",headers:{"X-CSRF-TOKEN":c},data:b,dataType:"json",success:d,error:function(a,b){"function"===typeof e&&e(a,b,"POST new one time passwords failed")}})}function g(b,c,d,e){var f=F||token;a()({url:w+"lmiapi/authenticator/backup",type:"GET",contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":f},success:function(a,f){try{W=a.userData;var g=dec(a.userData,b);var n=enc(g,c)}catch(H){"function"===typeof e&&e(a,f,"Encryption failed");return}h(n,d,e)},error:function(a,
b){a.status&&404==a.status?"function"===typeof d&&d():"function"===typeof e&&e(a,b,"GET new LP cloud backup failed")}})}function m(a){W?h(W,a,function(){"function"===typeof a&&a()}):"function"===typeof a&&a()}function h(b,c,d){b=JSON.stringify({userData:b});var e=F||token;a()({url:w+"lmiapi/authenticator/backup",type:"POST",contentType:"application/json",headers:{"X-CSRF-TOKEN":e},data:b,dataType:"json",success:c,error:function(a,b){"function"===typeof d&&d(a,b,"POST new LP cloud backup failed")}})}
function n(){var a=x.callback;"function"===typeof a&&a(2,!1,!1,null)}function p(){try{if(2==q){v=x.reencrypt.split("\n");"number"==typeof g_target_key_iterations&&(L=g_target_key_iterations,"undefined"!==typeof g_key_iterations&&g_key_iterations!=g_target_key_iterations&&(x.iterationschange="1"));A=x.newkey||make_lp_key_iterations(fix_username(x.newemail),x.newpassword,L);u+=v[0]+"\n";var b=v[1];if(""!=b){var c=rsa_extract_privatekey(b,x.oldkey);""==c&&""!=x.oldkey1&&(c=rsa_extract_privatekey(b,x.oldkey1));
""==c?(B="",Z="failed"):(B=rsa_encrypt_privatekey(c,A),c=null,Z="success");y=SHA256(AES.bin2hex(A).toUpperCase());G=SHA256(B)}}if("undefined"==typeof v.length)x.callback(2,!1,!1,"F2 : internal error");else{b=!1;try{enc(" ",A)&&(b=!0)}catch(E){}for(c=q+3;q<v.length&&q<c;++q){var e=v[q].replace(/\r\n|\r|\n/g,"").split("\t");l=e[0];if("endmarker"==l)x.foundendmarker=!0;else{var f="undefined"!=typeof e.length&&2<=e.length&&"0"==e[1];if("undefined"!=typeof l.length&&l.length){var h=null;if(b)try{var m=
dec(l,x.oldkey);var S=enc(m,A)}catch(E){h=E}if(!b||null!=h||!AES.ok(S)||0==S.length||null==m||"undefined"==typeof m.length||0==m.length){if(!f){if(b){if(m=dec(l,A),null==m||"undefined"==typeof m.length||0==m.length)C+="enc: "+l+" decrypted:  reencrypted to: "+S+(null==h?"":" : EXCEPTION_A!")+"\n"}else C+="encrypting <space> using m_newkey (m_newkey.length="+("undefined"==typeof A.length?"undefined":A.length)+") resulted in EXCEPTION_B!\n";D++}S=b?l:""}f||I++;u+=l+":"+S+"\n";"function"==typeof x.status&&
x.status(1,(q-1)/(v.length-2))}}}if(q<v.length)setTimeout(function(){p()},0);else if(x.foundendmarker)if("undefined"!=typeof Q&&Q||(Q=10),m=F||token,""!=C&&D>=I/100*Q){var K={from:"passwordChange",errors:C,username:x.oldemail,private_key_status:Z,total:v.length-2,mandatory_total:I,mandatory_failed:D,super_admin_reset:N?"yes":"no"};a()({url:w+"debug.php",data:K,type:"POST",timeout:6E5,headers:{"X-CSRF-TOKEN":m},success:function(a){},error:function(a,b){}});"function"==typeof x.callback&&x.callback(3,
null,null,"E : "+C)}else"function"===typeof tracelog&&tracelog("Re encryption finished."),g(x.oldkey,A,function(){x.iterationschange?d(x.oldkey,A,x.oldpwhash,r,n):r()},n);else"function"==typeof x.callback&&x.callback(2,!1,!1,"D : Data download not complete")}}catch(E){x.callback(2,!1,!1,"F : "+E.message)}}function r(){"function"===typeof tracelog&&tracelog("Update data to server.");var b=x.newpwhash||make_lp_hash_iterations(A,x.newpassword,L),c={reencrypt:u,newprivatekeyenc:B,newuserkeyhexhash:y,
newprivatekeyenchexhash:G,newpasswordhash:b,pwupdate:"1",email:x.newemail,token:F,encrypted_username:encecb(x.newemail,A),origusername:x.oldemail,key_iterations:L};x.iterationschange&&(c.iterationschange=x.iterationschange);x.hashmigration&&(c.hashmigration=x.hashmigration,c.ks=!0);O&&(c.is_recovery="1");if(N&&(c.superAdminReset="1",g_converttosftargetuid)){b=make_lp_key_iterations(x.newemail,x.newpassword,L);var d=make_lp_hash_iterations(b,x.newpassword,L);c.converttosfbythissharename=lpenc("Shared-SF from deleted "+
x.newemail+" "+g_recovery_uid,b);c.converttosfbythispasswordhash=d;if("undefined"!==typeof g_sasf_uids&&"undefined"!==typeof g_sasf_pubkeys&&"undefined"!==typeof g_sasf_uids_cnt){for(var f=0;f<g_sasf_uids_cnt;f++)d=new RSAKey,parse_public_key(d,g_sasf_pubkeys[f])||lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key.")),d=d.encrypt(AES.bin2hex(b)),c["adminsharekey"+f]=d,c["adminuid"+f]=g_sasf_uids[f];c.adminuidcnt=g_sasf_uids_cnt}d=new RSAKey;parse_public_key(d,
g_targetuid_pubkey)?(c.converttosfbythistargetuid=g_converttosftargetuid,c.converttosfbythistargetuidsharekey=d.encrypt(AES.bin2hex(b))):lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key."))}R&&(c.setInitialPassword="1");"undefined"!=typeof x.oldpwhash&&null!=x.oldpwhash&&""!=x.oldpwhash&&(c.wxusername=x.oldemail,c.wxhash=x.oldpwhash);"undefined"!==typeof x.ks&&x.ks&&(c.ks="true");"undefined"!=typeof J&&null!=J&&(c.password_hint=J);if("undefined"!=
typeof g_su_pubkeys&&null!=g_su_pubkeys&&g_su_pubkeys.length){b=!1;var h=0;for(f=0;f<g_su_pubkeys.length;f++)""!=g_su_pubkeys[f]&&(d=new RSAKey,parse_public_key(d,g_su_pubkeys[f])&&(c["sukey"+h]=d.encrypt(AES.bin2hex(A)),c["suuid"+h]=g_su_uids[f],b=!0,h++));c.sukeycnt=h;if(0==b&&"function"==typeof x.callback){x.callback(2,!1,!1,gs("Before your LastPass administrator can set up account recovery, all users who are Administrators must log in to a browser extension at least once."));return}}"undefined"!==
typeof g_lu_pubkeys&&null!=g_lu_pubkeys&&(h=0,g_lu_pubkeys.forEach(function(a,b){if(a){var d=new RSAKey;parse_public_key(d,a)&&(c["lukey"+h]=d.encrypt(AES.bin2hex(A)),c["luuid"+h]=g_lu_uids[b],h++)}}),c.lukeycnt=h);"undefined"!=typeof g_recovery_uid&&(c.recovery_uid=g_recovery_uid);"undefined"!=typeof g_changeiterations&&1==g_changeiterations&&(c.iterationschange="1");"undefined"==typeof g_sapr_pwd||"undefined"==typeof g_sapr_newpwd||g_converttosftargetuid||(c.to_be_federated=1,c.fed_keyALP=g_sapr_keyALP,
c.fed_keyLP=g_sapr_keyLP,c.fed_keyLPCheckHash=g_sapr_keyLPCheckHash,c.fed_fragmentId=g_sapr_fragmentId,c.fed_pwdlastset=g_sapr_lastPwdSet);document.URL.includes("familiesinvite=1")&&(c.familiesinvite=1);"undefined"!==typeof fromcid&&(c.cid=fromcid);"undefined"!=typeof g_oid_fragmentId&&(c.fedOId_fragmentId=g_oid_fragmentId);"undefined"!=typeof g_isFederatedEmailChng&&(c.fedEmailChange=g_isFederatedEmailChng);var g=x.callback,n=A,p=x.newemail,r=x.status;x=[];v=[];u="";q=2;C=A="";I=D=0;"function"==
typeof r&&r(2,0);var H=generateOtpData(p,n),M=a();H.lmiapiData.masterPasswordHash=c.wxhash;M({url:w+"lmiapi/one-time-password/add",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(H.lmiapiData),headers:{"X-CSRF-TOKEN":c.token},success:function(){localStorage.setItem(SHA256(p)+"_otp",AES.bin2hex(H.OTP));U(H.lmiapiData.oneTimePasswordHash)},error:function(){U()}});var U=function(a){a&&(c.not_to_be_deleted_otp_hash=a);M({url:w+"settings.php",data:c,type:"POST",timeout:6E5,
success:function(a){"function"==typeof r&&r(2,1);-1==a.indexOf("pwchangeok")?0<=a.indexOf("reusepass")?m(function(){e(function(){g(2,!1,!1,"H : "+a.split("\n")[1])})}):0==a.indexOf("error\n")?m(function(){e(function(){g(2,!1,!1,a.split("\n")[1])})}):m(function(){e(function(){g(2,!1,!1,"I : An error occured")})}):"function"==typeof g&&g(0,n,p)},error:function(a,b,c){m(function(){e(function(){"function"==typeof g&&g(2,!1,!1,"J : "+b+" suberror="+c)})})}})}}var q=2,w="",v=[],u="",B="",y="",G="",A="",
C="",D=0,I=0,F="",J="",x=[],L=100100,Q=10,W="",T=[],O=!1,N=!1,R=!1,Z="";this.hashMigration=function(a,b,d,e,f,h,g,m,n,r){"undefined"==typeof r&&(r="");O=R=N=!1;w=h;F=g;L=m;Q=0;"function"!=typeof n&&(n=function(){});if(a===e)n(!1,"Hash migration already happened? Maybe stale extension data");else{var q=function(a,b,c,d){0===a?n(!0):n(!1,d)};c(d,b,d,!1,function(c){"string"!=typeof c?n(!1,"Invalid response"):"usernametaken"==c?n(!1,"Username taken or deleted during hash migration"):(x={oldkey:a,oldkey1:r,
oldpwhash:b,oldemail:d,newemail:d,newkey:e,newpwhash:f,callback:q,reencrypt:c,foundendmarker:!1,iterationschange:"1",hashmigration:"1"},setTimeout(function(){p()},0))},function(){n(!1,"Error retrieving accounts data during hash migration")})}};this.recoveryChangePassword=function(a,c,d,e,f,h,g,n){O=!0;R=N=!1;b(a,c,d,d,e,!1,f,"",h,null,g,n)};this.superAdminPasswordReset=function(a,c,d,e,f,h,g,n){O=!1;N=!0;R=!1;b(a,"",c,d,e,!1,f,"",h,null,g,n)};this.setInitialPassword=function(a,c,d,e,f,h,g,n){N=O=
!1;R=!0;b(a,"",c,d,e,!1,f,"",h,null,g,n)};this.changepw=function(a,c,d,e,f,h,g,n,m,p,r,q,u,v,w){R=N=O=!1;b(a,c,d,e,f,h,g,n,m,p,r,q,u,v,w)};var aa=function(b,c){Array.isArray(window.g_su_pubkeys)&&Array.isArray(window.g_su_uids)?b():a()({url:w+"lmiapi/users/me/publicsharingkeys",type:"GET",contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":F},success:function(a){window.g_su_pubkeys=a.map(function(a){return a.publicSharingKey});window.g_su_uids=a.map(function(a){return a.userId});
b&&b()},error:function(a,b){n();c&&c(a,b,"Cannot GET sharing keys")}})},V=function(b,c){Array.isArray(window.g_lu_pubkeys)&&Array.isArray(window.g_lu_uids)?b():(window.g_lu_pubkeys=[],window.g_lu_uids=[],a()({url:w+"lmiapi/emergency-access/sharees",type:"GET",contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":F},success:function(a){a.forEach(function(a){window.g_lu_pubkeys.push(a.publicSharingKey);window.g_lu_uids.push(a.userId)});b&&b()},error:function(a,d){404===a.status?b():
(n(),c&&c(a,d,"Request for emergency access keys failed"))}}))}};function iScroll(a,b){this.element="object"==typeof a?a:document.getElementById(a);this.wrapper=this.element.parentNode;this.wrapper.style.overflow="hidden";this.wrapper.style.position="relative";this.element.style.webkitTransitionProperty="-webkit-transform";this.element.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)";this.element.style.webkitTransitionDuration="0";this.element.style.webkitTransform="translate3d(0,0,0)";this.options={bounce:!0,hScrollBar:!0,vScrollBar:!0};if("object"==
typeof b)for(var c in b)this.options[c]=b[c];this.refresh();this.element.addEventListener("touchstart",this);this.element.addEventListener("touchmove",this);this.element.addEventListener("touchend",this);this.element.addEventListener("DOMSubtreeModified",this);window.addEventListener("orientationchange",this)}
iScroll.prototype={_x:0,_y:0,handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a);break;case "webkitTransitionEnd":this.onTransitionEnd(a);break;case "orientationchange":this.refresh();break;case "DOMSubtreeModified":this.refresh()}},refresh:function(){this.element.style.webkitTransitionDuration="0";this.scrollWidth=this.wrapper.clientWidth;this.scrollHeight=this.wrapper.clientHeight;try{if("undefined"!=
typeof LPFromWebsite&&"undefined"!=typeof LPFromWebsite.ipad&&"undefined"!=typeof $.tree){var a=0;1==$.tree.focused().container.children().length&&0<$.tree.focused().container.children().children().length&&(a=$.tree.focused().container.children().children()[$.tree.focused().container.children().children().length-1].clientHeight);this.scrollHeight-=20+a}}catch(c){}this.maxScrollX=this.scrollWidth-this.element.offsetWidth;this.maxScrollY=this.scrollHeight-this.element.offsetHeight;a=this._x;var b=this._y;
this.scrollX&&this._x<this.maxScrollX&&(a=this.maxScrollX);this.scrollY&&this._y<this.maxScrollY&&(b=this.maxScrollY);this.scrollTo(a,b,"0");this.scrollX=this.element.offsetWidth>this.scrollWidth?!0:!1;this.scrollY=this.element.offsetHeight>this.scrollHeight?!0:!1;this.options.hScrollBar&&this.scrollX?(this.scrollBarX=new scrollbar("horizontal",this.wrapper),this.scrollBarX.init(this.scrollWidth,this.element.offsetWidth)):this.scrollBarX&&(this.scrollBarX=this.scrollBarX.remove());this.options.vScrollBar&&
this.scrollY?(this.scrollBarY=new scrollbar("vertical",this.wrapper),this.scrollBarY.init(this.scrollHeight,this.element.offsetHeight)):this.scrollBarY&&(this.scrollBarY=this.scrollBarY.remove())},setPosition:function(a,b){this._x=null!==a?a:this._x;this._y=null!==b?b:this._y;this.element.style.webkitTransform="translate3d("+this._x+"px,"+this._y+"px,0)";this.scrollBarX&&this.scrollBarX.setPosition(this.scrollBarX.maxScroll/this.maxScrollX*this._x);this.scrollBarY&&this.scrollBarY.setPosition(this.scrollBarY.maxScroll/
this.maxScrollY*this._y)},onTouchStart:function(a){if(1!=a.targetTouches.length)return!1;a.preventDefault();a.stopPropagation();this.element.style.webkitTransitionDuration="0";this.scrollBarX&&(this.scrollBarX.bar.style.webkitTransitionDuration="0, 250ms");this.scrollBarY&&(this.scrollBarY.bar.style.webkitTransitionDuration="0, 250ms");var b=new WebKitCSSMatrix(window.getComputedStyle(this.element).webkitTransform);b.m41==this._x&&b.m42==this._y||this.setPosition(b.m41,b.m42);this.touchStartX=a.touches[0].pageX;
this.scrollStartX=this._x;this.touchStartY=a.touches[0].pageY;this.scrollStartY=this._y;this.scrollStartTime=a.timeStamp;this.moved=!1},onTouchMove:function(a){if(1!=a.targetTouches.length)return!1;var b=!0===this.scrollX?a.touches[0].pageX-this.touchStartX:0,c=!0===this.scrollY?a.touches[0].pageY-this.touchStartY:0;if(0<this._x||this._x<this.maxScrollX)b=Math.round(b/4);if(0<this._y||this._y<this.maxScrollY)c=Math.round(c/4);this.scrollBarX&&!this.scrollBarX.visible&&this.scrollBarX.show();this.scrollBarY&&
!this.scrollBarY.visible&&this.scrollBarY.show();this.setPosition(this._x+b,this._y+c);this.touchStartX=a.touches[0].pageX;this.touchStartY=a.touches[0].pageY;this.moved=!0;250<a.timeStamp-this.scrollStartTime&&(this.scrollStartX=this._x,this.scrollStartY=this._y,this.scrollStartTime=a.timeStamp)},onTouchEnd:function(a){if(0<a.targetTouches.length)return!1;if(!this.moved){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,document.defaultView,0,0,0,0,0,0,0,0,0,0,0,null);a.changedTouches[0].target.dispatchEvent(b);
return!1}a=a.timeStamp-this.scrollStartTime;b=!0===this.scrollX?this.momentum(this._x-this.scrollStartX,a,-this._x+50,this._x+this.element.offsetWidth-this.scrollWidth+50):{dist:0,time:0};var c=!0===this.scrollY?this.momentum(this._y-this.scrollStartY,a,-this._y+50,this._y+this.element.offsetHeight-this.scrollHeight+50):{dist:0,time:0};if(!b.dist&&!c.dist)return this.onTransitionEnd(),!1;a=Math.max(b.time,c.time);b=this._x+b.dist;c=this._y+c.dist;this.element.addEventListener("webkitTransitionEnd",
this);this.scrollTo(b,c,a+"ms");this.scrollBarX&&this.scrollBarX.scrollTo(this.scrollBarX.maxScroll/this.maxScrollX*b,a+"ms");this.scrollBarY&&this.scrollBarY.scrollTo(this.scrollBarY.maxScroll/this.maxScrollY*c,a+"ms")},onTransitionEnd:function(){this.element.removeEventListener("webkitTransitionEnd",this);this.resetPosition();this.scrollBarX&&this.scrollBarX.hide();this.scrollBarY&&this.scrollBarY.hide()},resetPosition:function(){var a=null,b=null;if(0<this._x||this._x<this.maxScrollX)a=0<=this._x?
0:this.maxScrollX;if(0<this._y||this._y<this.maxScrollY)b=0<=this._y?0:this.maxScrollY;if(null!==a||null!==b)this.scrollTo(a,b,"500ms"),this.scrollBarX&&this.scrollBarX.scrollTo(this.scrollBarX.maxScroll/this.maxScrollX*(a||this._x),"500ms"),this.scrollBarY&&this.scrollBarY.scrollTo(this.scrollBarY.maxScroll/this.maxScrollY*(b||this._y),"500ms")},scrollTo:function(a,b,c){this.element.style.webkitTransitionDuration=c||"400ms";this.setPosition(a,b)},momentum:function(a,b,c,d){friction=.1;deceleration=
1.5;var e=Math.abs(a)/b*1E3;b=e*e/(20*friction)/1E3;0<a&&void 0!==c&&b>c&&(e=e*c/b,b=c);0>a&&void 0!==d&&b>d&&(e=e*d/b,b=d);c=-e/-deceleration;1>c&&(c=1);return{dist:Math.round(b*(0>a?-1:1)),time:Math.round(c)}}};
var scrollbar=function(a,b){this.dir=a;this.bar=document.createElement("div");this.bar.className="scrollbar "+a;this.bar.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)";this.bar.style.webkitTransform="translate3d(0,0,0)";this.bar.style.webkitTransitionProperty="-webkit-transform,opacity";this.bar.style.webkitTransitionDuration="0,250ms";this.bar.style.pointerEvents="none";this.bar.style.opacity="0";b.appendChild(this.bar)};
scrollbar.prototype={size:0,maxSize:0,maxScroll:0,visible:!1,init:function(a,b){var c="horizontal"==this.dir?this.bar.offsetWidth-this.bar.clientWidth:this.bar.offsetHeight-this.bar.clientHeight;this.maxSize=a-8;this.size=Math.round(this.maxSize*this.maxSize/b)+c;this.maxScroll=this.maxSize-this.size;this.bar.style["horizontal"==this.dir?"width":"height"]=this.size-c+"px"},setPosition:function(a){0>a?a=0:a>this.maxScroll&&(a=this.maxScroll);a="horizontal"==this.dir?"translate3d("+Math.round(a)+"px,0,0)":
"translate3d(0,"+Math.round(a)+"px,0)";this.bar.style.webkitTransform=a},scrollTo:function(a,b){this.bar.style.webkitTransitionDuration=(b||"400ms")+",250ms";this.setPosition(a)},show:function(){this.visible=!0;this.bar.style.opacity="1"},hide:function(){this.visible=!1;this.bar.style.opacity="0"},remove:function(){this.bar.parentNode.removeChild(this.bar);return null}};var vla={},g_verifyFederatedPersonalAccountLinking=!1;
verifyLinkedAcct=function(a,b){g_verifyFederatedPersonalAccountLinking=b;a?(vla.u=document.getElementById("linkusername"),vla.p=document.getElementById("linkpassword"),vla.u.value=vla.u.value.toLowerCase().replace(/\s*/g,""),vla.local_key=make_lp_key_iterations(vla.u.value,vla.p.value,a),vla.hash=make_lp_hash_iterations(vla.local_key,vla.p.value,a),vla.iterations=a,g_validatelink=!0,$.ajax({url:"login.php",type:"POST",dataType:"xml",timeout:6E4,data:{verifylink:1,outofbandsupported:1,outofbandrequest:0,
outofbandretry:0,outofbandretryid:"",xml:1,method:"web",username:vla.u.value,hash:encodeURIComponent(vla.hash),iterations:encodeURIComponent(vla.iterations)},success:b?verifyLinkedAccountVerificationResponse:verifyLinkResponse,error:function(a){g_porig="";hide_waitbox();"function"==typeof hidedialog&&hidedialog({closeiframe:1});lpmessagebox(null,gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}})):$.ajax({url:"iterations.php",type:"POST",dataType:"html",
data:"email="+encodeURIComponent(document.getElementById("linkusername").value),timeout:6E4,error:function(){lpmessagebox(null,gs("Timeout Error loading XML document, try again later"))},success:function(a){verifyLinkedAcct(a,b)}})};
function verifyLinkResponse(a){"function"==typeof hide_waitbox&&hide_waitbox();"function"==typeof close_virtual_keyboard&&close_virtual_keyboard();g_porig="";"function"==typeof saveKey&&saveKey();var b=$(a).find("ok");b.length?oklink(b.attr("uid"),g_mypubkey,g_fromlocal,g_token,b.attr("link_token"),b.attr("linked_account_verification_token")):(g_validatelink=!0,is_secondFactorRequired(a))}
function verifyLinkedAccountVerificationResponse(a){"function"==typeof hide_waitbox&&hide_waitbox();"function"==typeof close_virtual_keyboard&&close_virtual_keyboard();g_porig="";var b=$(a).find("ok");b.length?okverify(b.attr("linked_account_verification_token")):(g_validatelink=!0,is_secondFactorRequired(a))}"function"!==typeof get&&(get=function(a){return document.getElementById(a)});
var secondfactorcheck=[{r:"sesameotprequired",f:function(a){showSesameWindow(a)}},{r:"sesameotpfailed",f:function(){lpmessagebox(null,gs("Sesame authentication failed!"))}},{r:"otprequired",f:function(a){showOTPWindow("yubikey",a)}},{r:"googleauthrequired",f:function(a){showOTPWindow("googleauth",a)}},{r:"microsoftauthrequired",f:function(a){showOTPWindow("microsoftauth",a)}},{r:"outofbandrequired",f:function(a){showOTPWindow("outofband",a)}},{r:"securityquestionrequired",f:function(a){showOTPWindow("securityquestion",
a)}},{r:"otpfailed",f:function(){g_porig="";lpmessagebox(null,gs("YubiKey authentication failed!"))}},{r:"unknownpassword",f:function(a){g_porig="";lpmessagebox(null,a.getAttribute("message"))}},{r:"googleauthfailed",f:function(a){5>++googleauth_fail_count?showOTPWindow("googleauth",a):(lpmessagebox(null,gs("Google Authenticator authentication failed!")),g_porig="",google_auth_fail_count=0)}},{r:"securityquestionfailed",f:function(){lpmessagebox(null,gs("Security question authentication failed!"))}},
{r:"gridresponserequired",f:function(a){a.getAttribute("challenge")&&showGridWindow(a.getAttribute("challenge"),a)}},{r:"iterations",f:function(a){a.getAttribute("iterations")&&(get("iterations").value=a.getAttribute("iterations"),get("password").value=g_porig,g_donotclearfirsttime=!0,login())}},{r:"pbkdf2fallback",f:function(){get("password").value=g_porig;g_oldpbkdf2=1;g_donotclearfirsttime=!0;login()}},{r:"gridresponsefailed",f:function(){lpmessagebox(null,gs("Grid authentication failed!"));document.location.reload(!0)}},
{r:"multifactorresponserequired",f:function(a){if(a.getAttribute("challenge")){var b="";"trueapi"==a.getAttribute("type")&&(b=SHA256(SHA256(fix_username(g_username)+"trueapi")));64!=b.length?(send_website_event("multifactorauth",a.getAttribute("type"),g_username,"",a.getAttribute("challenge")),counter=0,setTimeout(function(){checkMultifactorAuth()},250)):(document.getElementById("eventdata5").value=SHA256(b+a.getAttribute("challenge")),document.getElementById("eventdata3").value="done",checkMultifactorAuth())}}},
{r:"multifactorresponsefailed",f:function(a){multifactor_response_failed(a.getAttribute("type"))}}];
function is_secondFactorRequired(a){a=$(a).find("error");a=a.length?a.get(0):{getAttribute:function(){return null}};for(var b=0;b<secondfactorcheck.length;b++)if(a.getAttribute("cause")===secondfactorcheck[b].r)return secondfactorcheck[b].f(a);"blacklist"===a.getAttribute("cause")?(g_porig="",lpmessagebox("",gs("Your account has been temporarily suspended because of too many login attempt failures."))):(g_porig="",a.getAttribute("deactivated")&&(window.location.href="protected.php?email="+encodeURIComponent(g_username)),
a.getAttribute("message")?a.getAttribute("cause")&&"unknownemail"==a.getAttribute("cause")?lpconfirmbox(null,a.getAttribute("message")+"\n\n"+gs("Would you like to create an account now?"),function(){var a="https://lastpass.com/create_account.php";document.getElementById("linkusername")&&(a+="?nologin=1&from_linked=1");window.open(a);"function"==typeof hidealldialogs&&hidealldialogs(!0)}):a.getAttribute("openurl")?(a=a.getAttribute("openurl"),document.location.href=a):lpmessagebox(null,a.getAttribute("message")):
"Microsoft Internet Explorer"==navigator.appName?lpmessagebox(null,gs("Unable to login because of an Internet Explorer bug. Please login via the plugin or use a different browser.")):lpmessagebox(null,gs("Invalid email or password!")))}
function secondfactor_link(a,b){var c={method:"web",verifylink:1,outofbandsupported:1,outofbandrequest:0,outofbandretry:0,outofbandretryid:"",xml:1,otp:a,username:vla.u.value,hash:vla.hash,iterations:vla.iterations};"undefined"!=typeof g_mftype&&"outofband"==g_mftype?(c.outofbandrequest=1,"undefined"!=typeof b&&(c.outofbandretry=1,c.outofbandretryid=b)):"undefined"!=typeof g_mftype&&"grid"==g_mftype?c.gridresponse=a:"undefined"!=typeof g_mftype&&"sesame"==g_mftype&&(c.sesameotp=a);$.ajax({url:"login.php",
type:"POST",timeout:6E4,dataType:"xml",data:c,success:function(c){if("string"==typeof c){var d=new ActiveXObject("Microsoft.XMLDOM");d.async=!1;d.loadXML(c.responseXML)}else d=c;c=$(d).find("ok");c.length?g_verifyFederatedPersonalAccountLinking?okverify(c.attr("linked_account_verification_token")):oklink(c.attr("uid"),g_mypubkey,g_fromlocal,g_token,c.attr("link_token"),c.attr("linked_account_verification_token")):(c=$(d).find("error"),c.length&&c.attr("retryid")?secondfactor_link(a,b):lpmessagebox(null,
of("Multifactor Authentication Failed")))},error:function(a){g_porig="";hide_waitbox();lpmessagebox(null,gs("An error has occurred while contacting the LastPass server.")+" "+gs("Please try again later."))}})}
function oklink(a,b,c,d,e,f){var g=new RSAKey;b?parse_public_key(g,b)?(b=g.encrypt(AES.bin2hex(vla.local_key)),a="id=0&update=1&link=1&xml=1&token="+encodeURIComponent(d)+"&newusername="+encodeURIComponent(vla.u.value)+"&newhash="+encodeURIComponent(vla.hash)+"&sharekey="+encodeURIComponent(b)+"&sharename="+encodeURIComponent(lpenc(vla.u.value,vla.local_key))+"&name="+encodeURIComponent(vla.u.value)+"&uid="+encodeURIComponent(a),a=a+"&linkvalid=1"+("&link_token="+encodeURIComponent(e)),$.ajax({url:"share.php",
type:"POST",dataType:"xml",data:a,timeout:2E4,error:function(a){lpmessagebox(null,gs("Timeout error, please try again later."))},success:function(a){if("string"==typeof a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async=!1;b.loadXML(a)}else b=a;$(b).find("ok").length?("function"===typeof storeAccountLinkToken?storeAccountLinkToken(f):send_website_event("storeaccountlinktoken",f),"undefined"!=typeof g_localvault&&"function"==typeof refreshsites?refreshsites():send_website_event("refresh"),"function"==
typeof g_verifyLinkedSuccess?g_verifyLinkedSuccess():("function"==typeof hidealldialogs&&hidealldialogs(!0),c?(lpmessagebox(null,gs("Your personal LastPass account has been linked with your enterprise account. It will show up as a sub-folder in your vault.\n\nPlease log back in to see the changes.")),setTimeout(function(){hidealldialogs(!0)},5E3)):lpmessagebox(null,gs("Your personal LastPass account has been linked with your enterprise account. It will show up as a sub-folder in your vault.\n\nThis page will automatically refresh.")),
-1===document.location.href.indexOf("#")?document.location.href=document.location.href:document.location.reload())):$(b).find("error").size()?$(b).find("error").each(function(){var a=$(this),b=a.attr("message");if("undefined"!=typeof b){var d=a.attr("disableurl");"undefined"!=typeof d&&""!=d?lpconfirmbox(null,b,function(){c?(window.open(d),hidedialog()):document.location.href=d}):lpmessagebox(null,b)}else lpmessagebox(null,gs("An error occurred. Please try again later."))}):lpmessagebox(null,gs("An error occurred. Please try again later."))}})):
lpmessagebox(gs("An Error Occurred"),gs("We are sorry, an error occurred - Cannot parse public key.")):lpmessagebox(gs("An Error Occurred"),gs("You do not appear to have a sharing key, cannot proceed."))}function okverify(a){storeAccountLinkToken(a);"undefined"!=typeof g_localvault&&"function"==typeof refreshsites?refreshsites():send_website_event("refresh");"function"==typeof hidealldialogs&&hidealldialogs(!0)};/*
 LastPass

 <pre>
   Reprompt user for their master password, verifies it is
   correct with server.

   Requires g_username and g_key_iterations javascript variables to be
   defined.
 </pre>
*/
var g_dialogclose="undefined"==typeof g_dialogclose?{}:g_dialogclose,g_dialogname="undefined"==typeof g_dialogname?{}:g_dialogname,g_windowid="undefined"==typeof g_windowid?0:g_windowid,g_lppromptid="undefined"==typeof g_lppromptid?0:g_lppromptid,g_progressargs="undefined"==typeof g_progressargs?{}:g_progressargs,g_progresstimer="undefined"==typeof g_progresstimer?null:g_progresstimer;"undefined"!=typeof LPDialog&&LPDialog.setBaseURL("newvault/");
if("function"!==typeof gs)var gs=function(a){return"undefined"!=typeof translations&&"undefined"!=typeof translations[a]?translations[a]:a};
function lpwindow(a){var b="undefined"!=typeof a.html?a.html:"",c="undefined"!=typeof a.onclick?a.onclick:null,d="undefined"!=typeof a.showok?a.showok:!1,e="undefined"!=typeof a.showcancel?a.showcancel:!1,f="undefined"!=typeof a.title?a.title:"",g="undefined"!=typeof a.xdialogwidth?a.xdialogwidth:!1,m="undefined"!=typeof a.okbuttontext?a.okbuttontext:null,h="undefined"!=typeof a.showclose?a.showclose:!0,n="undefined"!=typeof a.inputid?a.inputid:null,p="undefined"!=typeof a.url?a.url:null,r=typeof("object"===
a.urlParams)?a.urlParams:null,q="undefined"!=typeof a.onclose?a.onclose:null,w="undefined"!=typeof a.width?a.width:null,v="undefined"!=typeof a.aftershow?a.aftershow:null,u="undefined"!=typeof a.name?a.name:null,B="undefined"!=typeof a.headerhtml?a.headerhtml:null,y="undefined"!=typeof a.padding?a.padding:null,G="undefined"!=typeof a.bordercolor?a.bordercolor:null,A="undefined"!=typeof a.height?a.height:null,C="undefined"!=typeof a.overflow?a.overflow:null,D="undefined"!=typeof a.contentheight?a.contentheight:
null,I="undefined"!=typeof a.topv?a.topv:null,F="undefined"!=typeof a.maxwidth?a.maxwidth:null,J="undefined"!=typeof a.swapdefaults?a.swapdefaults:!1,x="undefined"!=typeof a.htmlafter?a.htmlafter:null,L="undefined"!=typeof a.zindex?a.zindex:null,Q="undefined"!=typeof a.nobg?a.nobg:null,W="undefined"!=typeof a.nomaxheight?a.nomaxheight:null,T="undefined"!=typeof a.noheight?a.noheight:null,O="undefined"!=typeof a.nomaxwidth?a.nomaxwidth:null,N="undefined"!=typeof a.cancelbuttontext?a.cancelbuttontext:
null,R="undefined"!=typeof a.settingswin?a.settingswin:null,Z="undefined"!=typeof a.closebgclick?a.closebgclick:!0,aa="undefined"!=typeof a.showcustom?a.showcustom:!1,V="undefined"!=typeof a.custombuttontext?a.custombuttontext:null,ea="undefined"!=typeof a.customonclick?a.customonclick:null,X="undefined"!=typeof a.leftv?a.leftv:null,Y="undefined"!=typeof a.addnewstyle?a.addnewstyle:!1,ba="undefined"!=typeof a.addnewclass?a.addnewclass:"",fa="undefined"!=typeof a.customcloseicon?a.customcloseicon:
null,P={};"undefined"!=typeof a.classok&&(P.classok=a.classok);"undefined"!=typeof a.classcancel&&(P.classcancel=a.classcancel);null!=m&&(d=!0);null!=N&&(e=!0);V&&ea||(aa=!1);lpwindow_internal(b,c,d,e,f,g,m,h,n,p,r,q,w,v,u,B,y,G,A,C,D,I,F,J,P,x,L,Q,W,T,O,N,R,Z,aa,V,ea,X,Y,ba,fa)}function lpwindowx(a){a.xdialogwidth=!0;lpwindow(a)}
function lpmessagebox(a,b,c,d,e,f){"function"===typeof tracelog&&tracelog(b);"undefined"!=typeof LPDialog?dialogs.alert.open({title:a,text:b,handler:c,closeHandler:d}):(c="undefined"!=typeof c?c:null,e?lpwindow({title:a,html:b,showok:!0,onclick:c,showclose:!1,onclose:d,addnewstyle:!0,addnewclass:e,okbuttontext:f}):lpwindow({title:a,html:b,showok:!0,onclick:c,showclose:!1,onclose:d}))}
function lpconfirmbox(a,b,c,d,e,f,g,m,h){"undefined"!=typeof LPDialog?dialogs.confirmation.open({title:a,text:b,nextButtonText:gs("OK"),backButtonText:Strings.Vault.CANCEL,handler:c,closeHandler:d}):lpwindow({title:a,html:b,showok:!0,showcancel:!0,showclose:!1,onclick:c,onclose:d,classok:e,classcancel:f,addnewclass:g,okbuttontext:m,cancelbuttontext:h,name:"confirm"})}
function lpyesnobox(a,b,c,d,e,f){"undefined"!=typeof LPDialog?dialogs.confirmation.open({title:a,text:b,nextButtonText:Strings.Vault.YES,backButtonText:Strings.Vault.NO,handler:c,closeHandler:d}):lpwindow({title:a,html:b,showok:!0,showcancel:!0,showclose:!1,onclick:c,onclose:d,classok:e,classcancel:f,okbuttontext:gs("Yes"),cancelbuttontext:gs("No")})}
function lpwaitbox(a,b){"undefined"!=typeof LPDialog&&"undefined"!=typeof dialogs&&"undefined"!=typeof dialogs.wait?dialogs.wait.open():(lpwaitboxhide(),lpwindow({title:a,html:"<br/><br/><b>"+b+"</b><br/><br/>",showclose:!1,name:"waitbox"}))}function lpwaitboxhide(){"undefined"!=typeof LPDialog&&"undefined"!=typeof dialogs&&"undefined"!=typeof dialogs.wait?dialogs.wait.close():hidedialog({name:"waitbox"})}
function lpprompt(a,b,c,d,e,f,g,m){g_lppromptid++;var h="lpprompt"+g_lppromptid;c||(c="");b='<div class="lppromptwrapper">'+b+(g?"":"<br/><br/>")+'<input id="'+h+'" type="text" style="width:300px;" value="'+ofa(c)+'" '+(e?' name="'+ofa(e)+'"':"")+"/></div>";lpwindow({title:a,html:b,showok:!0,inputid:h,okbuttontext:f,htmlafter:m,showcancel:!0,swapdefaults:!0,onclick:function(){if("undefined"!=typeof d&&d){var a=$("#"+h),b=a.val(),c=d(b);"undefined"==typeof c||c||a.focus().val("").val(b);return c}},
onclose:function(){d(null)},aftershow:function(){$("#"+h).focus().val("").val(c)}});$(".lppromptwrapper").css("text-align","center")}
"undefined"===typeof Lpwm&&(Lpwm=function(){},Lpwm.prefix="lpwin",Lpwm.htmlprefix="lpwinhtml",Lpwm.bgprefix="lpwinbg",Lpwm.titleprefix="lpwintitle",Lpwm.lpwindowstack=[],Lpwm.z=9E3,Lpwm.lock=!1,Lpwm.uptopzindex=function(){Lpwm.gettopobj().style.zIndex="50000";Lpwm.gettopbg().style.zIndex="49999"},Lpwm.next_is_dup=function(a){if(0==Lpwm.lpwindowstack.length)return!1;var b=Lpwm.gettophtmlid();if(null==b||"undefined"==typeof document.getElementById(b))return!1;b=$("#"+b).html().replace("/","");a=a.replace("/",
"");return 0==b.indexOf(a)?!0:!1},Lpwm.nextz=function(){return Lpwm.z},Lpwm.nextbgz=function(){return Lpwm.z},Lpwm.nextwinz=function(){return Lpwm.z+1},Lpwm.gettophtmlid=function(){return null==Lpwm.gettopobj()?null:Lpwm.gettopobj().id.replace(Lpwm.prefix,Lpwm.htmlprefix)},Lpwm.nexthtmltitleid=function(){return Lpwm.nextid()+"title"},Lpwm.getnumwindows=function(){return Lpwm.lpwindowstack.length},Lpwm.pushWindow=function(a){Lpwm.z++;if("undefined"==typeof a||"undefined"==typeof a.zval||"undefined"==
typeof a.id)return!1;Lpwm.lpwindowstack.push(a);return!0},Lpwm.lockit=function(){return Lpwm.lock?!1:Lpwm.lock=!0},Lpwm.unlockit=function(){Lpwm.lock&&(Lpwm.lock=!1);return!0},Lpwm.popWindow=function(){var a=Lpwm.lpwindowstack.pop();return"undefined"!==typeof a?(Lpwm.z--,a):!1},Lpwm.deleteById=function(a){for(var b in Lpwm.lpwindowstack)if(Lpwm.lpwindowstack[b].id==a)return Lpwm.lpwindowstack.splice(b,1),!0;return!1},Lpwm.currentid=function(){return 0==Lpwm.lpwindowstack.length?null:Lpwm.lpwindowstack[this.getnumwindows()-
1].id},Lpwm.currentbg=function(){return 2>Lpwm.lpwindowstack.length?null:Lpwm.lpwindowstack[this.getnumwindows()-2].id},Lpwm.gettopobj=function(){var a=Lpwm.currentid();return null!==a?document.getElementById(a):null},Lpwm.gettophtmlobj=function(){Lpwm.gettopobj();return replace(Lpwm.prefix,this.htmlprefix)},Lpwm.gettopbg=function(){var a=Lpwm.currentbg();return null!==a?document.getElementById(a):null},Lpwm.settitle=function(a,b){(a=Lpwm.gettitlefromcontentid(a))&&$("#"+a).html(b)},Lpwm.gettitlefromcontentid=
function(a,b){return 0<=a.indexOf(Lpwm.prefix)&&0<=a.indexOf("html")?a.replace("html","title"):null},LPButton=function(a,b,c,d,e){this.type=a||"";this.idprefix=b||"";this.idpostfix=c||"";this.label=d||"";this.customclass=e||""},LPButton.prototype.id=function(){return this.idprefix+this.type+this.idpostfix},LPButton.prototype.html=function(){var a=this.label;a?a=gs(a):"ok"===this.type?a=gs("OK"):"cancel"===this.type&&(a=gs("Cancel"));return'<a id="'+this.id()+'" class="nbtn rbtn btn_mini btn_exp_h '+
this.customclass+'" automation-id="'+this.type+'">'+a+"</a>"});function confirmmasterpassword(a,b,c,d){getmasterpassword(a,getmasterpasswordhelperfailure,b,!1,"",c,d)}
function performMultifactorFilteredAction(a,b,c,d){showConfirmPasswordForm(function(){var e=$("#confirmmasterpassword").val();make_lp_key_hash_iterations(g_username,e,g_key_iterations||1,function(e,g){var f=!1,h=function(e){$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"lmiapi/"+a,data:JSON.stringify($.extend(b,{username:g_username,hash:g,challengeResponse:e}))}).done(function(a){hidedialog();reduxApp&&reduxApp.getState().accountSettings.dialogIsVisible&&reduxApp.closeAccountSettings();
c(a)}).fail(function(a){if(401===a.status)if((a=a.responseJSON)&&a.challenge)switch(a.challenge.result){case "waiting":f||(f=!0,lpmessagebox(a.challenge.friendlyName,gs("We sent a push notification to your device. Please accept this request to perform the update.")));h({retryId:a.challenge.retryId});break;case "unpaired":case "failed":f&&hidedialog(),d()}else a&&2041===a.code&&lpmessagebox(gs("An Error Occurred"),gs("The master password you entered is incorrect. Please try again."));else f&&hidedialog(),
d()})};h({returnImmediately:!0})})})}function getOneTimeToken(a,b,c,d){var e="undefined"!=typeof g_key_iterations?g_key_iterations:1,f=make_lp_key_iterations(g_username,a,e);e=getMasterPasswordPostData(f,a,e);e.maketoken=1;e.tokenfor=b?b:"";$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:"verifypassword.php",data:e,success:function(b){b.success?(g_localkey=g_local_key=f,c(b,a)):d(b)},error:d})}
function confirmMasterPasswordWithToken(a,b,c){function d(d,g){g=g||function(){showConfirmPasswordForm(e,2,!1,g_reason)};var f="undefined"!=typeof g_key_iterations?g_key_iterations:1,h=make_lp_key_iterations(g_username,d,f);f=getMasterPasswordPostData(h,d,f);f.maketoken=1;f.tokenfor=c?c:"";$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:"verifypassword.php",data:f,success:function(c){c.success?(g_localkey=g_local_key=h,a(c,d)):b(c)},error:g})}var e=function(){b||(b=function(a){var b=function(){document.location.href=
"/?ac=1"};switch("undefined"===typeof a.reason?"unknown":a.reason){case "nosession":lpmessagebox("",gs("You must sign in to your LastPass account before this operation."),b,b);break;case "blacklisted":lpmessagebox("",gs("Your account has been temporarily suspended because of too many login attempt failures."),b,b);break;default:showConfirmPasswordForm(e,2,!1,"")}});var a=$("#confirmmasterpassword").val();d(a,function(){showConfirmPasswordForm(e,2,!1,g_reason)})};isFederatedUserLogin()?d(lpFederatedLoginObj.getFederatedMasterPassword(),
function(){}):FederatedLogin.isFederated(g_username,function(a){a?FederatedLogin.getPassword(g_username,function(a){d(a,function(){})},MessageBoxErrorHandler):showConfirmPasswordForm(e)},MessageBoxErrorHandler)}
function showConfirmPasswordForm(a,b,c,d){var e="";c&&(e=' onkeypress="return event.keyCode != 13;"');c="";"undefined"!==typeof VirtualKeyboard&&(c='<a style="position:relative;left:-30px;top:-4px;" href="#" onclick="showgetpwkeyboard();return false;" id="keyboardlink"><img alt="launch on-screen keyboard" src="/images/keyboard.png"/></a>');d="<div style='text-align:center;'><p><strong>"+(d?d:"")+"</strong></p>"+gs("Please re-enter your LastPass Master Password")+(2==b?"<br/><p class='errormsg'>"+
gs("The master password you entered is incorrect. Please try again.")+"</p>":"<br/>")+'<form method="post" action="#" autocomplete="OFF" onsubmit="onSubmit();return false;"><center><input id="confirmmasterpassword" spellcheck="false" type="password"  value="" '+e+"/>"+c+"</center></form></div>";lpwindow({title:gs("Confirm Password"),html:d,showok:!0,showcancel:!0,cancelbuttontext:"Cancel",okbuttontext:"Continue",onclick:a,inputid:"confirmmasterpassword"});Lpwm.uptopzindex();b&&$("#confirmmasterpassword").css({border:"solid 2px red"});
$("#confirmmasterpassword").css({width:"200px"});$("#confirmmasterpassword").css({"text-align":"left"});$("#confirmmasterpassword").css({"margin-topalign":"12px"});$("#confirmmasterpassword").select();$("#confirmmasterpassword").on("focus",function(){attachKeyboard(this)});if("undefined"!==typeof VirtualKeyboard&&"function"===typeof attachKeyboard&&"function"===typeof VirtualKeyboard.toggle){$("#confirmmasterpassword").on("focus",function(){attachKeyboard(this)});try{VirtualKeyboard.toggle("confirmmasterpassword",
"virtualkeyboard")}catch(f){}}}function isFederatedUserLogin(){return"object"===typeof lpFederatedLoginObj&&lpFederatedLoginObj.wasLastLoginFederated()}
function getmasterpassword(a,b,c,d,e,f,g){g_func2=a;g_func3=b;g_reason=e||"";isFederatedUserLogin()?getmasterpasswordhelper(lpFederatedLoginObj.getFederatedMasterPassword(),f,g):FederatedLogin.isFederated(g_username,function(a){a?FederatedLogin.getPassword(g_username,function(a){getmasterpasswordhelper(a,f,g)},MessageBoxErrorHandler):showConfirmPasswordForm(function(a){getmasterpasswordhelper(a,f,g)},c,d,e)},MessageBoxErrorHandler)}
function getmasterpasswordhelper(a,b,c){a||(a=$("#confirmmasterpassword").val(),"function"===typeof challengegetstrength&&(g_mpw_strength=challengegetstrength(g_USERNAME,a)));var d="undefined"!=typeof g_key_iterations?g_key_iterations:1,e=make_lp_key_iterations(g_username,a,d),f=getMasterPasswordPostData(e,a,d,b);d="";var g=document.getElementById("csrftoken");f.keyType=b;g&&g.value&&(d={"X-CSRF-TOKEN":g.value});$.ajax({global:!1,type:"POST",cache:!1,dataType:"json",url:selectURL(c),data:f,headers:d,
success:function(b){1==b.success?(g_localkey=g_local_key=e,g_func2(a,f.pwhash,b)):g_func3(b)},error:function(a){getmasterpassword(g_func2,g_func3,2,!1,g_reason,a.keyType,a.action)}})}function selectURL(a){var b="verifypassword.php";"regenerate"===a?b="lmiapi/mfa/regenerate-key":"show"===a&&(b="lmiapi/mfa/show-key");return b}
function getMasterPasswordPostData(a,b,c,d){a=make_lp_hash_iterations(a,b,c);b=null;"undefined"!=typeof g_token?b=g_token:document.getElementById("csrftoken")&&(b=document.getElementById("csrftoken").value);c={cmd:"verify",email:g_username,pwhash:a,iterations:c,from:"reprompt",token:b};"undefined"!=typeof g_reprompt_from&&(c.from=g_reprompt_from);return c}
function getmasterpasswordhelperfailure(a){switch("undefined"==typeof a.reason?"unknown":a.reason){case "nosession":alert(gs("You must log into your LastPass vault before starting the LastPass Security Challenge."));hidedialog();document.location.href="misc_login.php?from_uri="+encodeURIComponent("/misc_challenge.php");break;case "blacklisted":lpmessagebox("",gs("Your account has been temporarily suspended because of too many login attempt failures."));hidedialog();break;default:getmasterpassword(g_func2,
g_func3,2,!1,g_reason,a.keyType,a.action)}}function setonclick(a,b){if(a=$(a))if("undefined"!=typeof a.on)a.on("click",b);else"undefined"!=typeof a.live&&a.click(b)}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
function lpwindow_internal(a,b,c,d,e,f,g,m,h,n,p,r,q,w,v,u,B,y,G,A,C,D,I,F,J,x,L,Q,W,T,O,N,R,Z,aa,V,ea,X,Y,ba,fa){if("undefined"!=typeof n&&n){a={};"undefined"!==typeof lp_phpsessid&&(a.wxsessid=lp_phpsessid);if("object"===typeof p)for(var P in p)p.hasOwnProperty(P)&&(a[P]=p[P]);lpwindow({title:e,html:"<center><img src='/opensslccs/wait.gif'/></center>",name:"pleasewait",showclose:!1});$.ajax({global:!1,type:"POST",cache:!1,dataType:"html",url:n,data:a,timeout:2E4,success:function(a){hidedialog("pleasewait");
lpwindow_internal(a,b,c,d,e,f,g,m,h,null,null,r,q,w,v,u,B,y,G,A,C,D,I,F,J,x,L,Q,W,T,O,N,R,Z,aa,V,ea,X,Y,ba);"show_website.php?extjs=1"==n&&initializeURLTypeahead("#url","#grouping")},error:function(){hidedialog("pleasewait");lpmessagebox(null,gs("Something went wrong, please try again."),null,-1!=n.indexOf("settings.php")&&"function"==typeof closeiframe?closeiframe:null)}})}else{var S=P=p="";if("undefined"!=typeof Lpwm.next_is_dup&&Lpwm.next_is_dup(a))return!1;"function"==typeof stopprogress&&stopprogress();
if("undefined"==typeof e||null==e)e="LastPass";++g_windowid;var K=f?"iframe":"",E=g_windowid+"x"+getRandomInt(1,1E8),H=Lpwm.prefix+E,M=Lpwm.bgprefix+E+K,U=Lpwm.htmlprefix+E,ha=Lpwm.titleprefix+E,ka=H+"x"+K,ca=null,ia=null,ja=null,oa=H+"header",qa=Lpwm.nextbgz(),la=Lpwm.nextwinz();null!=L&&(la=L);var ra="",ma="",sa="",ta=800,ua="",va="auto";c&&(ca=new LPButton("ok",H,E,g,J&&"undefined"!=typeof J.classok?J.classok:""),p=ca.html());d&&(ia=new LPButton("cancel",H,E+K,N,J&&"undefined"!=typeof J.classcancel?
J.classcancel:""),P=ia.html());aa&&"undefined"!=typeof V&&V&&(ja=new LPButton("custom",H,E,V,J&&"undefined"!=typeof J.classok?J.classok:""),S=ja.html());"undefined"!=typeof r&&r&&(g_dialogclose[M]=r);"undefined"!=typeof v&&v&&(g_dialogname[v]={id:H,bgid:M,titleid:ha});"undefined"!=typeof q&&null!=q&&(ma=parseInt(q,10)==q?q+"px":q);K="<div id='"+M+"' class='modalbackground'></div>";Q&&(K="");"undefined"!=typeof G&&null!=G&&(sa=parseInt(G,10)==G?G+"px":G);"undefined"!=typeof I&&null!=I&&(ta=I+"px");
E="";"undefined"!=typeof Y&&Y&&(E=" newstyle");"undefined"!=typeof ba&&""!=ba&&(E=E+" "+ba);K+="<div id='"+H+"'  class='dialog"+E+"'>";document.location.href.indexOf("webroot.com");m="undefined"==typeof m||m?!0:!1;"undefined"==typeof Y||"undefined"!=typeof Y&&!Y?(E="",m&&(E="x",fa&&(E=fa),E="<a class='icon_close_grey' id='"+ka+"' alt='close dialog'>"+E+"</a>")):(E="",m&&(E="<div class='dialogHeaderButtons'><button title='Close' class='dialogCloseButton dialogHeaderButton' id='"+ka+"'></button></div>"));
K+="<div class='dialog_hdr'><span class='lpwindowtitle' id='"+ha+"'></span>"+E+"</div>";"undefined"!=typeof u&&u&&(K+="<div id='"+oa+"'>"+u+"</div>");"undefined"!=typeof B&&null!=B&&(ua=parseInt(B,10)==B?B+"px":B);"undefined"!=typeof C&&null!=C&&(ra=parseInt(C,10)==C?C+"px":C);"undefined"!=typeof A&&A&&(va=A);K=K+("<form autocomplete='off' action='' method='post'><div id='"+U+"' class='clearfix dialog_content' automation-id='dialogContent'></div></form>")+"</div>";0!=$("#google_auth_mp_reprompt").length&&
"undefined"!==typeof showdialogforce?($("#google_auth_mp_reprompt").html(K).show(),"undefined"!==typeof showdialogforce&&(showdialogforce=void 0)):$("body").append(K);$("#"+M).css("z-index",qa);$("#"+H).css("width",ma);$("#"+H).css("border-color",y);$("#"+H).css("height",sa);$("#"+H).css("z-index",la);O||$("#"+H).css("max-width",ta);$("#"+ha).css("padding-left","32px !important");$("#"+U).css("padding",ua);W||$("#"+U).css("max-height","600px");$("#"+U).css("height",ra);$("#"+U).css("overflow",va);
is_online_vault()||set_class_styling();e=gs(e);$("#"+ha).html(e);if(""!=p||""!=P||""!=S)a+='<div id="bctrd" class="wrap2btnsB btn_swap" automation-id="dialogActionButtons"><div class="wrapinner">'+(F?p+P+S:P+p+S)+"</div></div>";x&&(a+=x);$("#"+U).html(a);var na=b?function(){var a=b();if("undefined"==typeof a||a)"undefined"!=typeof g_dialogclose[M]&&g_dialogclose[M]&&(g_dialogclose[M]=null,delete g_dialogclose[M]),"undefined"!==typeof v&&v?hidedialog(v):hidedialog()}:function(){"undefined"!==typeof v&&
v?hidedialog(v):hidedialog()};h&&$("#"+h).keypress(function(a){13==a.which&&(a.preventDefault(),na())});ca&&setonclick("#"+ca.id(),function(){na();return!1});ia&&setonclick("#"+ia.id(),function(){hidedialog({closeiframe:!0,clicked:this});return!1});ja&&setonclick("#"+ja.id(),function(){ea();return!1});setonclick("#"+ka,function(){g_porig="";hidedialog({closeiframe:!0,clicked:this});return!1});m&&Z&&setonclick("#"+M,function(){hidedialog({closeiframe:!0,clicked:this});return!1});lpwindow_show_div(H,
M,ma,f,D,R,w,T,c,d,na,ca?ca.id():"",la,qa)}}
function lpwindow_show_div(a,b,c,d,e,f,g,m,h,n,p,r,q,w){""==c&&1400<$("#"+a).width()&&$("#"+a).css({width:"1400px"});$(window).height();$(document).height();$(document).scrollTop();var v=Math.round(($(window).width()-$("#"+a).width())/2);c=Math.round(($(window).height()-$("#"+a).height())/2)-100+$(document).scrollTop();0>v&&(v=0);0>c&&(c=0);c<$(document).scrollTop()&&(c=Math.round(($(window).height()-$("#"+a).height())/2)+$(document).scrollTop(),c<$(document).scrollTop()&&(c=Math.round(($(document).height()-
$("#"+a).height())/2)+$(document).scrollTop()),0>c&&(c=0));"undefined"!==typeof d&&d&&(v=500,600<$(document).width()&&(v=$(document).width()-200),1400<v&&(v=1400),800>v&&(v=800),c=500,100<$(document).height()&&(c=$(document).height()-100),c=Math.round(($(document).height()-c)/2),$("#"+a).css({width:v+"px",top:c+"px"}),navigator&&/MSIE 8/.test(navigator.userAgent)||$("#"+a).css({position:"fixed"}));0>c&&(c=1);"undefined"!=typeof e&&null!=e&&(c=e);var u=function(){var a=$("#"+b);if(a.length){var c=
$(document).width(),d=$(document).height();a.css({width:c+"px",height:d+"px"}).show()}};$(window).resize(u);setTimeout(function(){u()},0);v=Math.round(($(document).width()-$("#"+a).width())/2);0>v&&(v=0);"undefined"!=typeof leftv&&null!=leftv&&(v=leftv);$("#"+a).css({left:v,top:c}).show();$("#"+a).height()>$(document).height()&&(m||$("#"+a).css({height:$(document).height()-100}));r&&!n&&$("#"+r)&&"undefined"!=typeof $("#"+r).css&&$("#"+r).css("margin-right","12px");if(h||n){try{$(document).keydown(function(a){27==
a.which&&(n?$("#"+cancelid).click():h&&$("#"+r).click())})}catch(B){}"undefined"===typeof d&&(document.onkeydown=function(a){13==a.keyCode&&(p(),a.preventDefault())})}Lpwm.pushWindow({id:b,zval:w});Lpwm.pushWindow({id:a,zval:q});f&&(g_settingswin=Lpwm.gettophtmlid());"undefined"!==typeof g&&g&&g()}
function lpwindowget(a){if("undefined"==typeof a||"undefined"==typeof a.value||!a.value)return null;var b=null;if("undefined"!=typeof a.name&&a.name){if("undefined"==typeof g_dialogname[a.name])return null;b=g_dialogname[a.name].id}else{var c=Lpwm.popWindow();c&&(b=c.id,!document.getElementById(b)&&(c=Lpwm.popWindow()))&&(b=c.id)}if(!b||!document.getElementById(b))return null;b=$("#"+b);switch(a.value.toLowerCase()){case "innerwidth":return b.innerWidth();case "innerheight":return b.innerHeight()}return null}
function lpwindowupdate(a){if("undefined"!=typeof a&&"undefined"!=typeof a.name&&a.name&&"undefined"!=typeof g_dialogname[a.name]){var b=$("#"+g_dialogname[a.name].id);"undefined"!=typeof a.title&&a.title&&$("#"+g_dialogname[a.name].titleid).text(a.title);"undefined"!=typeof a.url&&a.url&&$.ajax({global:!1,type:"GET",cache:!1,dataType:"html",url:url,success:function(a){b.html(a)},error:function(){b.html(gs("An error occurred"))}})}}
function hidealldialogs(a){a="undefined"==typeof a?!0:a;for(var b=0;10>b;++b)hidedialog({closeiframe:a,force:1});for(var c in g_dialogname)hidedialog({name:c,closeiframe:a})}
function hidedialog(a){Lpwm.lock&&Lpwm.unlockit();"string"==typeof a&&(a={name:a});var b=!1,c="",d="";if("undefined"!==typeof a&&"undefined"!=typeof a.name&&a.name){if("undefined"==typeof g_dialogname[a.name])return;c=g_dialogname[a.name].id;d=g_dialogname[a.name].bgid;b=!0;Lpwm.deleteById(c);Lpwm.deleteById(d)}else{var e=Lpwm.popWindow(),f=Lpwm.popWindow();e&&f&&(c=e.id,d=f.id,document.getElementById(c)||(e=Lpwm.popWindow(),f=Lpwm.popWindow(),e&&f&&(c=e.id,d=f.id)))}if("undefined"!=typeof g_dialogclose[d]&&
g_dialogclose[d]){e=g_dialogclose[d]();if("undefined"!=typeof e&&!e)return;g_dialogclose[d]=null;delete g_dialogclose[d]}b&&(g_dialogname[a.name]=null,delete g_dialogname[a.name]);b=!1;a&&(a.force||a.clicked&&-1<a.clicked.id.indexOf("iframe"))&&(b=!0);e=2>Lpwm.getnumwindows();"function"===typeof closeiframe&&"undefined"!==typeof a&&"undefined"!=typeof a.closeiframe&&1==a.closeiframe&&(b||e)&&closeiframe();document.onkeydown=null;"undefined"!==typeof document.accountform&&0==Lpwm.getnumwindows()&&
document.accountform.parentNode.removeChild(document.accountform);c&&""!=c&&document.getElementById(c)&&($("#"+c).hide(),a&&a.hideonly||$("#"+c).remove());d&&""!=d&&document.getElementById(d)&&($("#"+d).hide(),$("#"+d).remove());(a&&a.closeiframe&&$(a.clicked).hasClass("icon_close_grey")||a&&a.closeiframe&&$(a.clicked).hasClass("modalbackground")||a&&a.closeiframe&&$(a.clicked).attr("automation-id","cancel"))&&"function"===typeof parent_callback_finished&&parent_callback_finished()}
function showprogress(a,b,c,d){1<c&&(c=1);"useglobals"==a&&"useglobals"==b&&(a=g_progressargs.textabove,b=g_progressargs.textbelow);if("undefined"!=typeof g_dialogname.progress){var e=g_dialogname.progress,f=Lpwm.gettopobj();if(f&&e.id==f.id){$("#"+e.titleid).html(a);$("#progresstextbelow").html(b);return}}e="<p style='text-align:left;' id='progresstextbelow'>"+b+"</p><div class='progress_container'><div class='progress_bar' id='progress_bar'/></div>";hidedialog();lpwindow({name:"progress",title:a,
html:e,showclose:!1});stopprogress();d&&("useglobals"!=a&&"useglobals"!=b&&(g_progressargs.textabove=a,g_progressargs.textbelow=b),g_progresstimer=setTimeout(function(){showprogress("useglobals","useglobals",c+d/100,!0)},d))}function hideprogress(){stopprogress();hidedialog()}function stopprogress(){g_progresstimer&&(clearTimeout(g_progresstimer),g_progresstimer=null)}
function check_enterprise_multifactor_reprompt(a){try{if("undefined"!=typeof a.enterprisemultifactorreprompt&&a.enterprisemultifactorreprompt)return window.location.href="enterprise_multifactor_reprompt.php?from_uri="+encodeURIComponent(window.location.href),!0}catch(b){}return!1}function is_online_vault(){return 0==window.location.href.indexOf("https://")?!0:!1}
function set_class_styling(){$(".dialog").css("position","absolute");$(".dialog").css("text-align","left");$(".dialog").css("background-color","#FFFFFF");$(".dialog").css("margin","0");$(".dialog").css("padding","0");$(".lastpass_window_icon").css("display","inline-block");$(".lastpass_window_icon").css("height","16px");$(".lastpass_window_icon").css("border-radius","2px");$(".lastpass_window_icon").css("left","8px");$(".modalbackground").css("position","absolute");$(".modalbackground").css("left",
"0px");$(".modalbackground").css("top","0px");$(".modalbackground").css("background-color","rgba(0,0,0,.6)");$(".modalbackground").css("margin","0");$(".modalbackground").css("padding","0");$(".icon_close_grey").css("position","absolute");$(".icon_close_grey").css("cursor","pointer");$(".icon_close_grey").css("right","12px");$(".icon_close_grey").css("top","0px");$(".lastpass_window_icon").css("display","inline-block");$(".lastpass_window_icon").css("height","16px");$(".lastpass_window_icon").css("border-radius",
"2px");$(".lastpass_window_icon").css("left","8px");$(".lpwindowtitle").css("padding-left","32px !important");$(".dialog:not(.newstyle) .lpwindowtitle").css("padding-left","32px !important");$(".dialog:not(.newstyle) .dialog_hdr").css("margin-left","0px");$(".dialog:not(.newstyle) .dialog_hdr").css("margin-right","0px");$(".dialog:not(.newstyle) .dialog_hdr").css("width","100%");$(".dialog:not(.newstyle) .dialog_hdr").css("font-size","100%");$(".dialog:not(.newstyle) .dialog_hdr").css("line-height",
"16px");$(".dialog:not(.newstyle) .dialog_hdr").css("font-weight","bold");$(".dialog:not(.newstyle) .dialog_hdr").css("margin","8px");$(".dialog:not(.newstyle) .dialog_content").css("background","#e6e6e6");$(".dialog:not(.newstyle) .dialog_content").css("padding","16px")}function attachKeyboard(a){"undefined"!=typeof VirtualKeyboard&&VirtualKeyboard.attachInput(a)}
function showgetpwkeyboard(){$("#virtualkeyboard").is(":visible")?$("#virtualkeyboard").slideUp(100):$("#virtualkeyboard").slideDown(100)}
function lpwindow_div_dialog(a,b,c,d){var e=g_windowid+"x"+getRandomInt(1,1E8),f=Lpwm.bgprefix+e,g=a+"close",m=Lpwm.nextbgz(),h=Lpwm.nextwinz(),n="<div id='"+f+"' class='modalbackground'></div>";$("body").append(n);c=new LPButton("ok",a,e,c,null);n="";if(!1!==d){var p=new LPButton("cancel",a,e,null,null);n=p.html()}n+=c.html();$("#"+a+"buttons").html(n);$("#"+f).css("z-index",m);$("#"+a).css("z-index",h);var r=b?function(){var a=b();if("undefined"==typeof a||a)"undefined"!=typeof g_dialogclose[f]&&
g_dialogclose[f]&&(g_dialogclose[f]=null,delete g_dialogclose[f]),hidedialog({hideonly:!0})}:function(){hidedialog({hideonly:!0})};setonclick("#"+c.id(),function(){r();return!1});setonclick("#"+g,function(){hidedialog({hideonly:!0,closeiframe:!0,clicked:this});return!1});!1!==d&&setonclick("#"+p.id(),function(){hidedialog({hideonly:!0,closeiframe:!0,clicked:this});return!1});lpwindow_show_div(a,f,null,null,null,null,null,null,null,null,null,c.id(),h,m)};var rsa_extract_privatekey=function(){return function(a,b){if(!a)return"";a="!"==a.charAt(0)?lpdec(a,b):AES.Decrypt({pass:b+b.substring(0,16),data:btoa(AES.hex2bin(a)),b64:!0,bits:256,mode:"cbc"});if(!a||42>=a.length||0!==a.indexOf("LastPassPrivateKey<")||a.indexOf(">LastPassPrivateKey")!==a.length-19)return log_private_key_extract_error("private_key_is_invalid"),"";a=a.substring(19,a.length-19);""===a&&log_private_key_extract_error("extracted_private_key_length_is_zero");return a}}();
function rsa_encrypt_privatekey_v1(a,b){a="LastPassPrivateKey<"+a+">LastPassPrivateKey";return AES.bin2hex(atob(AES.Encrypt({pass:b+b.substring(0,16),data:a,b64:!0,bits:256,mode:"cbc"}))).toUpperCase()}function rsa_encrypt_privatekey_v2(a,b){return enccbc("LastPassPrivateKey<"+a+">LastPassPrivateKey",b)}function rsa_encrypt_privatekey(a,b){return rsa_encrypt_privatekey_v1(a,b)}
function log_private_key_extract_error(a){$.ajax({global:!1,type:"GET",cache:!1,dataType:"",url:"error.php?msg=rsa_key_extract_error:"+a})};var FederatedLoginService=function(){return function(){var a=this;a.isFederated=function(a,c,d){b(a,function(a){c(0<a.type,a.type)},d)};a._handleError=function(a,b){a&&a(b?b.toString():"");b&&setTimeout(function(){throw b;},0)};a._getAuthInfo=function(d,e,f,g){b(d,function(b){a._ajax({type:"GET",dataType:"json",url:b.IdentityProviderURL+"/auth/saml2/getauthinfo/"+e,success:f,error:c(g)})},g)};a._initiate=function(c,d,f){b(c,function(b){switch(b.type){case 3:d(b);break;case 2:e(c,b,function(a){d(b,
a)},f);break;case 1:d(b);break;default:a._handleError(f,Error("User is not provisioned for federated login"))}},f)};a._decryptK1WithPrivateKey=function(a,b){return b.decrypt(a,"RSA-OAEP",{md:forge.md.sha384.create()})};a._assemblePassword=function(b,d,e,m,q){var h=atob(e.k1),n=atob(e.k2);d&&(h=a._decryptK1WithPrivateKey(h,d.privateKey));var p=g(h,n);a._ajax({type:"POST",dataType:"json",contentType:"application/json",url:"lmiapi/login/getLocalKeyPart",data:{username:b,keyHash:f(p),authSessionId:e.authSessionId},
success:function(b){b&&b.localKey?m(f(g(p,atob(b.localKey)))):a._handleError(q,Error("Could not retrieve local key"))},error:c(q)})};a.OIDC_PROVIDERS={Azure:0,Okta:1,OktaWithoutAuthorizationServer:2,Google:3,PingOne:4,OneLogin:5};a.GRAPH_API_HOST={Com:"graph.microsoft.com",Us:"graph.microsoft.us"};a.processMicrosoftGraphApiResponse=function(a){a="string"===typeof a?JSON.parse(a):a;if(a.extensions)for(var b=0;b<a.extensions.length;b++)if("com.lastpass.keys"===a.extensions[b].id)return a.extensions[b].LastPassK1};
a._getKeysForAzure=function(b,d,e,f){var g=a.GRAPH_API_HOST.Com;null!=b.graphApiHost&&(g=b.graphApiHost);a._ajax({type:"GET",url:"https://"+g+"/v1.0/me?$select=id,displayName,mail&$expand=extensions",beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+b.accessToken)},success:function(c){(c=a.processMicrosoftGraphApiResponse(c))?d(c,b,e,f):a._handleError(f,Error("Could not retrieve K1 from Azure"))},error:c(f)})};a._getGlobalKeysForIdp=function(b,c,d,e){var f=b.k1;f?c(btoa(f),b,d,e):
a._handleError(e,Error("Could not retrieve K1 from "+a.getOIDCProviderName(b.provider)))};a._getKeysForPingOne=function(b,c,d,e){var f=b.k1;f?c(f,b,d,e):a._handleError(e,Error("Could not retrieve K1 from PingOne"))};a._getKeysForGoogle=function(b,c,d,e){var f=googleApiHelpers(a._ajax,b.accessToken);f.getGoogleDriveFile("k1.lp","appDataFolder",function(a){a&&a.id&&f.getGoogleDriveFileContent(a.id,function(a){a&&c(a,b,d,e)})})};a._getK2FromAlp=function(b,d,e,m){a._ajax({type:"POST",dataType:"json",
contentType:"application/json",url:d.alpUrl+"/federatedlogin/api/v1/getkey",data:JSON.stringify({company_id:d.companyId,id_token:d.idToken}),success:function(c){c&&c.k2?e(f(g(atob(b),atob(c.k2))),void 0,c.fragment_id,f(atob(b))):a._handleError(m,Error("Could not retrieve K2 from ALP"))},error:c(m)})};a._assemblePasswordForOIDC=function(b,c,d){var e=function(){d(gs("Unknown OpenIDConnect provider")+" "+provider)};if(b.provider===a.OIDC_PROVIDERS.Azure)e=a._getKeysForAzure;else if(b.provider===a.OIDC_PROVIDERS.Google)e=
a._getKeysForGoogle;else if(b.provider===a.OIDC_PROVIDERS.PingOne)e=a._getKeysForPingOne;else if(b.provider===a.OIDC_PROVIDERS.Okta||b.provider===a.OIDC_PROVIDERS.OktaWithoutAuthorizationServer||b.provider===a.OIDC_PROVIDERS.OneLogin)e=a._getGlobalKeysForIdp;e(b,a._getK2FromAlp,c,d)};a.getScopes=function(b,c){switch(b){case a.OIDC_PROVIDERS.Azure:return c?"openid email profile user.readwrite":"openid email profile";case a.OIDC_PROVIDERS.OktaWithoutAuthorizationServer:return"openid email profile groups";
case a.OIDC_PROVIDERS.PingOne:return c?"openid email profile p1:update:user":"openid email profile lastpass";case a.OIDC_PROVIDERS.Google:return"openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/drive.install https://www.googleapis.com/auth/drive.file";default:return"openid email profile"}};a.getOIDCProviderName=function(a){switch(a){case 0:return"Azure AD";case 1:case 2:return"Okta";
case 3:return"Google";case 4:return"PingOne";case 5:return"OneLogin";default:return""}};a._keypairSaved=function(){};a._cache={};a.clearCache=function(){a._cache={}};var b=function(){"undefined"!==typeof g_oldFederatedEmail&&(g_oldFederatedEmail="");"undefined"!==typeof g_newFederatedEmail&&(g_newFederatedEmail="");return function(b,d,e){a._cache[b]?d(a._cache[b]):a._ajax({type:"GET",dataType:"json",url:"lmiapi/login/type",data:{username:b},success:function(c){c?(c.OldEmail&&""!==c.OldEmail?"undefined"!==
typeof g_oldFederatedEmail&&(g_oldFederatedEmail=c.OldEmail,g_newFederatedEmail=b):a._cache[b]=c,d(c)):a._handleError(e,Error("Could not retrieve login data: "+c))},error:c(e)})}}(),c=function(b){return function(c,d,e){a._handleError(b,Error(e))}},d=function(a){forge.rsa.generateKeyPair({bits:2048,workers:2},function(b,c){a(b,c)})},e=function(b,e,f,g){d(function(d,h){d?g(d):a._ajax({type:"POST",dataType:"json",contentType:"application/json",url:"lmiapi/federatedPublicKey/savePublicKey",data:{email:b,
publickey:m(h).publicKey},success:function(){a._keypairSaved(h,e);f(h)},error:c(g)})})},f=function(a){var b=forge.md.sha256.create();b.update(a);return btoa(b.digest().bytes())},g=function(a,b){return forge.util.xorBytes(a,b,a.length<b.length?a.length:b.length)},m=function(a){return a?{privateKey:btoa(forge.asn1.toDer(forge.pki.privateKeyToAsn1(a.privateKey)).getBytes()),publicKey:btoa(forge.asn1.toDer(forge.pki.publicKeyToAsn1(a.publicKey)).getBytes())}:a}}}();var FederatedLogin=function(){return new function(){var a=this;FederatedLoginService.call(a);a._ajax=function(a){$.ajax(a)};a.getPassword=function(b,c,d){"object"===typeof ext&&ext?ext.FederatedLogin.getPassword(b,c,d):a._handleError(d,Error("Web Federated Login is not enabled!"))};a.isFederated=function(a){return function(b,d,e){"object"===typeof ext&&ext?ext.FederatedLogin.isFederated(b,d,e):a(b,d,e)}}(a.isFederated)}}();
MessageBoxErrorHandler=function(a){a=a?a.toString():"";lpmessagebox(gs("An Error Occurred"),a)};var lpParseUriCache=[],lpParseUriNumber=0;
function lpParseUri(a){if("string"!=typeof a)return"";if(null!=lpParseUriCache[a])return lpParseUriCache[a];var b=a,c=a.substring(0,8).toLowerCase();0!==c.indexOf("http://")&&0!==c.indexOf("https://")&&0!==c.indexOf("ftp://")&&(a="https://"+a);try{if("function"==typeof URL){var d=new URL(a);if("object"==typeof d&&"string"==typeof d.href&&"undefined"!=typeof d.hostname)var e=d.hostname}}catch(f){}a=lpParseUri_old(a);if("undefined"!=typeof e&&"undefined"!=typeof a.host&&e.toLowerCase()!=a.host.toLowerCase())return"";
"undefined"!=typeof a.host&&(a.host=fix_url_host(a.host));if(500<lpParseUriNumber){for(d in lpParseUriCache){delete lpParseUriCache[d];break}lpParseUriNumber=0}lpParseUriCache[b]=a;lpParseUriNumber++;return a}
function lpParseUri_old(a){var b=null,c=null;-1!=a.indexOf("#")&&(c=a.substring(a.indexOf("#")+1),a=a.substring(0,a.indexOf("#")));-1!=a.indexOf("?")&&(b=a.substring(a.indexOf("?")+1),a=a.substring(0,a.indexOf("?")));for(;;){var d=a.match(/^(.*:\/\/[^\/]+\/.*)@/);if(d)a=a.substring(0,d[1].length)+a.substring(d[1].length).replace(/@/g,"%40");else break}if(2047<a.length)return"";var e=lpParseUri.options;d=null;try{d=e.parser[e.strictMode?"strict":"loose"].exec(a)}catch(g){try{d=500<a.length?e.parser[e.strictMode?
"strict":"loose"].exec(a.substr(0,500)):e.parser[e.strictMode?"strict":"loose"].exec(a.substr(0,floor(a.length/2)))}catch(m){lpReportError("parseuri : failing "+a),d=e.parser[e.strictMode?"strict":"loose"].exec("http://")}}a=d;var f={};for(d=14;d--;)f[e.key[d]]=a[d]||"";f[e.q.name]={};f[e.key[12]].replace(e.q.parser,function(a,b,c){b&&(f[e.q.name][b]=c)});null!=b&&(f.query=b,null!=c&&(f.anchor=c));return f}
lpParseUri.options={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
var lpCanUrlCache=[],lpCanUrlExNumber=0;
function lpcanonizeUrl(a,b){if("about:blank"==a)return"";if(null!=lpCanUrlCache[a])return lpCanUrlCache[a];null==b&&(b=lpParseUri(a));var c="";""!=b.port&&b.port!=get_default_port(b.protocol)&&(c=":"+b.port);if(b.host)b=b.host.toLowerCase()+c+b.path;else{if(!a)return"";b=a}-1!=b.indexOf(";")&&(b=b.substring(0,b.indexOf(";")));if(500<lpCanUrlExNumber){for(var d in lpCanUrlCache){delete lpCanUrlCache[d];break}lpCanUrlExNumber=0}lpCanUrlCache[a]=b;lpCanUrlExNumber++;return b}
function lp_gettld(a,b){"undefined"!=typeof lp_all_tlds&&null!=lp_all_tlds||lp_init_tlds();if("string"!=typeof a)return"";if(""==a&&"string"==typeof b&&0==b.indexOf("file://"))return"file:";a=a.toLowerCase();b="";"."==a.substr(-1)&&(b=".");a=a.replace(/\.$/,"");var c=a.split(".");if(a.match(/^\d+\.\d+\.\d+\.\d+$/))a=4;else if(a=2,3<=c.length){var d=c[c.length-1];if("undefined"!=typeof lp_all_tlds[d]){var e=c[c.length-2];4<=c.length&&lp_in_array(c[c.length-4]+"."+c[c.length-3]+"."+e,lp_all_tlds[d])&&
(a=5);3<=c.length&&lp_in_array(c[c.length-3]+"."+e,lp_all_tlds[d])?a=4:lp_in_array(e,lp_all_tlds[d])&&(a=3)}}for(;c.length>a;)c.shift();return c.join(".")+b}function lp_gettld_url(a){var b=lpParseUri(a);return lp_gettld(b.host,a)}function getname_url(a){a=lpParseUri(punycode.URLToUnicode(a));return("string"==typeof a.host?a.host:"").replace(/^www\./,"")}function lptrim(a){return"string"!=typeof a?a:a.replace(/^\s+|\s+$/g,"")}
function lp_regexp_quote(a){return(a+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}=!<>\|:])/g,"\\$1")}function getactiontld(a){return"undefined"==typeof a||null==a||"undefined"==typeof a.action||0==a.action.indexOf("javascript:")?"":lp_gettld_url(punycode.URLToASCII(a.action))}function getname(a,b){if(b&&"undefined"!=typeof a.id&&""!=a.id)return a.id;if("undefined"!=typeof a&&null!=a){if("undefined"!=typeof a.name&&""!=a.name)return a.name;if("undefined"!=typeof a.id)return a.id}return""}
var accRecoveryHasFailed=!1;function sendAccountRecoveryErrorEvent(a){accRecoveryHasFailed||(lpImprove("acc_rec_failed",a,!0),accRecoveryHasFailed=!0)}
function lpIsVisible(a,b){if(a&&"INPUT"==a.tagName&&"hidden"==a.type)return!1;for(;a&&"BODY"!=a.tagName;a=a.parentNode){if("undefined"!=typeof a.style&&("hidden"==a.style.visibility||"none"==a.style.display))return!1;try{var c=a.ownerDocument.defaultView.getComputedStyle(a,"");if("hidden"==c.visibility||"none"==c.display)return!1}catch(d){}if(b)break}return!0}
function lp_in_array(a,b){if("undefined"==typeof b||null===b)return!1;for(var c=b.length,d=0;d<=c;d++)if("undefined"!=typeof b[d]&&b[d]==a)return lpArrayOffset=d,!0;return!1}function strip(a){if(!a.length)return a;a=a.replace(/\s+/g," ");a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/[\|]+$/g,"");var b=a.match(/\|([^\|]+)$/);b&&(a=b[1],a=a.replace(/^\s+|\s+$/g,""));return a}
function lpxmlescape(a){if("undefined"==typeof a||null===a)return"";"number"==typeof a&&(a=""+a);a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=a.replace(/"/g,"&quot;")}function lpxmlunescape(a){if("undefined"==typeof a||null===a)return"";"number"==typeof a&&(a=""+a);a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&quot;/g,'"');return a=a.replace(/&amp;/g,"&")}var lpRegExCache=[],lpRegExNumber=0;
function regexp_match_c(a,b){var c=a.toString()+"_"+b;80<c.length&&("function"==typeof fasthash?c=fasthash(c):"function"==typeof SHA256&&(c=SHA256(c)));if(null!=lpRegExCache[c])return"1"==lpRegExCache[c];a=a.exec(b);if(2500<lpRegExNumber){for(var d in lpRegExCache){delete lpRegExCache[d];break}lpRegExNumber=0}lpRegExCache[c]=a?"1":"0";lpRegExNumber++;return a}
function fire_onchange(a,b,c){try{if(a){if(a.ownerDocument&&"function"==typeof a.ownerDocument.createEvent){var d=a.ownerDocument.createEvent("Events");d.initEvent("change",!0,!0);a.dispatchEvent(d);d=a.ownerDocument.createEvent("Events");d.initEvent("input",!0,!0);a.dispatchEvent(d);"undefined"!=typeof ischrome&&ischrome&&"function"==typeof a.onkeyup&&(c&&(d.keyCode=8),a.onkeyup(d))}else"undefined"!=typeof a.fireEvent&&(a.fireEvent("onchange"),a.fireEvent("oninput"));("undefined"==typeof b||null==
b||b)&&"function"==typeof sendKey&&sendKey("SHIFT",a);if("function"==typeof lpGetBrowserForDocument){var e=lpGetBrowserForDocument(a.ownerDocument);e&&(e.lpfieldchanged=!0)}}}catch(f){}}function get_default_port(a){switch(a){case "http":return 80;case "https":return 443;case "ftp":return 21;default:return 0}}function get_port(a){var b=0;"undefined"!=typeof a.port&&a.port?b=a.port:"undefined"!=typeof a.protocol&&a.protocol&&(b=get_default_port(a.protocol));return b}
function compare_ports(a,b){a=""!=a.port?a.port:get_default_port(a.protocol);b=""!=b.port?b.port:get_default_port(b.protocol);return a==b}function array_size(a){var b=a.length?--a.length:-1,c;for(c in a)b++;return b}function lpgetlocalts(){return(new Date).getTime()}function lp_get_gmt_timestamp(){var a=(new Date).getTime();return parseInt(a/1E3)}function lp_get_local_timestamp(){return lp_get_gmt_timestamp()}
function checkurlrules(a,b,c,d,e,f,g){if(0==b.length)return b;for(var m=[],h=[],n=0;n<a.length;n++)if("undefined"==typeof a[n].tld&&(a[n].tld=lp_gettld_url(a[n].url),a[n].parts=lpParseUri(a[n].url),a[n].path="string"==typeof a[n].parts.path?a[n].parts.path:""),c==a[n].tld){var p=d;"undefined"!=typeof a[n].case_insensitive&&"1"==a[n].case_insensitive&&(p=p.toLowerCase());""!=a[n].path&&0!=p.indexOf(a[n].path)?h[h.length]=a[n]:e==a[n].parts.host||1==a[n].exacthost&&-1!=e.indexOf("."+a[n].parts.host)||
0==a[n].exacthost?m[m.length]=a[n]:h[h.length]=a[n]}if(0==m.length&&0==h.length)return b;if(0<m.length){a=b;for(n=0;n<m.length;n++)c=applyurlrule(b,m[n],d,e,g,f),c.length<a.length&&(a=c);return a}for(n=0;n<h.length;n++)removeurlrule(b,h[n],f,e,g);return b}
function applyurlrule(a,b,c,d,e,f){var g="undefined"!=typeof b.case_insensitive&&"1"==b.case_insensitive;g&&(c=c.toLowerCase());var m=b.path;if(""!=m&&0!=c.indexOf(m))return a;for(var h=m.split("/").length,n=[],p=!1,r=0;r<a.length;r++){var q=a[r],w=q.pathlevelmatch,v=q.servermatch,u=q.portmatch;if("undefined"==typeof w||g){w=c.split("/");q="undefined"!=typeof q.url?q.url:f[q.id].url;g&&(q=q.toLowerCase());q=lpParseUri(q);q.path="undefined"!=typeof q.path?q.path:"";v=q.path.split("/");for(u=0;u<w.length&&
u<v.length&&v[u]==w[u];u++);w=u;v=d==q.host;u=e==get_port(q)}""!=m&&w<h||(p=p||1==b.exacthost||1==b.exactport?!0:!1,!v&&0!=b.exacthost||!u&&0!=b.exactport||(p=!0,n[n.length]=a[r]))}return p?n:a}
function removeurlrule(a,b,c,d,e){d="undefined"!=typeof b.case_insensitive&&"1"==b.case_insensitive;e=b.path;for(var f=0;f<a.length;f++){var g="undefined"!=typeof a[f].id?a[f].id:a[f].aid;"undefined"!=typeof c[g]&&(g=c[g].url,d&&(g=g.toLowerCase()),g=lpParseUri(g),g.path="undefined"!=typeof g.path?g.path:"",""!=e&&0!=g.path.indexOf(e)||"0"!=b.exacthost&&b.parts.host!=g.host||"0"!=b.exactport&&get_port(b.parts)!=get_port(g)||(a.splice(f,1),--f))}}
function lpcreaterandomhexstring(a){for(var b="",c=0;c<a;c++){var d=get_random(0,15);b+="0123456789ABCDEF".substring(d,d+1)}return b}
function iso2to3(a){var b={AD:"AND",AE:"ARE",AF:"AFG",AG:"ATG",AL:"ALB",AM:"ARM",AO:"AGO",AQ:"ATA",AR:"ARG",AT:"AUT",AU:"AUS",AW:"ABW",AZ:"AZE",BA:"BIH",BB:"BRB",BD:"BGD",BE:"BEL",BF:"BFA",BG:"BGR",BH:"BHR",BI:"BDI",BJ:"BEN",BM:"BMU",BN:"BRN",BO:"BOL",BR:"BRA",BS:"BHS",BT:"BTN",BW:"BWA",BY:"BLR",BZ:"BLZ",CA:"CAN",CD:"COD",CF:"CAF",CG:"COG",CH:"CHE",CI:"CIV",CL:"CHL",CM:"CMR",CN:"CHN",CO:"COL",CR:"CRI",CU:"CUB",CV:"CPV",CY:"CYP",CZ:"CZE",DE:"DEU",DJ:"DJI",DK:"DNK",DM:"DMA",DO:"DOM",DZ:"DZA",EC:"ECU",
EE:"EST",EG:"EGY",EH:"ESH",ER:"ERI",ES:"ESP",ET:"ETH",FI:"FIN",FJ:"FJI",FM:"FSM",FO:"FRO",FR:"FRA",GA:"GAB",GB:"GBR",GD:"GRD",GE:"GEO",GF:"GUF",GH:"GHA",GM:"GMB",GN:"GIN",GP:"GLP",GQ:"GNQ",GR:"GRC",GT:"GTM",GW:"GNB",GY:"GUY",HN:"HND",HR:"HRV",HT:"HTI",HU:"HUN",IC:"ESC",ID:"IDN",IE:"IRL",IL:"ISR",IN:"IND",IO:"IOT",IQ:"IRQ",IR:"IRN",IS:"ISL",IT:"ITA",JE:"JEY",JM:"JAM",JO:"JOR",JP:"JPN",KE:"KEN",KG:"KGZ",KH:"KHM",KI:"KIR",KM:"COM",KN:"KNA",KP:"PRK",KR:"KOR",KW:"KWT",KZ:"KAZ",LA:"LAO",LB:"LBN",LC:"LCA",
LI:"LIE",LK:"LKA",LR:"LBR",LS:"LSO",LT:"LTU",LU:"LUX",LV:"LVA",LY:"LBY",MA:"MAR",MC:"MCO",MD:"MDA",ME:"MNE",MG:"MDG",MK:"MKD",ML:"MLI",MM:"MMR",MN:"MNG",MO:"MAC",MQ:"MTQ",MR:"MRT",MS:"MSR",MU:"MUS",MV:"MDV",MW:"MWI",MX:"MEX",MY:"MYS",MZ:"MOZ",NA:"NAM",NE:"NER",NG:"NGA",NI:"NIC",NL:"NLD",NO:"NOR",NP:"NPL",NZ:"NZL",OM:"OMN",PA:"PAN",PE:"PER",PG:"PNG",PH:"PHL",PK:"PAK",PL:"POL",PS:"PSE",PT:"PRT",PW:"PLW",PY:"PRY",QA:"QAT",RE:"REU",RO:"ROU",RS:"SRB",RU:"RUS",RW:"RWA",SA:"SAU",SB:"SLB",SC:"SYC",SD:"SDN",
SE:"SWE",SH:"SHN",SI:"SVN",SK:"SVK",SL:"SLE",SM:"SMR",SN:"SEN",SO:"SOM",SR:"SUR",ST:"STP",SV:"SLV",SY:"SYR",SZ:"SWZ",TD:"TCD",TF:"ATF",TG:"TGO",TH:"THA",TJ:"TJK",TL:"TLS",TM:"TKM",TN:"TUN",TR:"TUR",TT:"TTO",TW:"TWN",TZ:"TZA",UA:"UKR",UG:"UGA",US:"USA",UY:"URY",UZ:"UZB",VC:"VCT",VE:"VEN",VN:"VNM",VU:"VUT",YE:"YEM",ZA:"ZAF",ZM:"ZMB",ZW:"ZWE"};return"undefined"!=typeof b[a]?b[a]:a}
function crypto_atob(a){if(a&&17<=a.length&&"!"==a.charAt(0)){var b=a.indexOf("|");if(-1!=b)return"!"+atob(a.substring(1,b))+atob(a.substring(b+1))}return atob(a)}function crypto_btoa(a){return a&&33<=a.length&&1==a.length%16&&"!"==a.charAt(0)?"!"+btoa(a.substring(1,17))+"|"+btoa(a.substring(17)):btoa(a)}
function CompareLastPassVersions(a,b,c){var d=0,e=0,f=0,g=0,m=0,h=0,n=a.split(".");for(a=0;a<n.length;a++)0==a?d=parseInt(n[a]):1==a?e=parseInt(n[a]):2==a&&(f=parseInt(n[a]));b=b.split(".");for(a=0;a<b.length;a++)0==a?g=parseInt(b[a]):1==a?m=parseInt(b[a]):2==a&&(h=parseInt(b[a]));return d!=g?d>g?1:-1:e!=m?e>m?1:-1:c?0:f!=h?f>h?1:-1:0}function lpalert(a,b){"undefined"!=typeof LP&&"function"==typeof LP.lpgs?LP.alert(LP.lpgs(a),b):"function"==typeof alertfrombg?alertfrombg(gs(a)):alert(gs(a))}
function getLocalOTP(){var a=SHA256(g_username)+"_otp";if(!localStorage.getItem(a))return{otpData:generateOtpData(g_username),localOtpKey:a}}
var generateOtpData=function(){return function(a,b){a=fix_username(a);var c=b?b:g_local_key;rng_seed_time();for(var d=[],e=0;16>e;e++)d[e]=0;rng_get_bytes(d);b="";for(e=0;16>e;e++)b+=String.fromCharCode(d[e]);d=enc(AES.bin2hex(b),c);var f=make_lp_key(a,b);e=enc(AES.bin2hex(c),f);var g=SHA256(SHA256(a+b)+b),m=AES.hex2bin(dec(e,f,1));c!=m?a={error:gs("Failed to decrypt newly encrypted key:")+" dec_local_key:\n"+AES.bin2hex(m)+" != \n"+AES.bin2hex(g_local_key)+"\nlen: "+m.length+" vs "+g_local_key.length+
"\nrand pw:"+AES.bin2hex(b)+"\ng_username:"+a+"\nrand key:"+AES.bin2hex(f)+"\nrand_encrypted_key:"+e}:(a="newkey=1&xml=1&hash="+encodeURIComponent(g),a+="&encrypted_otp="+encodeURIComponent(d),a+="&rand_encrypted_key="+encodeURIComponent(e),a={OTP:b,postData:a+"&recovery=1",lmiapiData:{encryptedOneTimePassword:d,oneTimePasswordHash:g,enabled:0,randomEncryptedKey:e,masterPasswordHash:null}});return a}}();
function issharedfolder(a,b){if(!a||0==a.length||"undefined"==typeof b||null==b||""==b)return!1;var c,d;for(d in a){var e=a[d];"object"==typeof e&&"undefined"!=typeof e.decsharename&&0===b.indexOf(e.decsharename)&&(!c||c.decsharename.length<e.decsharename.length)&&(c=e)}return c?{id:c.id,sharekey:c.key,decsharename:c.decsharename,readonly:c.readonly,give:c.give,associative:c.associative,linkedshare:c.linkedshare}:!1}
function getsharekey(a,b){for(var c=0;"undefined"!=typeof a&&null!=a&&c<a.length;c++){var d=a[c];if(d.id==b)return d.key}return null}function lpmenc_acct(a,b,c,d){return"undefined"==typeof c.sharefolderid?lpmenc(a,b):(c=issharedfolder(d,c.group))?lpmenc(a,b,c.sharekey):lpmenc(a,b)}function lpmdec_acct(a,b,c,d){return"undefined"==typeof c.sharefolderid?lpmdec(a,b):(c=issharedfolder(d,c.group))?lpmdec(a,b,c.sharekey):lpmdec(a,b)}
function lpdec_acct(a,b,c){return"undefined"==typeof b.sharefolderid?lpdec(a):(b=issharedfolder(c,b.group))?lpdec(a,b.sharekey):lpdec(a)}function lpenc_acct(a,b,c){return"undefined"==typeof b.sharefolderid?lpenc(a):(b=issharedfolder(c,b.group))?lpenc(a,b.sharekey):lpenc(a)}function checkmove(a,b,c){return b&&!checkreadonly(b,!1,c)?!1:!0}function checkreadonly(a,b,c){return a&&"1"==a.readonly?(b||lpalert("Sorry, this shared folder is read-only.",c),!1):!0}
function checkUsernameHash(){if(null==lpusername_hash||""==lpusername_hash){var a=null;"string"==typeof g_username&&""!=g_username?a=g_username:"string"==typeof lpusername&&""!=lpusername&&(a=lpusername);null!=a&&("function"==typeof SHA256?lpusername_hash=SHA256(a):"function"==typeof lp_sha256&&(lpusername_hash=lp_sha256(a)))}}
function applyattacharraychanges(a){if("undefined"!=typeof a.add)for(var b in a.add)if(a.add.hasOwnProperty(b)){var c={};c.id=a.add[b].id;c.parent=a.add[b].parent;c.mimetype=a.add[b].mimetype;c.filename=a.add[b].filename;c.size=a.add[b].size;c.storagekey=a.add[b].storagekey;lp_attaches.push(c)}if("undefined"!=typeof a.remove)for(b in a.remove)for(c=0;c<lp_attaches.length;c++)a.remove[b]==lp_attaches[c].id&&lp_attaches.splice(c,1)}
function is_encrypted_field(a){return"text"==a||"password"==a||"textarea"==a||"email"==a||"tel"==a||"url"==a}
function clear_filled_fields(a,b,c){"undefined"==typeof c&&(c=1);if(10<c)return null;if(a&&"object"==typeof a.lp_filled_fields){for(var d=0;d<a.lp_filled_fields.length;d++){var e=a.lp_filled_fields[d].value;a.lp_filled_fields[d].value="";""!=e&&fire_onchange(a.lp_filled_fields[d])}a.lp_filled_fields=[]}if(a&&"object"==typeof a.formfillfields){d=a.formfillfields;for(var f in d){var g=d[f].field;e=g.value;g.value="";""!=e&&fire_onchange(g)}a.formfillfields=[]}if(b&&b.frames)for(a=b.frames.length,10<
a&&(a=10),d=0;d<a;d++)b.frames[d].document&&clear_filled_fields(b.frames[d].document,b.frames[d].window,c+1)}function get_sitepwlen(a){return"undefined"!=typeof LP&&"undefined"!=typeof LP.sitepwlen&&"undefined"!=typeof LP.sitepwlen[a]?LP.sitepwlen[a]:"undefined"!=typeof g_sitepwlen&&"undefined"!=typeof g_sitepwlen[a]?g_sitepwlen[a]:"undefined"!=typeof calllptoolband?parseInt(calllptoolband(["getsitepwlens",a])):1}
function fix_url_host(a){if("string"==typeof a){if(27<a.length&&-1!=a.indexOf("logmein.com",a.length-11)){var b=a.match(/^(.*)-[a-z]{10}(\.app).*(\.logmein\.com)$/);if(b)return b[1]+b[2]+b[3]}if(24<a.length&&-1!=a.indexOf("logme.in",a.length-8)&&(b=a.match(/^(.*)-[a-z]{10}(\.app).*(\.logme\.in)$/)))return b[1]+b[2]+b[3]}return a}function is_watermark(a){return!1}function is_watermark_password(a){return!1}
function updateAndEncryptData(a,b,c,d,e,f){e="";var g="undefined"==typeof g_shares?lpshares:g_shares;a="undefined"!=typeof a?a.split("\n"):[];for(var m=0;m<a.length;m++){var h=a[m].split("\t");if(4==h.length||5==h.length){var n=decodeURIComponent(h[1]),p=decodeURIComponent(h[2]);h=h[3];var r=!1,q=p,w=!1;var v=null;"select-one"!=h||"temp_id"!=n&&"userId-select"!=n||""==p||p!=f.username||"fidelity.com"!=d.tld||"undefined"==typeof f.fromiframe||""==f.new_username||(h="text");if("email"==h||"tel"==h||
"text"==h||"password"==h||"hidden"==h||"textarea"==h||"url"==h)c&&c.push(p),f?"email"!=h&&"tel"!=h&&"text"!=h&&"url"!=h||p!=f.username||""===p&&("undefined"==typeof f.fromiframe||""==f.new_username)?"password"==h&&p==f.password&&(""!==p||"undefined"!=typeof f.fromiframe&&""!=f.new_password)&&(v=lpenc_acct(f.new_password,d,g)):v=lpenc_acct(f.new_username,d,g):v="undefined"!=typeof d.username&&""!=d.username&&p==lpmdec_acct(d.username,!0,d,g)?crypto_btoa(d.username):"undefined"!=typeof d.password&&
""!=d.password&&p==lpmdec_acct(d.password,!0,d,g)?crypto_btoa(d.password):lpenc_acct(p,d,g),null==v?"function"==typeof verbose_log&&verbose_log("updateAndEncryptData ERROR: field="+n):e+="0\t"+LP.en(n)+"\t"+LP.en(v)+"\t"+LP.en(h)+"\n","hidden"!=h&&null!=v&&(r=!0,q=crypto_atob(v));else if("action"==h)e+="0\taction\t"+LP.en(p)+"\taction\n";else if("method"==h)e+="0\tmethod\t"+LP.en(p)+"\tmethod\n";else{if(f&&0===f.save_all)continue;e+="0\t"+LP.en(n)+"\t"+LP.en(p)+"\t"+LP.en(h)+"\n";if("radio"==h||"checkbox"==
h){if(w="-1"==p.substring(p.length-2),"radio"!=h||w)r=!0,q=p.substring(0,p.length-2)}else"select-one"==h&&(r=!0)}r&&(p={otherfield:!1},p.name=n,p.type=h,p.value=q,p.checked=w,p.formname="",p.urid="0",p.otherlogin="0",p.url="",b[b.length]=p)}}return e}function lp_ofa(a){return ofa.apply(this,arguments)}function lp_of(a){return of.apply(this,arguments)}function lp_ofja(a){return ofja.apply(this,arguments)}function lp_es(a){return es.apply(this,arguments)}
function fill_field_via_keys(a,b){a.value="";a.focus();for(var c=0;c<b.length;c++)send_simulated_key(a,b.charCodeAt(c),0,!1)}function LP_decimate_children(a){if(!a)return!1;try{for(;a.firstChild;)a.removeChild(a.firstChild)}catch(b){return!1}return!0}function csv_encode(a){if("string"!=typeof a)return"";a.match(/^[=+-]/)&&!a.match(/^[=+-][0-9.]+$/)&&(a=" "+a);a.match(/,|\r|\n|"/)&&(a='"'+a.replace(/"/g,'""')+'"');return a}
function parse_emailaddress(a){var b={username:"",hostname:""};if(!a||"string"!=typeof a)return b;a=a.trim();if(0===a.indexOf("@"))b.hostname=a.substring(1);else if(0<a.indexOf("@")){var c=a.substring(0,a.lastIndexOf("@"));a=a.substring(a.lastIndexOf("@")+1);b.username=c;b.hostname=a}else b.username=a;return b}
function is_equivalent_email(a,b,c,d){if(!(a&&b&&c&&d))return!1;var e=function(){return!1};"undefined"!=typeof compare_tlds&&(e=compare_tlds);"undefined"!=typeof compare_equiv_domains&&(e=compare_equiv_domains);"undefined"!=typeof LP_compare_tlds&&(e=LP_compare_tlds);c=lp_gettld_url(c);d=lp_gettld_url(d);if(!e(c,d))return!1;a=parse_emailaddress(a);b=parse_emailaddress(b);return""===a.hostname&&""===b.hostname?a.username===b.username:a.username===b.username&&!b.hostname&&(e(c,"gmail.com")&&e(a.hostname,
"gmail.com")&&e(d,"gmail.com")||e(c,"yahoo.com")&&e(a.hostname,"yahoo.com")&&e(d,"yahoo.com"))||a.username===b.username&&a.hostname&&b.hostname&&e(c,d)&&e(a.hostname,d)&&e(b.hostname,d)?!0:!1}
function verify_accts_integrity(a,b,c,d,e,f,g,m){var h={total:0,corrupted:0,corruptionRatio:0,corruptedAids:[],corruptedIids:[],corruptedShareIds:[]};if("undefined"!==typeof a&&a&&lpmdec(a)!==b)m="Vault integrity check failed. Username could not be decrypted using current local key. Uid: "+m,lpReportError(m),console.error(m);else{a=Object.keys(c).map(function(a){return c[a]});b=Object.keys(d).map(function(a){return d[a]});var n=Object.keys(e).map(function(a){return e[a]});a=[].concat(a,b,n);var p=
{encgroup:"group",encname:"name"};h.total+=a.length;h.total+=Object.keys(f).length;a.forEach(function(a){var b=!1;Object.keys(p).forEach(function(c){var d=p[c];a[c]&&a[c].length&&(a[d]&&a[d].length||(b=!0))});!a.username||a.unencryptedUsername||lpmdec_acct(a.username,!0,a,g)||(b=!0);a.password&&a.password.length&&(lpmdec_acct(a.password,!0,a,g)||(b=!0));a.extra&&a.extra.length&&(lpmdec_acct(a.extra,!0,a,g).length||(b=!0));b&&(h.corrupted++,h.corruptedAids.push(a.aid))});Object.keys(f).map(function(a){return f[a]}).forEach(function(a){!a.iname||
"string"===typeof a.deciname&&a.deciname.length||lpmdec(a.iname)||(h.corrupted++,h.corruptedIids.push(a.iid))});Object.keys(g).map(function(a){return g[a]}).forEach(function(a){a.sharename&&!lpmdec(a.sharename,!1,a.key)&&(h.corrupted++,h.corruptedShareIds.push(a.shareid))});0<h.total&&0<h.corrupted&&(h.corruptionRatio=Math.round(h.corrupted/h.total*100)/100,a=JSON.stringify(h.corruptedAids),b=JSON.stringify(h.corruptedIids),n=JSON.stringify(h.corruptedShareIds),m="Vault integrity check failed. "+
h.corrupted+" items were corrupted out of "+h.total+". Ratio: "+h.corruptionRatio+". Corrupted aids: "+a+", corrupted iids: "+b+", corrupted shareids: "+n+" uid: "+m,lpReportError(m),console.error(m));return h}}
function getusernamefromacct(a){if("undefined"===typeof a||!a)return"";var b=getBG();if(is_application(a)){for(var c in a.fields){var d=a.fields[c];if(""==d.type&&""!=d.value)return b.lpmdec_acct(d.value,!0,a,b.g_shares)}return""}if(a.save_all)for(d in a.fields){if(("text"==a.fields[d].type||"email"==a.fields[d].type||"tel"==a.fields[d].type)&&""!=a.fields[d].value)return b.lpmdec_acct(a.fields[d].value,!0,a,b.g_shares)}else{if("undefined"!=typeof a.url&&"http://sn"==a.url){c=b.lpmdec_acct(a.extra,
!0,a,b.g_shares);var e=getNoteValue("NoteType",c);if("undefined"!=typeof sntemplates[e]&&"undefined"!=typeof sntemplates[e].Username)return getNoteValue("Username",c)}c="undefined"!=typeof a.unencryptedUsername?a.unencryptedUsername:"";if(""!=c)return c;if("object"==typeof a.fields)try{for(d=0;d<a.fields.length;d++)if("text"==a.fields[d].type||"email"==a.fields[d].type)return c=a.fields[d].value,b.lpmdec_acct(c,!0,a,b.g_shares)}catch(f){}}return""}
function getpasswordfromacct(a){if("undefined"===typeof a||!a)return"";var b=getBG();if(is_application(a)){for(var c in a.fields){var d=a.fields[c];if("password"==d.type&&""!=d.value)return b.lpmdec_acct(d.value,!0,a,b.g_shares)}return""}if(a.save_all){for(d in a.fields)if("password"==a.fields[d].type&&""!=a.fields[d].value)return b.lpmdec_acct(a.fields[d].value,!0,a,b.g_shares);return""}if("undefined"!=typeof a.url&&"http://sn"==a.url){c=b.lpmdec_acct(a.extra,!0,a,b.g_shares);var e=getNoteValue("NoteType",
c);if("undefined"!=typeof sntemplates[e]&&"undefined"!=typeof sntemplates[e].Password)return getNoteValue("Password",c)}c="undefined"!=typeof a.password?a.password:"";if(""==c&&"object"==typeof a.fields)try{for(d=0;d<a.fields.length;d++)if("password"==a.fields[d].type){c=a.fields[d].value;break}}catch(f){}return b.lpmdec_acct(c,!0,a,b.g_shares)};
//# sourceMappingURL=accts.js.map